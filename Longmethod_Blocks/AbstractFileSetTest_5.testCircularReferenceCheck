void#testCircularReferenceCheck#(#)#{#AbstractFileSet#f#=#getInstance#(#)#;#project#.#addReference#(#"dummy"#,#f#)#;#f#.#setRefid#(#new#Reference#(#getProject#(#)#,#"dummy"#)#)#;##try#{#f#.#getDir#(#project#)#;#fail#(#"Can make "#+#f#.#getDataTypeName#(#)#+#" a Reference to itself."#)#;#}##catch#(#BuildException#be#)#{#assertEquals#(#"This data type contains a circular reference."#,#be#.#getMessage#(#)#)#;#}##try#{#f#.#getDirectoryScanner#(#project#)#;#fail#(#"Can make "#+#f#.#getDataTypeName#(#)#+#" a Reference to itself."#)#;#}##catch#(#BuildException#be#)#{#assertEquals#(#"This data type contains a circular reference."#,#be#.#getMessage#(#)#)#;#}##// dummy1 --> dummy2 --> dummy3 --> dummy1#AbstractFileSet#f1#=#getInstance#(#)#;#project#.#addReference#(#"dummy1"#,#f1#)#;#f1#.#setRefid#(#new#Reference#(#getProject#(#)#,#"dummy2"#)#)#;#AbstractFileSet#f2#=#getInstance#(#)#;#project#.#addReference#(#"dummy2"#,#f2#)#;#f2#.#setRefid#(#new#Reference#(#getProject#(#)#,#"dummy3"#)#)#;#AbstractFileSet#f3#=#getInstance#(#)#;#project#.#addReference#(#"dummy3"#,#f3#)#;#f3#.#setRefid#(#new#Reference#(#getProject#(#)#,#"dummy1"#)#)#;##try#{#f1#.#getDir#(#project#)#;#fail#(#"Can make circular reference."#)#;#}##catch#(#BuildException#be#)#{#assertEquals#(#"This data type contains a circular reference."#,#be#.#getMessage#(#)#)#;#}##try#{#f1#.#getDirectoryScanner#(#project#)#;#fail#(#"Can make circular reference."#)#;#}##catch#(#BuildException#be#)#{#assertEquals#(#"This data type contains a circular reference."#,#be#.#getMessage#(#)#)#;#}##// dummy1 --> dummy2 --> dummy3##// (which has the Project's basedir as root).#f1#=#getInstance#(#)#;#project#.#addReference#(#"dummy1"#,#f1#)#;#f1#.#setRefid#(#new#Reference#(#getProject#(#)#,#"dummy2"#)#)#;#f2#=#getInstance#(#)#;#project#.#addReference#(#"dummy2"#,#f2#)#;#f2#.#setRefid#(#new#Reference#(#getProject#(#)#,#"dummy3"#)#)#;#f3#=#getInstance#(#)#;#project#.#addReference#(#"dummy3"#,#f3#)#;#f3#.#setDir#(#project#.#resolveFile#(#"."#)#)#;#File#dir#=#f1#.#getDir#(#project#)#;#assertEquals#(#"Dir is basedir"#,#dir#,#project#.#getBaseDir#(#)#)#;#}