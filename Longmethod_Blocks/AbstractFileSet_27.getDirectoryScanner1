DirectoryScanner#getDirectoryScanner#(#Project#p#)#{##if#(#isReference#(#)#)#{##return#getRef#(#p#)#.#getDirectoryScanner#(#p#)#;#}##dieOnCircularReference#(#)#;#DirectoryScanner#ds#=#null#;##synchronized#(#this#)#{##if#(#directoryScanner#!=#null#&&#p#==#getProject#(#)#)#{#ds#=#directoryScanner#;#}#else#{##if#(#dir#==#null#)#{#throw#new#BuildException#(#"No directory specified for "#+#getDataTypeName#(#)#+#"."#)#;#}##if#(#!#dir#.#exists#(#)#&&#errorOnMissingDir#)#{#throw#new#BuildException#(#dir#.#getAbsolutePath#(#)#+#DirectoryScanner#.#DOES_NOT_EXIST_POSTFIX#)#;#}##if#(#!#dir#.#isDirectory#(#)#&&#dir#.#exists#(#)#)#{#throw#new#BuildException#(#dir#.#getAbsolutePath#(#)#+#" is not a directory."#)#;#}##ds#=#new#DirectoryScanner#(#)#;#setupDirectoryScanner#(#ds#,#p#)#;#ds#.#setFollowSymlinks#(#followSymlinks#)#;#ds#.#setErrorOnMissingDir#(#errorOnMissingDir#)#;#ds#.#setMaxLevelsOfSymlinks#(#maxLevelsOfSymlinks#)#;#directoryScanner#=#(#p#==#getProject#(#)#)#?#ds#:#directoryScanner#;#}#}##ds#.#scan#(#)#;##return#ds#;#}