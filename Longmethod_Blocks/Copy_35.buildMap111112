void#buildMap#(#File#fromDir#,#File#toDir#,#String#[#]#names#,#FileNameMapper#mapper#,#Hashtable#map#)#{#String#[#]#toCopy#=#null#;##if#(#forceOverwrite#)#{#Vector#v#=#new#Vector#(#)#;##for#(#int#i#=#0#;##i#<#names#.#length#;#i#++#)#{##if#(#mapper#.#mapFileName#(#names#[#i#]#)#!=#null#)#{#v#.#addElement#(#names#[#i#]#)#;#}#}##toCopy#=#new#String#[#v#.#size#(#)#]#;#v#.#copyInto#(#toCopy#)#;#}#else#{#SourceFileScanner#ds#=#new#SourceFileScanner#(#this#)#;#toCopy#=#ds#.#restrict#(#names#,#fromDir#,#toDir#,#mapper#,#granularity#)#;#}##for#(#int#i#=#0#;##i#<#toCopy#.#length#;#i#++#)#{#File#src#=#new#File#(#fromDir#,#toCopy#[#i#]#)#;#String#[#]#mappedFiles#=#mapper#.#mapFileName#(#toCopy#[#i#]#)#;##if#(#!#enableMultipleMappings#)#{#map#.#put#(#src#.#getAbsolutePath#(#)#,#new#String#[#]#{#new#File#(#toDir#,#mappedFiles#[#0#]#)#.#getAbsolutePath#(#)#}#)#;#}#else#{##// reuse the array created by the mapper#for#(#int#k#=#0#;##k#<#mappedFiles#.#length#;#k#++#)#{#mappedFiles#[#k#]#=#new#File#(#toDir#,#mappedFiles#[#k#]#)#.#getAbsolutePath#(#)#;#}##map#.#put#(#src#.#getAbsolutePath#(#)#,#mappedFiles#)#;#}#}#}