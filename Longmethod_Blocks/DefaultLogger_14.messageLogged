void#messageLogged#(#BuildEvent#event#)#{#int#priority#=#event#.#getPriority#(#)#;##// Filter out messages based on priority##if#(#priority#<=#msgOutputLevel#)#{#StringBuffer#message#=#new#StringBuffer#(#)#;##if#(#event#.#getTask#(#)#!=#null#&&#!#emacsMode#)#{##// Print out the name of the task if we're in one#String#name#=#event#.#getTask#(#)#.#getTaskName#(#)#;#String#label#=#"["#+#name#+#"] "#;#int#size#=#LEFT_COLUMN_SIZE#-#label#.#length#(#)#;#StringBuffer#tmp#=#new#StringBuffer#(#)#;##for#(#int#i#=#0#;##i#<#size#;#i#++#)#{#tmp#.#append#(#" "#)#;#}##tmp#.#append#(#label#)#;#label#=#tmp#.#toString#(#)#;#BufferedReader#r#=#null#;##try#{#r#=#new#BufferedReader#(#new#StringReader#(#event#.#getMessage#(#)#)#)#;#String#line#=#r#.#readLine#(#)#;#boolean#first#=#true#;##do#{##if#(#first#)#{##if#(#line#==#null#)#{#message#.#append#(#label#)#;#break#;#}#}#else#{#message#.#append#(#StringUtils#.#LINE_SEP#)#;#}##first#=#false#;#message#.#append#(#label#)#.#append#(#line#)#;#line#=#r#.#readLine#(#)#;#}##while#(#line#!=#null#)#;#}##catch#(#IOException#e#)#{##// shouldn't be possible#message#.#append#(#label#)#.#append#(#event#.#getMessage#(#)#)#;#}##finally#{##if#(#r#!=#null#)#{#FileUtils#.#close#(#r#)#;#}#}#}#else#{##//emacs mode or there is no task#message#.#append#(#event#.#getMessage#(#)#)#;#}##Throwable#ex#=#event#.#getException#(#)#;##if#(#Project#.#MSG_DEBUG#<=#msgOutputLevel#&&#ex#!=#null#)#{#message#.#append#(#StringUtils#.#getStackTrace#(#ex#)#)#;#}##String#msg#=#message#.#toString#(#)#;##if#(#priority#!=#Project#.#MSG_ERR#)#{#printMessage#(#msg#,#out#,#priority#)#;#}#else#{#printMessage#(#msg#,#err#,#priority#)#;#}##log#(#msg#)#;#}#}