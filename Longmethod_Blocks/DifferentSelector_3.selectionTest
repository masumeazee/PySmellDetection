boolean#selectionTest#(#File#srcfile#,#File#destfile#)#{##//if either of them is missing, they are different##if#(#srcfile#.#exists#(#)#!=#destfile#.#exists#(#)#)#{##return#true#;#}##if#(#srcfile#.#length#(#)#!=#destfile#.#length#(#)#)#{##// different size =>different files##return#true#;#}##if#(#!#ignoreFileTimes#)#{##//same date if dest timestamp is within granularity of the srcfile#boolean#sameDate#;#sameDate#=#destfile#.#lastModified#(#)#>=#srcfile#.#lastModified#(#)#-#granularity#&&#destfile#.#lastModified#(#)#<=#srcfile#.#lastModified#(#)#+#granularity#;##// different dates => different files##if#(#!#sameDate#)#{##return#true#;#}#}##if#(#!#ignoreContents#)#{##//here do a bulk comparison#try#{##return#!#FILE_UTILS#.#contentEquals#(#srcfile#,#destfile#)#;#}##catch#(#IOException#e#)#{#throw#new#BuildException#(#"while comparing "#+#srcfile#+#" and "#+#destfile#,#e#)#;#}#}#else#{##return#false#;#}#}