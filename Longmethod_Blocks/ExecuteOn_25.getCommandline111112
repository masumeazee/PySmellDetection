String#[#]#getCommandline#(#String#[#]#srcFiles#,#File#[#]#baseDirs#)#{#final#char#fileSeparator#=#File#.#separatorChar#;#Vector#targets#=#new#Vector#(#)#;##if#(#targetFilePos#!=#null#)#{#Hashtable#addedFiles#=#new#Hashtable#(#)#;##for#(#int#i#=#0#;##i#<#srcFiles#.#length#;#i#++#)#{#String#[#]#subTargets#=#mapper#.#mapFileName#(#srcFiles#[#i#]#)#;##if#(#subTargets#!=#null#)#{#for#(#int#j#=#0#;##j#<#subTargets#.#length#;#j#++#)#{#String#name#=#null#;##if#(#!#relative#)#{#name#=#(#new#File#(#destDir#,#subTargets#[#j#]#)#)#.#getAbsolutePath#(#)#;#}#else#{#name#=#subTargets#[#j#]#;#}##if#(#forwardSlash#&&#fileSeparator#!=#'/'#)#{#name#=#name#.#replace#(#fileSeparator#,#'/'#)#;#}##if#(#!#addedFiles#.#contains#(#name#)#)#{#targets#.#addElement#(#name#)#;#addedFiles#.#put#(#name#,#name#)#;#}#}#}#}#}##String#[#]#targetFiles#=#(#String#[#]#)#targets#.#toArray#(#new#String#[#targets#.#size#(#)#]#)#;##if#(#!#addSourceFile#)#{#srcFiles#=#new#String#[#0#]#;#}##String#[#]#orig#=#cmdl#.#getCommandline#(#)#;#String#[#]#result#=#new#String#[#orig#.#length#+#srcFiles#.#length#+#targetFiles#.#length#]#;#int#srcIndex#=#orig#.#length#;##if#(#srcFilePos#!=#null#)#{#srcIndex#=#srcFilePos#.#getPosition#(#)#;#}##if#(#targetFilePos#!=#null#)#{#int#targetIndex#=#targetFilePos#.#getPosition#(#)#;##if#(#srcIndex#<#targetIndex#||#(#srcIndex#==#targetIndex#&&#srcIsFirst#)#)#{##// 0 --> srcIndex#System#.#arraycopy#(#orig#,#0#,#result#,#0#,#srcIndex#)#;##// srcIndex --> targetIndex#System#.#arraycopy#(#orig#,#srcIndex#,#result#,#srcIndex#+#srcFiles#.#length#,#targetIndex#-#srcIndex#)#;#insertTargetFiles#(#targetFiles#,#result#,#targetIndex#+#srcFiles#.#length#,#targetFilePos#.#getPrefix#(#)#,#targetFilePos#.#getSuffix#(#)#)#;##// targetIndex --> end#System#.#arraycopy#(#orig#,#targetIndex#,#result#,#targetIndex#+#srcFiles#.#length#+#targetFiles#.#length#,#orig#.#length#-#targetIndex#)#;#}#else#{##// 0 --> targetIndex#System#.#arraycopy#(#orig#,#0#,#result#,#0#,#targetIndex#)#;#insertTargetFiles#(#targetFiles#,#result#,#targetIndex#,#targetFilePos#.#getPrefix#(#)#,#targetFilePos#.#getSuffix#(#)#)#;##// targetIndex --> srcIndex#System#.#arraycopy#(#orig#,#targetIndex#,#result#,#targetIndex#+#targetFiles#.#length#,#srcIndex#-#targetIndex#)#;##// srcIndex --> end#System#.#arraycopy#(#orig#,#srcIndex#,#result#,#srcIndex#+#srcFiles#.#length#+#targetFiles#.#length#,#orig#.#length#-#srcIndex#)#;#srcIndex#+=#targetFiles#.#length#;#}#}#else#{##// no targetFilePos##// 0 --> srcIndex#System#.#arraycopy#(#orig#,#0#,#result#,#0#,#srcIndex#)#;##// srcIndex --> end#System#.#arraycopy#(#orig#,#srcIndex#,#result#,#srcIndex#+#srcFiles#.#length#,#orig#.#length#-#srcIndex#)#;#}##// fill in source file names#for#(#int#i#=#0#;##i#<#srcFiles#.#length#;#i#++#)#{#String#src#;##if#(#relative#)#{#src#=#srcFiles#[#i#]#;#}#else#{#src#=#new#File#(#baseDirs#[#i#]#,#srcFiles#[#i#]#)#.#getAbsolutePath#(#)#;#}##if#(#forwardSlash#&&#fileSeparator#!=#'/'#)#{#src#=#src#.#replace#(#fileSeparator#,#'/'#)#;#}##if#(#srcFilePos#!=#null#&&#(#srcFilePos#.#getPrefix#(#)#.#length#(#)#>#0#||#srcFilePos#.#getSuffix#(#)#.#length#(#)#>#0#)#)#{#src#=#srcFilePos#.#getPrefix#(#)#+#src#+#srcFilePos#.#getSuffix#(#)#;#}##result#[#srcIndex#+#i#]#=#src#;#}##return#result#;#}