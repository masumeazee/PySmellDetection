void#testManualStop#(#)#throws#Exception#{#final#Process#process#=#getProcess#(#TIME_OUT#*#2#)#;#watchdog#.#start#(#process#)#;##// I assume that starting this takes less than TIME_OUT/2 ms...#Thread#thread#=#new#Thread#(#)#{#public#void#run#(#)#{#try#{#process#.#waitFor#(#)#;#}##catch#(#InterruptedException#e#)#{##// not very nice but will do the job#fail#(#"process interrupted in thread"#)#;#}#}#}#;#thread#.#start#(#)#;##// wait for TIME_OUT/2, there should be about TIME_OUT/2 ms remaining before timeout#thread#.#join#(#TIME_OUT#/#2#)#;##// now stop the watchdog.#watchdog#.#stop#(#)#;##// wait for the thread to die, should be the end of the process#thread#.#join#(#)#;##// process should be dead and well finished#assertEquals#(#0#,#process#.#exitValue#(#)#)#;#assertTrue#(#"process should not have been killed"#,#!#watchdog#.#killedProcess#(#)#)#;#}