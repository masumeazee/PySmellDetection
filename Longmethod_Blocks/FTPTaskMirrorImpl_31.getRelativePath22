String#getRelativePath#(#String#currentPath#,#String#currentRelativePath#)#{#Vector#pathElements#=#SelectorUtils#.#tokenizePath#(#getAbsolutePath#(#)#,#task#.#getSeparator#(#)#)#;#Vector#pathElements2#=#SelectorUtils#.#tokenizePath#(#currentPath#,#task#.#getSeparator#(#)#)#;#String#relPath#=#currentRelativePath#;##for#(#int#pcount#=#pathElements2#.#size#(#)#;##pcount#<#pathElements#.#size#(#)#;#pcount#++#)#{#String#currentElement#=#(#String#)#pathElements#.#elementAt#(#pcount#)#;#FTPFile#[#]#theFiles#=#listFiles#(#currentPath#)#;#FTPFile#theFile#=#null#;##if#(#theFiles#!=#null#)#{#theFile#=#getFile#(#theFiles#,#currentElement#)#;#}##if#(#!#relPath#.#equals#(#""#)#)#{#relPath#=#relPath#+#task#.#getSeparator#(#)#;#}##if#(#theFile#==#null#)#{##// hit a hidden file assume not a symlink#relPath#=#relPath#+#currentElement#;#currentPath#=#currentPath#+#task#.#getSeparator#(#)#+#currentElement#;#task#.#log#(#"Hidden file "#+#relPath#+#" assumed to not be a symlink."#,#Project#.#MSG_VERBOSE#)#;#}#else#{#traversesSymlinks#=#traversesSymlinks#||#theFile#.#isSymbolicLink#(#)#;#relPath#=#relPath#+#theFile#.#getName#(#)#;#currentPath#=#currentPath#+#task#.#getSeparator#(#)#+#theFile#.#getName#(#)#;#}#}##return#relPath#;#}