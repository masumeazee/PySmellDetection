void#execute#(#)#throws#BuildException#{#CommandlineJava#commandline#=#new#CommandlineJava#(#)#;##if#(#"text"#.#equals#(#format#)#)#{#commandline#.#setClassname#(#"jdepend.textui.JDepend"#)#;#}#else##if#(#"xml"#.#equals#(#format#)#)#{#commandline#.#setClassname#(#"jdepend.xmlui.JDepend"#)#;#}##if#(#jvm#!=#null#)#{#commandline#.#setVm#(#jvm#)#;#}##if#(#getSourcespath#(#)#==#null#&&#getClassespath#(#)#==#null#)#{#throw#new#BuildException#(#"Missing classespath required argument"#)#;#}#else##if#(#getClassespath#(#)#==#null#)#{#String#msg#=#"sourcespath is deprecated in JDepend >= 2.5 "#+#"- please convert to classespath"#;#log#(#msg#)#;#}##// execute the test and get the return code#int#exitValue#=#JDependTask#.#ERRORS#;#boolean#wasKilled#=#false#;##if#(#!#getFork#(#)#)#{#exitValue#=#executeInVM#(#commandline#)#;#}#else#{#ExecuteWatchdog#watchdog#=#createWatchdog#(#)#;#exitValue#=#executeAsForked#(#commandline#,#watchdog#)#;##// null watchdog means no timeout, you'd better not check with null##if#(#watchdog#!=#null#)#{#wasKilled#=#watchdog#.#killedProcess#(#)#;#}#}##// if there is an error/failure and that it should halt, stop##// everything otherwise just log a statement#boolean#errorOccurred#=#exitValue#==#JDependTask#.#ERRORS#||#wasKilled#;##if#(#errorOccurred#)#{#String#errorMessage#=#"JDepend FAILED"#+#(#wasKilled#?#" - Timed out"#:#""#)#;##if#(#getHaltonerror#(#)#)#{#throw#new#BuildException#(#errorMessage#,#getLocation#(#)#)#;#}#else#{#log#(#errorMessage#,#Project#.#MSG_ERR#)#;#}#}#}