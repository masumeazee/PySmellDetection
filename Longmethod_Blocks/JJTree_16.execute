void#execute#(#)#throws#BuildException#{##// load command line with optional attributes#Enumeration#iter#=#optionalAttrs#.#keys#(#)#;##while#(#iter#.#hasMoreElements#(#)#)#{#String#name#=#(#String#)#iter#.#nextElement#(#)#;#Object#value#=#optionalAttrs#.#get#(#name#)#;#cmdl#.#createArgument#(#)#.#setValue#(#"-"#+#name#+#":"#+#value#.#toString#(#)#)#;#}##if#(#targetFile#==#null#||#!#targetFile#.#isFile#(#)#)#{#throw#new#BuildException#(#"Invalid target: "#+#targetFile#)#;#}##File#javaFile#=#null#;##// use the directory containing the target as the output directory##if#(#outputDirectory#==#null#)#{##// convert backslashes to slashes, otherwise jjtree will##// put this as comments and this seems to confuse javacc#cmdl#.#createArgument#(#)#.#setValue#(#"-OUTPUT_DIRECTORY:"#+#getDefaultOutputDirectory#(#)#)#;#javaFile#=#new#File#(#createOutputFileName#(#targetFile#,#outputFile#,#null#)#)#;#}#else#{##if#(#!#outputDirectory#.#isDirectory#(#)#)#{#throw#new#BuildException#(#"'outputdirectory' "#+#outputDirectory#+#" is not a directory."#)#;#}##// convert backslashes to slashes, otherwise jjtree will##// put this as comments and this seems to confuse javacc#cmdl#.#createArgument#(#)#.#setValue#(#"-OUTPUT_DIRECTORY:"#+#outputDirectory#.#getAbsolutePath#(#)#.#replace#(#'\\'#,#'/'#)#)#;#javaFile#=#new#File#(#createOutputFileName#(#targetFile#,#outputFile#,#outputDirectory#.#getPath#(#)#)#)#;#}##if#(#javaFile#.#exists#(#)#&&#targetFile#.#lastModified#(#)#<#javaFile#.#lastModified#(#)#)#{#log#(#"Target is already built - skipping ("#+#targetFile#+#")"#,#Project#.#MSG_VERBOSE#)#;##return#;#}##if#(#outputFile#!=#null#)#{#cmdl#.#createArgument#(#)#.#setValue#(#"-"#+#OUTPUT_FILE#+#":"#+#outputFile#.#replace#(#'\\'#,#'/'#)#)#;#}##cmdl#.#createArgument#(#)#.#setValue#(#targetFile#.#getAbsolutePath#(#)#)#;#final#Path#classpath#=#cmdl#.#createClasspath#(#getProject#(#)#)#;#final#File#javaccJar#=#JavaCC#.#getArchiveFile#(#javaccHome#)#;#classpath#.#createPathElement#(#)#.#setPath#(#javaccJar#.#getAbsolutePath#(#)#)#;#classpath#.#addJavaRuntime#(#)#;#cmdl#.#setClassname#(#JavaCC#.#getMainClass#(#classpath#,#JavaCC#.#TASKDEF_TYPE_JJTREE#)#)#;#final#Commandline#.#Argument#arg#=#cmdl#.#createVmArgument#(#)#;#arg#.#setValue#(#"-mx140M"#)#;#arg#.#setValue#(#"-Dinstall.root="#+#javaccHome#.#getAbsolutePath#(#)#)#;#final#Execute#process#=#new#Execute#(#new#LogStreamHandler#(#this#,#Project#.#MSG_INFO#,#Project#.#MSG_INFO#)#,#null#)#;#log#(#cmdl#.#describeCommand#(#)#,#Project#.#MSG_VERBOSE#)#;#process#.#setCommandline#(#cmdl#.#getCommandline#(#)#)#;##try#{##if#(#process#.#execute#(#)#!=#0#)#{#throw#new#BuildException#(#"JJTree failed."#)#;#}#}##catch#(#IOException#e#)#{#throw#new#BuildException#(#"Failed to launch JJTree"#,#e#)#;#}#}