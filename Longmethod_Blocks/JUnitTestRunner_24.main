void#main#(#String#[#]#args#)#throws#IOException#{#boolean#haltError#=#false#;#boolean#haltFail#=#false#;#boolean#stackfilter#=#true#;#Properties#props#=#new#Properties#(#)#;#boolean#showOut#=#false#;#boolean#outputToFormat#=#true#;#boolean#logFailedTests#=#true#;#boolean#logTestListenerEvents#=#false#;##if#(#args#.#length#==#0#)#{#System#.#err#.#println#(#"required argument TestClassName missing"#)#;#System#.#exit#(#ERRORS#)#;#}##if#(#args#[#0#]#.#startsWith#(#Constants#.#TESTSFILE#)#)#{#multipleTests#=#true#;#args#[#0#]#=#args#[#0#]#.#substring#(#Constants#.#TESTSFILE#.#length#(#)#)#;#}##for#(#int#i#=#1#;##i#<#args#.#length#;#i#++#)#{##if#(#args#[#i#]#.#startsWith#(#Constants#.#HALT_ON_ERROR#)#)#{#haltError#=#Project#.#toBoolean#(#args#[#i#]#.#substring#(#Constants#.#HALT_ON_ERROR#.#length#(#)#)#)#;#}#else##if#(#args#[#i#]#.#startsWith#(#Constants#.#HALT_ON_FAILURE#)#)#{#haltFail#=#Project#.#toBoolean#(#args#[#i#]#.#substring#(#Constants#.#HALT_ON_FAILURE#.#length#(#)#)#)#;#}#else##if#(#args#[#i#]#.#startsWith#(#Constants#.#FILTERTRACE#)#)#{#stackfilter#=#Project#.#toBoolean#(#args#[#i#]#.#substring#(#Constants#.#FILTERTRACE#.#length#(#)#)#)#;#}#else##if#(#args#[#i#]#.#startsWith#(#Constants#.#CRASHFILE#)#)#{#crashFile#=#args#[#i#]#.#substring#(#Constants#.#CRASHFILE#.#length#(#)#)#;#registerTestCase#(#Constants#.#BEFORE_FIRST_TEST#)#;#}#else##if#(#args#[#i#]#.#startsWith#(#Constants#.#FORMATTER#)#)#{#try#{#createAndStoreFormatter#(#args#[#i#]#.#substring#(#Constants#.#FORMATTER#.#length#(#)#)#)#;#}##catch#(#BuildException#be#)#{#System#.#err#.#println#(#be#.#getMessage#(#)#)#;#System#.#exit#(#ERRORS#)#;#}#}#else##if#(#args#[#i#]#.#startsWith#(#Constants#.#PROPSFILE#)#)#{#FileInputStream#in#=#new#FileInputStream#(#args#[#i#]#.#substring#(#Constants#.#PROPSFILE#.#length#(#)#)#)#;#props#.#load#(#in#)#;#in#.#close#(#)#;#}#else##if#(#args#[#i#]#.#startsWith#(#Constants#.#SHOWOUTPUT#)#)#{#showOut#=#Project#.#toBoolean#(#args#[#i#]#.#substring#(#Constants#.#SHOWOUTPUT#.#length#(#)#)#)#;#}#else##if#(#args#[#i#]#.#startsWith#(#Constants#.#LOGTESTLISTENEREVENTS#)#)#{#logTestListenerEvents#=#Project#.#toBoolean#(#args#[#i#]#.#substring#(#Constants#.#LOGTESTLISTENEREVENTS#.#length#(#)#)#)#;#}#else##if#(#args#[#i#]#.#startsWith#(#Constants#.#OUTPUT_TO_FORMATTERS#)#)#{#outputToFormat#=#Project#.#toBoolean#(#args#[#i#]#.#substring#(#Constants#.#OUTPUT_TO_FORMATTERS#.#length#(#)#)#)#;#}#else##if#(#args#[#i#]#.#startsWith#(#Constants#.#LOG_FAILED_TESTS#)#)#{#logFailedTests#=#Project#.#toBoolean#(#args#[#i#]#.#substring#(#Constants#.#LOG_FAILED_TESTS#.#length#(#)#)#)#;#}#}##// Add/overlay system properties on the properties from the Ant project#Hashtable#p#=#System#.#getProperties#(#)#;##for#(#Enumeration#e#=#p#.#keys#(#)#;##e#.#hasMoreElements#(#)#;#)#{#Object#key#=#e#.#nextElement#(#)#;#props#.#put#(#key#,#p#.#get#(#key#)#)#;#}##int#returnCode#=#SUCCESS#;##if#(#multipleTests#)#{#try#{#java#.#io#.#BufferedReader#reader#=#new#java#.#io#.#BufferedReader#(#new#java#.#io#.#FileReader#(#args#[#0#]#)#)#;#String#testCaseName#;#int#code#=#0#;#boolean#errorOccurred#=#false#;#boolean#failureOccurred#=#false#;#String#line#=#null#;##while#(#(#line#=#reader#.#readLine#(#)#)#!=#null#)#{#StringTokenizer#st#=#new#StringTokenizer#(#line#,#","#)#;#testCaseName#=#st#.#nextToken#(#)#;#JUnitTest#t#=#new#JUnitTest#(#testCaseName#)#;#t#.#setTodir#(#new#File#(#st#.#nextToken#(#)#)#)#;#t#.#setOutfile#(#st#.#nextToken#(#)#)#;#t#.#setProperties#(#props#)#;#code#=#launch#(#t#,#haltError#,#stackfilter#,#haltFail#,#showOut#,#outputToFormat#,#logTestListenerEvents#)#;#errorOccurred#=#(#code#==#ERRORS#)#;#failureOccurred#=#(#code#!=#SUCCESS#)#;##if#(#errorOccurred#||#failureOccurred#)#{##if#(#(#errorOccurred#&&#haltError#)#||#(#failureOccurred#&&#haltFail#)#)#{#registerNonCrash#(#)#;#System#.#exit#(#code#)#;#}#else#{##if#(#code#>#returnCode#)#{#returnCode#=#code#;#}##if#(#logFailedTests#)#{#System#.#out#.#println#(#"TEST "#+#t#.#getName#(#)#+#" FAILED"#)#;#}#}#}#}#}##catch#(#IOException#e#)#{#e#.#printStackTrace#(#)#;#}#}#else#{#JUnitTest#t#=#new#JUnitTest#(#args#[#0#]#)#;#t#.#setProperties#(#props#)#;#returnCode#=#launch#(#t#,#haltError#,#stackfilter#,#haltFail#,#showOut#,#outputToFormat#,#logTestListenerEvents#)#;#}##registerNonCrash#(#)#;#System#.#exit#(#returnCode#)#;#}