void#execute#(#)#throws#BuildException#{##// make sure that we've got a destdir##if#(#destDir#==#null#)#{#throw#new#BuildException#(#"destdir attribute must be set!"#,#getLocation#(#)#)#;#}##if#(#!#destDir#.#isDirectory#(#)#)#{#throw#new#BuildException#(#"destination directory \""#+#destDir#+#"\" does not exist or is not a directory"#,#getLocation#(#)#)#;#}##File#dest#=#getActualDestDir#(#)#;#AntClassLoader#al#=#null#;##try#{##//bind to a compiler#JspCompilerAdapter#compiler#=#JspCompilerAdapterFactory#.#getCompiler#(#compilerName#,#this#,#al#=#getProject#(#)#.#createClassLoader#(#compilerClasspath#)#)#;##//if we are a webapp, hand off to the compiler, which had##//better handle it##if#(#webApp#!=#null#)#{#doCompilation#(#compiler#)#;##return#;#}##// make sure that we've got a srcdir##if#(#src#==#null#)#{#throw#new#BuildException#(#"srcdir attribute must be set!"#,#getLocation#(#)#)#;#}##String#[#]#list#=#src#.#list#(#)#;##if#(#list#.#length#==#0#)#{#throw#new#BuildException#(#"srcdir attribute must be set!"#,#getLocation#(#)#)#;#}##// if the compiler does its own dependency stuff, we just##// call it right now##if#(#compiler#.#implementsOwnDependencyChecking#(#)#)#{#doCompilation#(#compiler#)#;##return#;#}##//the remainder of this method is only for compilers that##//need their dependency work done#JspMangler#mangler#=#compiler#.#createMangler#(#)#;##// scan source directories and dest directory to build up both copy##// lists and compile lists#resetFileLists#(#)#;#int#filecount#=#0#;##for#(#int#i#=#0#;##i#<#list#.#length#;#i#++#)#{#File#srcDir#=#getProject#(#)#.#resolveFile#(#list#[#i#]#)#;##if#(#!#srcDir#.#exists#(#)#)#{#throw#new#BuildException#(#"srcdir \""#+#srcDir#.#getPath#(#)#+#"\" does not exist!"#,#getLocation#(#)#)#;#}##DirectoryScanner#ds#=#this#.#getDirectoryScanner#(#srcDir#)#;#String#[#]#files#=#ds#.#getIncludedFiles#(#)#;#filecount#=#files#.#length#;#scanDir#(#srcDir#,#dest#,#mangler#,#files#)#;#}##// compile the source files#log#(#"compiling "#+#compileList#.#size#(#)#+#" files"#,#Project#.#MSG_VERBOSE#)#;##if#(#compileList#.#size#(#)#>#0#)#{#log#(#"Compiling "#+#compileList#.#size#(#)#+#" source file"#+#(#compileList#.#size#(#)#==#1#?#""#:#"s"#)#+#" to "#+#dest#)#;#doCompilation#(#compiler#)#;#}#else#{##if#(#filecount#==#0#)#{#log#(#"there were no files to compile"#,#Project#.#MSG_INFO#)#;#}#else#{#log#(#"all files are up to date"#,#Project#.#MSG_VERBOSE#)#;#}#}#}##finally#{##if#(#al#!=#null#)#{#al#.#cleanup#(#)#;#}#}#}