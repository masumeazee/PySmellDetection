void#execute#(#)#{#presentElements#=#new#HashMap#(#)#;#getNsElements#(#)#;#processTasks#(#)#;#localAttributes#=#new#Hashtable#(#)#;#Set#copyKeys#=#new#HashSet#(#map#.#keySet#(#)#)#;##for#(#Iterator#i#=#macroDef#.#getAttributes#(#)#.#iterator#(#)#;##i#.#hasNext#(#)#;#)#{#MacroDef#.#Attribute#attribute#=#(#MacroDef#.#Attribute#)#i#.#next#(#)#;#String#value#=#(#String#)#map#.#get#(#attribute#.#getName#(#)#)#;##if#(#value#==#null#&&#"description"#.#equals#(#attribute#.#getName#(#)#)#)#{#value#=#getDescription#(#)#;#}##if#(#value#==#null#)#{#value#=#attribute#.#getDefault#(#)#;#value#=#macroSubs#(#value#,#localAttributes#)#;#}##if#(#value#==#null#)#{#throw#new#BuildException#(#"required attribute "#+#attribute#.#getName#(#)#+#" not set"#)#;#}##localAttributes#.#put#(#attribute#.#getName#(#)#,#value#)#;#copyKeys#.#remove#(#attribute#.#getName#(#)#)#;#}##if#(#copyKeys#.#contains#(#"id"#)#)#{#copyKeys#.#remove#(#"id"#)#;#}##if#(#macroDef#.#getText#(#)#!=#null#)#{##if#(#text#==#null#)#{#String#defaultText#=#macroDef#.#getText#(#)#.#getDefault#(#)#;##if#(#!#macroDef#.#getText#(#)#.#getOptional#(#)#&&#defaultText#==#null#)#{#throw#new#BuildException#(#"required text missing"#)#;#}##text#=#defaultText#==#null#?#""#:#defaultText#;#}##if#(#macroDef#.#getText#(#)#.#getTrim#(#)#)#{#text#=#text#.#trim#(#)#;#}##localAttributes#.#put#(#macroDef#.#getText#(#)#.#getName#(#)#,#text#)#;#}#else#{##if#(#text#!=#null#&&#!#text#.#trim#(#)#.#equals#(#""#)#)#{#throw#new#BuildException#(#"The \""#+#getTaskName#(#)#+#"\" macro does not support"#+#" nested text data."#)#;#}#}##if#(#copyKeys#.#size#(#)#!=#0#)#{#throw#new#BuildException#(#"Unknown attribute"#+#(#copyKeys#.#size#(#)#>#1#?#"s "#:#" "#)#+#copyKeys#)#;#}##// need to set the project on unknown element#UnknownElement#c#=#copy#(#macroDef#.#getNestedTask#(#)#,#false#)#;#c#.#init#(#)#;#LocalProperties#localProperties#=#LocalProperties#.#get#(#getProject#(#)#)#;#localProperties#.#enterScope#(#)#;##try#{#c#.#perform#(#)#;#}##catch#(#BuildException#ex#)#{##if#(#macroDef#.#getBackTrace#(#)#)#{#throw#ProjectHelper#.#addLocationToBuildException#(#ex#,#getLocation#(#)#)#;#}#else#{#ex#.#setLocation#(#getLocation#(#)#)#;#throw#ex#;#}#}##finally#{#presentElements#=#null#;#localAttributes#=#null#;#localProperties#.#exitScope#(#)#;#}#}