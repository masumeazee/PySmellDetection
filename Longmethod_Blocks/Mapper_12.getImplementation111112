FileNameMapper#getImplementation#(#)#throws#BuildException#{##if#(#isReference#(#)#)#{#dieOnCircularReference#(#)#;#Reference#r#=#getRefid#(#)#;#Object#o#=#r#.#getReferencedObject#(#getProject#(#)#)#;##if#(#o#instanceof#FileNameMapper#)#{##return#(#FileNameMapper#)#o#;#}##if#(#o#instanceof#Mapper#)#{##return#(#(#Mapper#)#o#)#.#getImplementation#(#)#;#}##String#od#=#o#==#null#?#"null"#:#o#.#getClass#(#)#.#getName#(#)#;#throw#new#BuildException#(#od#+#" at reference '"#+#r#.#getRefId#(#)#+#"' is not a valid mapper reference."#)#;#}##if#(#type#==#null#&&#classname#==#null#&&#container#==#null#)#{#throw#new#BuildException#(#"nested mapper or "#+#"one of the attributes type or classname is required"#)#;#}##if#(#container#!=#null#)#{##return#container#;#}##if#(#type#!=#null#&&#classname#!=#null#)#{#throw#new#BuildException#(#"must not specify both type and classname attribute"#)#;#}##try#{#FileNameMapper#m#=#(#FileNameMapper#)#(#getImplementationClass#(#)#.#newInstance#(#)#)#;#final#Project#p#=#getProject#(#)#;##if#(#p#!=#null#)#{#p#.#setProjectReference#(#m#)#;#}##m#.#setFrom#(#from#)#;#m#.#setTo#(#to#)#;##return#m#;#}##catch#(#BuildException#be#)#{#throw#be#;#}##catch#(#Throwable#t#)#{#throw#new#BuildException#(#t#)#;#}#}