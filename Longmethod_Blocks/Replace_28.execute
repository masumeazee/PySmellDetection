void#execute#(#)#throws#BuildException#{#ArrayList#savedFilters#=#(#ArrayList#)#replacefilters#.#clone#(#)#;#Properties#savedProperties#=#properties#==#null#?#null#:#(#Properties#)#properties#.#clone#(#)#;##if#(#token#!=#null#)#{##// line separators in values and tokens are "\n"##// in order to compare with the file contents, replace them##// as needed#StringBuffer#val#=#new#StringBuffer#(#value#.#getText#(#)#)#;#stringReplace#(#val#,#"\r\n"#,#"\n"#)#;#stringReplace#(#val#,#"\n"#,#StringUtils#.#LINE_SEP#)#;#StringBuffer#tok#=#new#StringBuffer#(#token#.#getText#(#)#)#;#stringReplace#(#tok#,#"\r\n"#,#"\n"#)#;#stringReplace#(#tok#,#"\n"#,#StringUtils#.#LINE_SEP#)#;#Replacefilter#firstFilter#=#createPrimaryfilter#(#)#;#firstFilter#.#setToken#(#tok#.#toString#(#)#)#;#firstFilter#.#setValue#(#val#.#toString#(#)#)#;#}##try#{##if#(#replaceFilterResource#!=#null#)#{#Properties#props#=#getProperties#(#replaceFilterResource#)#;#Iterator#e#=#props#.#keySet#(#)#.#iterator#(#)#;##while#(#e#.#hasNext#(#)#)#{#String#tok#=#e#.#next#(#)#.#toString#(#)#;#Replacefilter#replaceFilter#=#createReplacefilter#(#)#;#replaceFilter#.#setToken#(#tok#)#;#replaceFilter#.#setValue#(#props#.#getProperty#(#tok#)#)#;#}#}##validateAttributes#(#)#;##if#(#propertyResource#!=#null#)#{#properties#=#getProperties#(#propertyResource#)#;#}##validateReplacefilters#(#)#;#fileCount#=#0#;#replaceCount#=#0#;##if#(#sourceFile#!=#null#)#{#processFile#(#sourceFile#)#;#}##if#(#dir#!=#null#)#{#DirectoryScanner#ds#=#super#.#getDirectoryScanner#(#dir#)#;#String#[#]#srcs#=#ds#.#getIncludedFiles#(#)#;##for#(#int#i#=#0#;##i#<#srcs#.#length#;#i#++#)#{#File#file#=#new#File#(#dir#,#srcs#[#i#]#)#;#processFile#(#file#)#;#}#}##if#(#resources#!=#null#)#{#for#(#Iterator#i#=#resources#.#iterator#(#)#;##i#.#hasNext#(#)#;#)#{#FileProvider#fp#=#(#FileProvider#)#(#(#Resource#)#i#.#next#(#)#)#.#as#(#FileProvider#.#class#)#;#processFile#(#fp#.#getFile#(#)#)#;#}#}##if#(#summary#)#{#log#(#"Replaced "#+#replaceCount#+#" occurrences in "#+#fileCount#+#" files."#,#Project#.#MSG_INFO#)#;#}##if#(#failOnNoReplacements#&&#replaceCount#==#0#)#{#throw#new#BuildException#(#"didn't replace anything"#)#;#}#}##finally#{#replacefilters#=#savedFilters#;#properties#=#savedProperties#;#}##// end of finally#}