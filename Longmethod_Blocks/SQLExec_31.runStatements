void#runStatements#(#Reader#reader#,#PrintStream#out#)#throws#SQLException#,#IOException#{#StringBuffer#sql#=#new#StringBuffer#(#)#;#String#line#;#BufferedReader#in#=#new#BufferedReader#(#reader#)#;##while#(#(#line#=#in#.#readLine#(#)#)#!=#null#)#{##if#(#!#keepformat#)#{#line#=#line#.#trim#(#)#;#}##if#(#expandProperties#)#{#line#=#getProject#(#)#.#replaceProperties#(#line#)#;#}##if#(#!#keepformat#)#{##if#(#line#.#startsWith#(#"//"#)#)#{#continue#;#}##if#(#line#.#startsWith#(#"--"#)#)#{#continue#;#}##StringTokenizer#st#=#new#StringTokenizer#(#line#)#;##if#(#st#.#hasMoreTokens#(#)#)#{#String#token#=#st#.#nextToken#(#)#;##if#(#"REM"#.#equalsIgnoreCase#(#token#)#)#{#continue#;#}#}#}##sql#.#append#(#keepformat#?#"\n"#:#" "#)#.#append#(#line#)#;##// SQL defines "--" as a comment to EOL##// and in Oracle it may contain a hint##// so we cannot just remove it, instead we must end it##if#(#!#keepformat#&&#line#.#indexOf#(#"--"#)#>=#0#)#{#sql#.#append#(#"\n"#)#;#}##int#lastDelimPos#=#lastDelimiterPosition#(#sql#,#line#)#;##if#(#lastDelimPos#>#-#1#)#{#execSQL#(#sql#.#substring#(#0#,#lastDelimPos#)#,#out#)#;#sql#.#replace#(#0#,#sql#.#length#(#)#,#""#)#;#}#}##// Catch any statements not followed by ;##if#(#sql#.#length#(#)#>#0#)#{#execSQL#(#sql#.#toString#(#)#,#out#)#;#}#}