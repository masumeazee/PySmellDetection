String#parseUri#(#String#uri#)#{#int#indexOfAt#=#uri#.#indexOf#(#'@'#)#;#int#indexOfColon#=#uri#.#indexOf#(#':'#)#;##if#(#indexOfColon#>#-#1#&&#indexOfColon#<#indexOfAt#)#{##// user:password@host:/path notation##// everything upto the last @ before the last : is considered##// password. (so if the path contains an @ and a : it will not work)#int#indexOfCurrentAt#=#indexOfAt#;#int#indexOfLastColon#=#uri#.#lastIndexOf#(#':'#)#;##while#(#indexOfCurrentAt#>#-#1#&&#indexOfCurrentAt#<#indexOfLastColon#)#{#indexOfAt#=#indexOfCurrentAt#;#indexOfCurrentAt#=#uri#.#indexOf#(#'@'#,#indexOfCurrentAt#+#1#)#;#}##setUsername#(#uri#.#substring#(#0#,#indexOfColon#)#)#;#setPassword#(#uri#.#substring#(#indexOfColon#+#1#,#indexOfAt#)#)#;#}#else##if#(#indexOfAt#>#-#1#)#{##// no password, will require keyfile#setUsername#(#uri#.#substring#(#0#,#indexOfAt#)#)#;#}#else#{#throw#new#BuildException#(#"no username was given.  Can't authenticate."#)#;#}##if#(#getUserInfo#(#)#.#getPassword#(#)#==#null#&&#getUserInfo#(#)#.#getKeyfile#(#)#==#null#)#{#throw#new#BuildException#(#"neither password nor keyfile for user "#+#getUserInfo#(#)#.#getName#(#)#+#" has been "#+#"given.  Can't authenticate."#)#;#}##int#indexOfPath#=#uri#.#indexOf#(#':'#,#indexOfAt#+#1#)#;##if#(#indexOfPath#==#-#1#)#{#throw#new#BuildException#(#"no remote path in "#+#uri#)#;#}##setHost#(#uri#.#substring#(#indexOfAt#+#1#,#indexOfPath#)#)#;#String#remotePath#=#uri#.#substring#(#indexOfPath#+#1#)#;##if#(#remotePath#.#equals#(#""#)#)#{#remotePath#=#"."#;#}##return#remotePath#;#}