void#expandStream#(#String#name#,#InputStream#stream#,#File#dir#)#throws#IOException#{#TarInputStream#tis#=#null#;##try#{#tis#=#new#TarInputStream#(#compression#.#decompress#(#name#,#new#BufferedInputStream#(#stream#)#)#)#;#log#(#"Expanding: "#+#name#+#" into "#+#dir#,#Project#.#MSG_INFO#)#;#TarEntry#te#=#null#;#boolean#empty#=#true#;#FileNameMapper#mapper#=#getMapper#(#)#;##while#(#(#te#=#tis#.#getNextEntry#(#)#)#!=#null#)#{#empty#=#false#;#extractFile#(#FileUtils#.#getFileUtils#(#)#,#null#,#dir#,#tis#,#te#.#getName#(#)#,#te#.#getModTime#(#)#,#te#.#isDirectory#(#)#,#mapper#)#;#}##if#(#empty#&&#getFailOnEmptyArchive#(#)#)#{#throw#new#BuildException#(#"archive '"#+#name#+#"' is empty"#)#;#}##log#(#"expand complete"#,#Project#.#MSG_VERBOSE#)#;#}##finally#{#FileUtils#.#close#(#tis#)#;#}#}