void#taskFinished#(#BuildEvent#event#)#{#Task#task#=#event#.#getTask#(#)#;#TimedElement#taskElement#=#(#TimedElement#)#tasks#.#get#(#task#)#;##if#(#taskElement#==#null#)#{#throw#new#RuntimeException#(#"Unknown task "#+#task#+#" not in "#+#tasks#)#;#}##long#totalTime#=#System#.#currentTimeMillis#(#)#-#taskElement#.#startTime#;#taskElement#.#element#.#setAttribute#(#TIME_ATTR#,#DefaultLogger#.#formatTime#(#totalTime#)#)#;#Target#target#=#task#.#getOwningTarget#(#)#;#TimedElement#targetElement#=#null#;##if#(#target#!=#null#)#{#targetElement#=#(#TimedElement#)#targets#.#get#(#target#)#;#}##if#(#targetElement#==#null#)#{#synchronizedAppend#(#buildElement#.#element#,#taskElement#.#element#)#;#}#else#{#synchronizedAppend#(#targetElement#.#element#,#taskElement#.#element#)#;#}##Stack#threadStack#=#getStack#(#)#;##if#(#!#threadStack#.#empty#(#)#)#{#TimedElement#poppedStack#=#(#TimedElement#)#threadStack#.#pop#(#)#;##if#(#poppedStack#!=#taskElement#)#{#throw#new#RuntimeException#(#"Mismatch - popped element = "#+#poppedStack#+#" finished task element = "#+#taskElement#)#;#}#}##tasks#.#remove#(#task#)#;#}