void#setUp#(#)#{#p#=#new#Project#(#)#;#p#.#init#(#)#;#}##void#testFindResources#(#)#throws#Exception#{#// This path should contain the class files for these testcases:#String#buildTestcases#=#System#.#getProperty#(#"build.tests"#)#;#assertNotNull#(#"defined ${build.tests}"#,#buildTestcases#)#;#assertTrue#(#"have a dir "#+#buildTestcases#,#new#File#(#buildTestcases#)#.#isDirectory#(#)#)#;#Path#path#=#new#Path#(#p#,#buildTestcases#+#"/org"#)#;#// A special parent loader which is not the system class loader:#ClassLoader#parent#=#new#ParentLoader#(#)#;#// An AntClassLoader which is supposed to delegate to#// the parent and then to the disk path:#ClassLoader#acl#=#new#AntClassLoader#(#parent#,#p#,#path#,#true#)#;#// The intended result URLs:#URL#urlFromPath#=#new#URL#(#FILE_UTILS#.#toURI#(#buildTestcases#)#+#"org/"#+#TEST_RESOURCE#)#;#URL#urlFromParent#=#new#URL#(#"http://ant.apache.org/"#+#TEST_RESOURCE#)#;#assertEquals#(#"correct resources (regular delegation order)"#,#Arrays#.#asList#(#new#URL#[#]#{#urlFromParent#,#urlFromPath#}#)#,#enum2List#(#acl#.#getResources#(#TEST_RESOURCE#)#)#)#;#acl#=#new#AntClassLoader#(#parent#,#p#,#path#,#false#)#;#assertEquals#(#"correct resources (reverse delegation order)"#,#Arrays#.#asList#(#new#URL#[#]#{#urlFromPath#,#urlFromParent#}#)#,#enum2List#(#acl#.#getResources#(#TEST_RESOURCE#)#)#)#;#}##void#testFindIsolateResources#(#)#throws#Exception#{#String#buildTestcases#=#System#.#getProperty#(#"build.tests"#)#;#assertNotNull#(#"defined ${build.tests}"#,#buildTestcases#)#;#assertTrue#(#"have a dir "#+#buildTestcases#,#new#File#(#buildTestcases#)#.#isDirectory#(#)#)#;#Path#path#=#new#Path#(#p#,#buildTestcases#+#"/org"#)#;#// A special parent loader which is not the system class loader:#ClassLoader#parent#=#new#ParentLoader#(#)#;#URL#urlFromPath#=#new#URL#(#FILE_UTILS#.#toURI#(#buildTestcases#)#+#"org/"#+#TEST_RESOURCE#)#;#AntClassLoader#acl#=#new#AntClassLoader#(#parent#,#p#,#path#,#false#)#;#acl#.#setIsolated#(#true#)#;#assertEquals#(#"correct resources (reverse delegation order)"#,#Arrays#.#asList#(#new#URL#[#]#{#urlFromPath#}#)#,#enum2List#(#acl#.#getResources#(#TEST_RESOURCE#)#)#)#;#}##List#enum2List#(#Enumeration#e#)#{#return#Collections#.#list#(#e#)#;#}##Enumeration#findResources#(#String#name#)#throws#IOException#{#if#(#name#.#equals#(#TEST_RESOURCE#)#)#{#return#Collections#.#enumeration#(#Collections#.#singleton#(#new#URL#(#"http://ant.apache.org/"#+#name#)#)#)#;#}#else#{#return#Collections#.#enumeration#(#Collections#.#EMPTY_SET#)#;#}#}##