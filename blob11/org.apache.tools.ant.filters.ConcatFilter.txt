int#read#(#)#throws#IOException#{#// do the "singleton" initialization#if#(#!#getInitialized#(#)#)#{#initialize#(#)#;#setInitialized#(#true#)#;#}#int#ch#=#-#1#;#// The readers return -1 if they end. So simply read the "prepend"#// after that the "content" and at the end the "append" file.#if#(#prependReader#!=#null#)#{#ch#=#prependReader#.#read#(#)#;#if#(#ch#==#-#1#)#{#// I am the only one so I have to close the reader#prependReader#.#close#(#)#;#prependReader#=#null#;#}#}#if#(#ch#==#-#1#)#{#ch#=#super#.#read#(#)#;#}#if#(#ch#==#-#1#)#{#// don't call super.close() because that reader is used#// on other places ...#if#(#appendReader#!=#null#)#{#ch#=#appendReader#.#read#(#)#;#if#(#ch#==#-#1#)#{#// I am the only one so I have to close the reader#appendReader#.#close#(#)#;#appendReader#=#null#;#}#}#}#return#ch#;#}##void#setPrepend#(#final#File#prepend#)#{#this#.#prepend#=#prepend#;#}##File#getPrepend#(#)#{#return#prepend#;#}##void#setAppend#(#final#File#append#)#{#this#.#append#=#append#;#}##File#getAppend#(#)#{#return#append#;#}##Reader#chain#(#final#Reader#rdr#)#{#ConcatFilter#newFilter#=#new#ConcatFilter#(#rdr#)#;#newFilter#.#setPrepend#(#getPrepend#(#)#)#;#newFilter#.#setAppend#(#getAppend#(#)#)#;#// Usually the initialized is set to true. But here it must not.#// Because the prepend and append readers have to be instantiated#// on runtime#//newFilter.setInitialized(true);#return#newFilter#;#}##void#initialize#(#)#throws#IOException#{#// get parameters#Parameter#[#]#params#=#getParameters#(#)#;#if#(#params#!=#null#)#{#for#(#int#i#=#0#;#i#<#params#.#length#;#i#++#)#{#if#(#"prepend"#.#equals#(#params#[#i#]#.#getName#(#)#)#)#{#setPrepend#(#new#File#(#params#[#i#]#.#getValue#(#)#)#)#;#continue#;#}#if#(#"append"#.#equals#(#params#[#i#]#.#getName#(#)#)#)#{#setAppend#(#new#File#(#params#[#i#]#.#getValue#(#)#)#)#;#continue#;#}#}#}#if#(#prepend#!=#null#)#{#if#(#!#prepend#.#isAbsolute#(#)#)#{#prepend#=#new#File#(#getProject#(#)#.#getBaseDir#(#)#,#prepend#.#getPath#(#)#)#;#}#prependReader#=#new#BufferedReader#(#new#FileReader#(#prepend#)#)#;#}#if#(#append#!=#null#)#{#if#(#!#append#.#isAbsolute#(#)#)#{#append#=#new#File#(#getProject#(#)#.#getBaseDir#(#)#,#append#.#getPath#(#)#)#;#}#appendReader#=#new#BufferedReader#(#new#FileReader#(#append#)#)#;#}#}##