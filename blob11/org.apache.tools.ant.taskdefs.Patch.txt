void#setOriginalfile#(#File#file#)#{#originalFile#=#file#;#}##void#setDestfile#(#File#file#)#{#if#(#file#!=#null#)#{#cmd#.#createArgument#(#)#.#setValue#(#"-o"#)#;#cmd#.#createArgument#(#)#.#setFile#(#file#)#;#}#}##void#setPatchfile#(#File#file#)#{#if#(#!#file#.#exists#(#)#)#{#throw#new#BuildException#(#"patchfile "#+#file#+#" doesn\'t exist"#,#getLocation#(#)#)#;#}#cmd#.#createArgument#(#)#.#setValue#(#"-i"#)#;#cmd#.#createArgument#(#)#.#setFile#(#file#)#;#havePatchfile#=#true#;#}##void#setBackups#(#boolean#backups#)#{#if#(#backups#)#{#cmd#.#createArgument#(#)#.#setValue#(#"-b"#)#;#}#}##void#setIgnorewhitespace#(#boolean#ignore#)#{#if#(#ignore#)#{#cmd#.#createArgument#(#)#.#setValue#(#"-l"#)#;#}#}##void#setStrip#(#int#num#)#throws#BuildException#{#if#(#num#<#0#)#{#throw#new#BuildException#(#"strip has to be >= 0"#,#getLocation#(#)#)#;#}#cmd#.#createArgument#(#)#.#setValue#(#"-p"#+#num#)#;#}##void#setQuiet#(#boolean#q#)#{#if#(#q#)#{#cmd#.#createArgument#(#)#.#setValue#(#"-s"#)#;#}#}##void#setReverse#(#boolean#r#)#{#if#(#r#)#{#cmd#.#createArgument#(#)#.#setValue#(#"-R"#)#;#}#}##void#setDir#(#File#directory#)#{#this#.#directory#=#directory#;#}##void#setFailOnError#(#boolean#value#)#{#failOnError#=#value#;#}##void#execute#(#)#throws#BuildException#{#if#(#!#havePatchfile#)#{#throw#new#BuildException#(#"patchfile argument is required"#,#getLocation#(#)#)#;#}#Commandline#toExecute#=#(#Commandline#)#cmd#.#clone#(#)#;#toExecute#.#setExecutable#(#PATCH#)#;#if#(#originalFile#!=#null#)#{#toExecute#.#createArgument#(#)#.#setFile#(#originalFile#)#;#}#Execute#exe#=#new#Execute#(#new#LogStreamHandler#(#this#,#Project#.#MSG_INFO#,#Project#.#MSG_WARN#)#,#null#)#;#exe#.#setCommandline#(#toExecute#.#getCommandline#(#)#)#;#if#(#directory#!=#null#)#{#if#(#directory#.#exists#(#)#&&#directory#.#isDirectory#(#)#)#{#exe#.#setWorkingDirectory#(#directory#)#;#}#else#if#(#!#directory#.#isDirectory#(#)#)#{#throw#new#BuildException#(#directory#+#" is not a directory."#,#getLocation#(#)#)#;#}#else#{#throw#new#BuildException#(#"directory "#+#directory#+#" doesn\'t exist"#,#getLocation#(#)#)#;#}#}#else#{#exe#.#setWorkingDirectory#(#getProject#(#)#.#getBaseDir#(#)#)#;#}#log#(#toExecute#.#describeCommand#(#)#,#Project#.#MSG_VERBOSE#)#;#try#{#int#returncode#=#exe#.#execute#(#)#;#if#(#Execute#.#isFailure#(#returncode#)#)#{#String#msg#=#"'"#+#PATCH#+#"' failed with exit code "#+#returncode#;#if#(#failOnError#)#{#throw#new#BuildException#(#msg#)#;#}#else#{#log#(#msg#,#Project#.#MSG_ERR#)#;#}#}#}#catch#(#IOException#e#)#{#throw#new#BuildException#(#e#,#getLocation#(#)#)#;#}#}##