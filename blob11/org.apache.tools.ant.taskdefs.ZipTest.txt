void#setUp#(#)#{#configureProject#(#"src/etc/testcases/taskdefs/zip.xml"#)#;#}##void#test1#(#)#{#expectBuildException#(#"test1"#,#"required argument not specified"#)#;#}##void#test2#(#)#{#expectBuildException#(#"test2"#,#"required argument not specified"#)#;#}##void#test3#(#)#{#expectBuildException#(#"test3"#,#"zip cannot include itself"#)#;#}##void#tearDown#(#)#{#try#{#if#(#zfPrefixAddsDir#!=#null#)#{#zfPrefixAddsDir#.#close#(#)#;#}#}#catch#(#IOException#e#)#{#//ignored#}#executeTarget#(#"cleanup"#)#;#}##void#test5#(#)#{#executeTarget#(#"test5"#)#;#}##void#test6#(#)#{#executeTarget#(#"test6"#)#;#}##void#test7#(#)#{#executeTarget#(#"test7"#)#;#}##void#test8#(#)#{#executeTarget#(#"test8"#)#;#}##void#testZipgroupfileset#(#)#throws#IOException#{#executeTarget#(#"testZipgroupfileset"#)#;#ZipFile#zipFile#=#new#ZipFile#(#new#File#(#getProjectDir#(#)#,#"zipgroupfileset.zip"#)#)#;#assertTrue#(#zipFile#.#getEntry#(#"ant.xml"#)#!=#null#)#;#assertTrue#(#zipFile#.#getEntry#(#"optional/jspc.xml"#)#!=#null#)#;#assertTrue#(#zipFile#.#getEntry#(#"zip/zipgroupfileset3.zip"#)#!=#null#)#;#assertTrue#(#zipFile#.#getEntry#(#"test6.mf"#)#==#null#)#;#assertTrue#(#zipFile#.#getEntry#(#"test7.mf"#)#==#null#)#;#zipFile#.#close#(#)#;#}##void#testUpdateNotNecessary#(#)#{#executeTarget#(#"testUpdateNotNecessary"#)#;#assertEquals#(#-#1#,#getLog#(#)#.#indexOf#(#"Updating"#)#)#;#}##void#testUpdateIsNecessary#(#)#{#expectLogContaining#(#"testUpdateIsNecessary"#,#"Updating"#)#;#}##void#testPrefixAddsDir#(#)#throws#IOException#{#executeTarget#(#"testPrefixAddsDir"#)#;#File#archive#=#getProject#(#)#.#resolveFile#(#"test3.zip"#)#;#zfPrefixAddsDir#=#new#ZipFile#(#archive#)#;#ZipEntry#ze#=#zfPrefixAddsDir#.#getEntry#(#"test/"#)#;#assertNotNull#(#"test/ has been added"#,#ze#)#;#}##void#testFilesOnlyDoesntCauseRecreate#(#)#throws#InterruptedException#{#executeTarget#(#"testFilesOnlyDoesntCauseRecreateSetup"#)#;#long#l#=#getProject#(#)#.#resolveFile#(#"test3.zip"#)#.#lastModified#(#)#;#Thread#.#sleep#(#3000#)#;#executeTarget#(#"testFilesOnlyDoesntCauseRecreate"#)#;#assertEquals#(#l#,#getProject#(#)#.#resolveFile#(#"test3.zip"#)#.#lastModified#(#)#)#;#}##void#testEmptySkip#(#)#{#executeTarget#(#"testEmptySkip"#)#;#}##void#testZipEmptyDir#(#)#{#executeTarget#(#"zipEmptyDir"#)#;#}##void#testZipEmptyDirFilesOnly#(#)#{#executeTarget#(#"zipEmptyDirFilesOnly"#)#;#}##void#testZipEmptyCreate#(#)#{#expectLogContaining#(#"zipEmptyCreate"#,#"Note: creating empty"#)#;#}##void#testCompressionLevel#(#)#{#executeTarget#(#"testCompressionLevel"#)#;#}##void#testDefaultExcludesAndUpdate#(#)#throws#ZipException#,#IOException#{#executeTarget#(#"testDefaultExcludesAndUpdate"#)#;#ZipFile#f#=#null#;#try#{#f#=#new#ZipFile#(#getProject#(#)#.#resolveFile#(#"test3.zip"#)#)#;#assertNotNull#(#"ziptest~ should be included"#,#f#.#getEntry#(#"ziptest~"#)#)#;#}#finally#{#if#(#f#!=#null#)#{#f#.#close#(#)#;#}#}#}##void#testFileResource#(#)#{#executeTarget#(#"testFileResource"#)#;#}##void#testNonFileResource#(#)#{#executeTarget#(#"testNonFileResource"#)#;#}##void#testTarFileSet#(#)#throws#IOException#{#executeTarget#(#"testTarFileSet"#)#;#org#.#apache#.#tools#.#zip#.#ZipFile#zf#=#null#;#try#{#zf#=#new#org#.#apache#.#tools#.#zip#.#ZipFile#(#getProject#(#)#.#resolveFile#(#"test3.zip"#)#)#;#org#.#apache#.#tools#.#zip#.#ZipEntry#ze#=#zf#.#getEntry#(#"asf-logo.gif"#)#;#assertEquals#(#UnixStat#.#FILE_FLAG#|#0446#,#ze#.#getUnixMode#(#)#)#;#}#finally#{#if#(#zf#!=#null#)#{#zf#.#close#(#)#;#}#}#}##void#testRewriteZeroPermissions#(#)#throws#IOException#{#executeTarget#(#"rewriteZeroPermissions"#)#;#org#.#apache#.#tools#.#zip#.#ZipFile#zf#=#null#;#try#{#zf#=#new#org#.#apache#.#tools#.#zip#.#ZipFile#(#getProject#(#)#.#resolveFile#(#"test3.zip"#)#)#;#org#.#apache#.#tools#.#zip#.#ZipEntry#ze#=#zf#.#getEntry#(#"testdir/test.txt"#)#;#assertEquals#(#UnixStat#.#FILE_FLAG#|#0644#,#ze#.#getUnixMode#(#)#)#;#}#finally#{#if#(#zf#!=#null#)#{#zf#.#close#(#)#;#}#}#}##void#testAcceptZeroPermissions#(#)#throws#IOException#{#executeTarget#(#"acceptZeroPermissions"#)#;#org#.#apache#.#tools#.#zip#.#ZipFile#zf#=#null#;#try#{#zf#=#new#org#.#apache#.#tools#.#zip#.#ZipFile#(#getProject#(#)#.#resolveFile#(#"test3.zip"#)#)#;#org#.#apache#.#tools#.#zip#.#ZipEntry#ze#=#zf#.#getEntry#(#"testdir/test.txt"#)#;#assertEquals#(#0000#,#ze#.#getUnixMode#(#)#)#;#}#finally#{#if#(#zf#!=#null#)#{#zf#.#close#(#)#;#}#}#}##void#testForBugzilla34764#(#)#throws#IOException#{#executeTarget#(#"testForBugzilla34764"#)#;#org#.#apache#.#tools#.#zip#.#ZipFile#zf#=#null#;#try#{#zf#=#new#org#.#apache#.#tools#.#zip#.#ZipFile#(#getProject#(#)#.#resolveFile#(#"test3.zip"#)#)#;#org#.#apache#.#tools#.#zip#.#ZipEntry#ze#=#zf#.#getEntry#(#"file1"#)#;#assertEquals#(#UnixStat#.#FILE_FLAG#|#0644#,#ze#.#getUnixMode#(#)#)#;#}#finally#{#if#(#zf#!=#null#)#{#zf#.#close#(#)#;#}#}#}##