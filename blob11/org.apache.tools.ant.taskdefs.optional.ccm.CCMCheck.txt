File#getFile#(#)#{#return#file#;#}##void#setFile#(#File#v#)#{#log#(#"working file "#+#v#,#Project#.#MSG_VERBOSE#)#;#this#.#file#=#v#;#}##String#getComment#(#)#{#return#comment#;#}##void#setComment#(#String#v#)#{#this#.#comment#=#v#;#}##String#getTask#(#)#{#return#task#;#}##void#setTask#(#String#v#)#{#this#.#task#=#v#;#}##void#addFileset#(#FileSet#set#)#{#filesets#.#addElement#(#set#)#;#}##void#execute#(#)#throws#BuildException#{#if#(#file#==#null#&&#filesets#.#size#(#)#==#0#)#{#throw#new#BuildException#(#"Specify at least one source - a file or a fileset."#)#;#}#if#(#file#!=#null#&&#file#.#exists#(#)#&&#file#.#isDirectory#(#)#)#{#throw#new#BuildException#(#"CCMCheck cannot be generated for directories"#)#;#}#if#(#file#!=#null#&&#filesets#.#size#(#)#>#0#)#{#throw#new#BuildException#(#"Choose between file and fileset !"#)#;#}#if#(#getFile#(#)#!=#null#)#{#doit#(#)#;#return#;#}#int#sizeofFileSet#=#filesets#.#size#(#)#;#for#(#int#i#=#0#;#i#<#sizeofFileSet#;#i#++#)#{#FileSet#fs#=#(#FileSet#)#filesets#.#elementAt#(#i#)#;#DirectoryScanner#ds#=#fs#.#getDirectoryScanner#(#getProject#(#)#)#;#String#[#]#srcFiles#=#ds#.#getIncludedFiles#(#)#;#for#(#int#j#=#0#;#j#<#srcFiles#.#length#;#j#++#)#{#File#src#=#new#File#(#fs#.#getDir#(#getProject#(#)#)#,#srcFiles#[#j#]#)#;#setFile#(#src#)#;#doit#(#)#;#}#}#}##void#doit#(#)#{#Commandline#commandLine#=#new#Commandline#(#)#;#// build the command line from what we got the format is#// ccm co /t .. files#// as specified in the CCM.EXE help#commandLine#.#setExecutable#(#getCcmCommand#(#)#)#;#commandLine#.#createArgument#(#)#.#setValue#(#getCcmAction#(#)#)#;#checkOptions#(#commandLine#)#;#int#result#=#run#(#commandLine#)#;#if#(#Execute#.#isFailure#(#result#)#)#{#String#msg#=#"Failed executing: "#+#commandLine#.#toString#(#)#;#throw#new#BuildException#(#msg#,#getLocation#(#)#)#;#}#}##void#checkOptions#(#Commandline#cmd#)#{#if#(#getComment#(#)#!=#null#)#{#cmd#.#createArgument#(#)#.#setValue#(#FLAG_COMMENT#)#;#cmd#.#createArgument#(#)#.#setValue#(#getComment#(#)#)#;#}#if#(#getTask#(#)#!=#null#)#{#cmd#.#createArgument#(#)#.#setValue#(#FLAG_TASK#)#;#cmd#.#createArgument#(#)#.#setValue#(#getTask#(#)#)#;#}#if#(#getFile#(#)#!=#null#)#{#cmd#.#createArgument#(#)#.#setValue#(#file#.#getAbsolutePath#(#)#)#;#}#}##