void#setText#(#boolean#plainText#)#{#optionalAttrs#.#put#(#TEXT#,#plainText#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#this#.#plainText#=#plainText#;#}##void#setOnetable#(#boolean#oneTable#)#{#optionalAttrs#.#put#(#ONE_TABLE#,#oneTable#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setOutputfile#(#String#outputFile#)#{#this#.#outputFile#=#outputFile#;#}##void#setTarget#(#File#target#)#{#this#.#targetFile#=#target#;#}##void#setJavacchome#(#File#javaccHome#)#{#this#.#javaccHome#=#javaccHome#;#}##void#execute#(#)#throws#BuildException#{#// load command line with optional attributes#Enumeration#iter#=#optionalAttrs#.#keys#(#)#;#while#(#iter#.#hasMoreElements#(#)#)#{#String#name#=#(#String#)#iter#.#nextElement#(#)#;#Object#value#=#optionalAttrs#.#get#(#name#)#;#cmdl#.#createArgument#(#)#.#setValue#(#"-"#+#name#+#":"#+#value#.#toString#(#)#)#;#}#if#(#targetFile#==#null#||#!#targetFile#.#isFile#(#)#)#{#throw#new#BuildException#(#"Invalid target: "#+#targetFile#)#;#}#if#(#outputFile#!=#null#)#{#cmdl#.#createArgument#(#)#.#setValue#(#"-"#+#OUTPUT_FILE#+#":"#+#outputFile#.#replace#(#'\\'#,#'/'#)#)#;#}#// use the directory containing the target as the output directory#File#javaFile#=#new#File#(#createOutputFileName#(#targetFile#,#outputFile#,#plainText#)#)#;#if#(#javaFile#.#exists#(#)#&&#targetFile#.#lastModified#(#)#<#javaFile#.#lastModified#(#)#)#{#log#(#"Target is already built - skipping ("#+#targetFile#+#")"#,#Project#.#MSG_VERBOSE#)#;#return#;#}#cmdl#.#createArgument#(#)#.#setValue#(#targetFile#.#getAbsolutePath#(#)#)#;#final#Path#classpath#=#cmdl#.#createClasspath#(#getProject#(#)#)#;#final#File#javaccJar#=#JavaCC#.#getArchiveFile#(#javaccHome#)#;#classpath#.#createPathElement#(#)#.#setPath#(#javaccJar#.#getAbsolutePath#(#)#)#;#classpath#.#addJavaRuntime#(#)#;#cmdl#.#setClassname#(#JavaCC#.#getMainClass#(#classpath#,#JavaCC#.#TASKDEF_TYPE_JJDOC#)#)#;#final#Commandline#.#Argument#arg#=#cmdl#.#createVmArgument#(#)#;#arg#.#setValue#(#"-mx140M"#)#;#arg#.#setValue#(#"-Dinstall.root="#+#javaccHome#.#getAbsolutePath#(#)#)#;#final#Execute#process#=#new#Execute#(#new#LogStreamHandler#(#this#,#Project#.#MSG_INFO#,#Project#.#MSG_INFO#)#,#null#)#;#log#(#cmdl#.#describeCommand#(#)#,#Project#.#MSG_VERBOSE#)#;#process#.#setCommandline#(#cmdl#.#getCommandline#(#)#)#;#try#{#if#(#process#.#execute#(#)#!=#0#)#{#throw#new#BuildException#(#"JJDoc failed."#)#;#}#}#catch#(#IOException#e#)#{#throw#new#BuildException#(#"Failed to launch JJDoc"#,#e#)#;#}#}##String#createOutputFileName#(#File#destFile#,#String#optionalOutputFile#,#boolean#plain#)#{#String#suffix#=#DEFAULT_SUFFIX_HTML#;#String#javaccFile#=#destFile#.#getAbsolutePath#(#)#.#replace#(#'\\'#,#'/'#)#;#if#(#plain#)#{#suffix#=#DEFAULT_SUFFIX_TEXT#;#}#if#(#(#optionalOutputFile#==#null#)#||#optionalOutputFile#.#equals#(#""#)#)#{#int#filePos#=#javaccFile#.#lastIndexOf#(#"/"#)#;#if#(#filePos#>=#0#)#{#javaccFile#=#javaccFile#.#substring#(#filePos#+#1#)#;#}#int#suffixPos#=#javaccFile#.#lastIndexOf#(#'.'#)#;#if#(#suffixPos#==#-#1#)#{#optionalOutputFile#=#javaccFile#+#suffix#;#}#else#{#String#currentSuffix#=#javaccFile#.#substring#(#suffixPos#)#;#if#(#currentSuffix#.#equals#(#suffix#)#)#{#optionalOutputFile#=#javaccFile#+#suffix#;#}#else#{#optionalOutputFile#=#javaccFile#.#substring#(#0#,#suffixPos#)#+#suffix#;#}#}#}#else#{#optionalOutputFile#=#optionalOutputFile#.#replace#(#'\\'#,#'/'#)#;#}#return#(#getProject#(#)#.#getBaseDir#(#)#+#"/"#+#optionalOutputFile#)#.#replace#(#'\\'#,#'/'#)#;#}##