void#setBuildnodefiles#(#boolean#buildNodeFiles#)#{#optionalAttrs#.#put#(#BUILD_NODE_FILES#,#buildNodeFiles#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setMulti#(#boolean#multi#)#{#optionalAttrs#.#put#(#MULTI#,#multi#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setNodedefaultvoid#(#boolean#nodeDefaultVoid#)#{#optionalAttrs#.#put#(#NODE_DEFAULT_VOID#,#nodeDefaultVoid#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setNodefactory#(#boolean#nodeFactory#)#{#optionalAttrs#.#put#(#NODE_FACTORY#,#nodeFactory#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setNodescopehook#(#boolean#nodeScopeHook#)#{#optionalAttrs#.#put#(#NODE_SCOPE_HOOK#,#nodeScopeHook#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setNodeusesparser#(#boolean#nodeUsesParser#)#{#optionalAttrs#.#put#(#NODE_USES_PARSER#,#nodeUsesParser#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setStatic#(#boolean#staticParser#)#{#optionalAttrs#.#put#(#STATIC#,#staticParser#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setVisitor#(#boolean#visitor#)#{#optionalAttrs#.#put#(#VISITOR#,#visitor#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setNodepackage#(#String#nodePackage#)#{#optionalAttrs#.#put#(#NODE_PACKAGE#,#nodePackage#)#;#}##void#setVisitorException#(#String#visitorException#)#{#optionalAttrs#.#put#(#VISITOR_EXCEPTION#,#visitorException#)#;#}##void#setNodeprefix#(#String#nodePrefix#)#{#optionalAttrs#.#put#(#NODE_PREFIX#,#nodePrefix#)#;#}##void#setOutputdirectory#(#File#outputDirectory#)#{#this#.#outputDirectory#=#outputDirectory#;#}##void#setOutputfile#(#String#outputFile#)#{#this#.#outputFile#=#outputFile#;#}##void#setTarget#(#File#targetFile#)#{#this#.#targetFile#=#targetFile#;#}##void#setJavacchome#(#File#javaccHome#)#{#this#.#javaccHome#=#javaccHome#;#}##void#execute#(#)#throws#BuildException#{#// load command line with optional attributes#Enumeration#iter#=#optionalAttrs#.#keys#(#)#;#while#(#iter#.#hasMoreElements#(#)#)#{#String#name#=#(#String#)#iter#.#nextElement#(#)#;#Object#value#=#optionalAttrs#.#get#(#name#)#;#cmdl#.#createArgument#(#)#.#setValue#(#"-"#+#name#+#":"#+#value#.#toString#(#)#)#;#}#if#(#targetFile#==#null#||#!#targetFile#.#isFile#(#)#)#{#throw#new#BuildException#(#"Invalid target: "#+#targetFile#)#;#}#File#javaFile#=#null#;#// use the directory containing the target as the output directory#if#(#outputDirectory#==#null#)#{#// convert backslashes to slashes, otherwise jjtree will#// put this as comments and this seems to confuse javacc#cmdl#.#createArgument#(#)#.#setValue#(#"-OUTPUT_DIRECTORY:"#+#getDefaultOutputDirectory#(#)#)#;#javaFile#=#new#File#(#createOutputFileName#(#targetFile#,#outputFile#,#null#)#)#;#}#else#{#if#(#!#outputDirectory#.#isDirectory#(#)#)#{#throw#new#BuildException#(#"'outputdirectory' "#+#outputDirectory#+#" is not a directory."#)#;#}#// convert backslashes to slashes, otherwise jjtree will#// put this as comments and this seems to confuse javacc#cmdl#.#createArgument#(#)#.#setValue#(#"-OUTPUT_DIRECTORY:"#+#outputDirectory#.#getAbsolutePath#(#)#.#replace#(#'\\'#,#'/'#)#)#;#javaFile#=#new#File#(#createOutputFileName#(#targetFile#,#outputFile#,#outputDirectory#.#getPath#(#)#)#)#;#}#if#(#javaFile#.#exists#(#)#&&#targetFile#.#lastModified#(#)#<#javaFile#.#lastModified#(#)#)#{#log#(#"Target is already built - skipping ("#+#targetFile#+#")"#,#Project#.#MSG_VERBOSE#)#;#return#;#}#if#(#outputFile#!=#null#)#{#cmdl#.#createArgument#(#)#.#setValue#(#"-"#+#OUTPUT_FILE#+#":"#+#outputFile#.#replace#(#'\\'#,#'/'#)#)#;#}#cmdl#.#createArgument#(#)#.#setValue#(#targetFile#.#getAbsolutePath#(#)#)#;#final#Path#classpath#=#cmdl#.#createClasspath#(#getProject#(#)#)#;#final#File#javaccJar#=#JavaCC#.#getArchiveFile#(#javaccHome#)#;#classpath#.#createPathElement#(#)#.#setPath#(#javaccJar#.#getAbsolutePath#(#)#)#;#classpath#.#addJavaRuntime#(#)#;#cmdl#.#setClassname#(#JavaCC#.#getMainClass#(#classpath#,#JavaCC#.#TASKDEF_TYPE_JJTREE#)#)#;#final#Commandline#.#Argument#arg#=#cmdl#.#createVmArgument#(#)#;#arg#.#setValue#(#"-mx140M"#)#;#arg#.#setValue#(#"-Dinstall.root="#+#javaccHome#.#getAbsolutePath#(#)#)#;#final#Execute#process#=#new#Execute#(#new#LogStreamHandler#(#this#,#Project#.#MSG_INFO#,#Project#.#MSG_INFO#)#,#null#)#;#log#(#cmdl#.#describeCommand#(#)#,#Project#.#MSG_VERBOSE#)#;#process#.#setCommandline#(#cmdl#.#getCommandline#(#)#)#;#try#{#if#(#process#.#execute#(#)#!=#0#)#{#throw#new#BuildException#(#"JJTree failed."#)#;#}#}#catch#(#IOException#e#)#{#throw#new#BuildException#(#"Failed to launch JJTree"#,#e#)#;#}#}##String#createOutputFileName#(#File#destFile#,#String#optionalOutputFile#,#String#outputDir#)#{#optionalOutputFile#=#validateOutputFile#(#optionalOutputFile#,#outputDir#)#;#String#jjtreeFile#=#destFile#.#getAbsolutePath#(#)#.#replace#(#'\\'#,#'/'#)#;#if#(#(#optionalOutputFile#==#null#)#||#optionalOutputFile#.#equals#(#""#)#)#{#int#filePos#=#jjtreeFile#.#lastIndexOf#(#"/"#)#;#if#(#filePos#>=#0#)#{#jjtreeFile#=#jjtreeFile#.#substring#(#filePos#+#1#)#;#}#int#suffixPos#=#jjtreeFile#.#lastIndexOf#(#'.'#)#;#if#(#suffixPos#==#-#1#)#{#optionalOutputFile#=#jjtreeFile#+#DEFAULT_SUFFIX#;#}#else#{#String#currentSuffix#=#jjtreeFile#.#substring#(#suffixPos#)#;#if#(#currentSuffix#.#equals#(#DEFAULT_SUFFIX#)#)#{#optionalOutputFile#=#jjtreeFile#+#DEFAULT_SUFFIX#;#}#else#{#optionalOutputFile#=#jjtreeFile#.#substring#(#0#,#suffixPos#)#+#DEFAULT_SUFFIX#;#}#}#}#if#(#(#outputDir#==#null#)#||#outputDir#.#equals#(#""#)#)#{#outputDir#=#getDefaultOutputDirectory#(#)#;#}#return#(#outputDir#+#"/"#+#optionalOutputFile#)#.#replace#(#'\\'#,#'/'#)#;#}##String#validateOutputFile#(#String#destFile#,#String#outputDir#)#throws#BuildException#{#if#(#destFile#==#null#)#{#return#null#;#}#if#(#(#outputDir#==#null#)#&&#(#destFile#.#startsWith#(#"/"#)#||#destFile#.#startsWith#(#"\\"#)#)#)#{#String#relativeOutputFile#=#makeOutputFileRelative#(#destFile#)#;#setOutputfile#(#relativeOutputFile#)#;#return#relativeOutputFile#;#}#String#root#=#getRoot#(#new#File#(#destFile#)#)#.#getAbsolutePath#(#)#;#if#(#(#root#.#length#(#)#>#1#)#&&#destFile#.#startsWith#(#root#.#substring#(#0#,#root#.#length#(#)#-#1#)#)#)#{#throw#new#BuildException#(#"Drive letter in 'outputfile' not "#+#"supported: "#+#destFile#)#;#}#return#destFile#;#}##String#makeOutputFileRelative#(#String#destFile#)#{#StringBuffer#relativePath#=#new#StringBuffer#(#)#;#String#defaultOutputDirectory#=#getDefaultOutputDirectory#(#)#;#int#nextPos#=#defaultOutputDirectory#.#indexOf#(#'/'#)#;#int#startPos#=#nextPos#+#1#;#while#(#startPos#>#-#1#&&#startPos#<#defaultOutputDirectory#.#length#(#)#)#{#relativePath#.#append#(#"/.."#)#;#nextPos#=#defaultOutputDirectory#.#indexOf#(#'/'#,#startPos#)#;#if#(#nextPos#==#-#1#)#{#startPos#=#nextPos#;#}#else#{#startPos#=#nextPos#+#1#;#}#}#relativePath#.#append#(#destFile#)#;#return#relativePath#.#toString#(#)#;#}##String#getDefaultOutputDirectory#(#)#{#return#getProject#(#)#.#getBaseDir#(#)#.#getAbsolutePath#(#)#.#replace#(#'\\'#,#'/'#)#;#}##File#getRoot#(#File#file#)#{#File#root#=#file#.#getAbsoluteFile#(#)#;#while#(#root#.#getParent#(#)#!=#null#)#{#root#=#root#.#getParentFile#(#)#;#}#return#root#;#}##