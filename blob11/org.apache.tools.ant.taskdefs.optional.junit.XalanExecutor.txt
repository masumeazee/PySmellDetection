void#setCaller#(#AggregateTransformer#caller#)#{#this#.#caller#=#caller#;#}##OutputStream#getOutputStream#(#)#throws#IOException#{#if#(#AggregateTransformer#.#FRAMES#.#equals#(#caller#.#format#)#)#{#// dummy output for the framed report#// it's all done by extension...#return#new#ByteArrayOutputStream#(#)#;#}#else#{#return#new#BufferedOutputStream#(#new#FileOutputStream#(#new#File#(#caller#.#toDir#,#"junit-noframes.html"#)#)#)#;#}#}##void#execute#(#)#throws#Exception#;##XalanExecutor#newInstance#(#AggregateTransformer#caller#)#throws#BuildException#{#XalanExecutor#executor#=#null#;#try#{#Class#clazz#=#Class#.#forName#(#PACKAGE#+#"Xalan2Executor"#)#;#executor#=#(#XalanExecutor#)#clazz#.#newInstance#(#)#;#}#catch#(#Exception#xsltcApacheMissing#)#{#caller#.#task#.#log#(#xsltcApacheMissing#.#toString#(#)#)#;#throw#new#BuildException#(#"Could not find xstlc nor xalan2 "#+#"in the classpath. Check "#+#"http://xml.apache.org/xalan-j"#)#;#}#String#classNameImpl#=#executor#.#getImplementation#(#)#;#String#version#=#executor#.#getProcVersion#(#classNameImpl#)#;#caller#.#task#.#log#(#"Using "#+#version#,#Project#.#MSG_VERBOSE#)#;#executor#.#setCaller#(#caller#)#;#return#executor#;#}##String#getImplementation#(#)#;##String#getProcVersion#(#String#classNameImpl#)#throws#BuildException#;##String#getXSLTCVersion#(#String#procVersionClassName#)#throws#ClassNotFoundException#{#// there's a convenient xsltc class version but data are#// private so use package information#Class#procVersion#=#Class#.#forName#(#procVersionClassName#)#;#Package#pkg#=#procVersion#.#getPackage#(#)#;#return#pkg#.#getName#(#)#+#" "#+#pkg#.#getImplementationTitle#(#)#+#" "#+#pkg#.#getImplementationVersion#(#)#;#}##String#getXalanVersion#(#String#procVersionClassName#)#throws#ClassNotFoundException#{#Class#procVersion#=#Class#.#forName#(#procVersionClassName#)#;#String#pkg#=#procVersion#.#getPackage#(#)#.#getName#(#)#;#try#{#Field#f#=#procVersion#.#getField#(#"S_VERSION"#)#;#return#pkg#+#" "#+#f#.#get#(#null#)#.#toString#(#)#;#}#catch#(#Exception#e#)#{#return#pkg#+#" ?.?"#;#}#}##