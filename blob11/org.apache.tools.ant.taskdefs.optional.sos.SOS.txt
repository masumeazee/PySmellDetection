void#setNoCache#(#boolean#nocache#)#{#noCache#=#nocache#;#}##void#setNoCompress#(#boolean#nocompress#)#{#noCompress#=#nocompress#;#}##void#setSosCmd#(#String#dir#)#{#sosCmdDir#=#FileUtils#.#translatePath#(#dir#)#;#}##void#setUsername#(#String#username#)#{#sosUsername#=#username#;#}##void#setPassword#(#String#password#)#{#sosPassword#=#password#;#}##void#setProjectPath#(#String#projectpath#)#{#if#(#projectpath#.#startsWith#(#SOSCmd#.#PROJECT_PREFIX#)#)#{#projectPath#=#projectpath#;#}#else#{#projectPath#=#SOSCmd#.#PROJECT_PREFIX#+#projectpath#;#}#}##void#setVssServerPath#(#String#vssServerPath#)#{#this#.#vssServerPath#=#vssServerPath#;#}##void#setSosHome#(#String#sosHome#)#{#this#.#sosHome#=#sosHome#;#}##void#setSosServerPath#(#String#sosServerPath#)#{#this#.#sosServerPath#=#sosServerPath#;#}##void#setLocalPath#(#Path#path#)#{#localPath#=#path#.#toString#(#)#;#}##void#setVerbose#(#boolean#verbose#)#{#this#.#verbose#=#verbose#;#}##void#setInternalFilename#(#String#file#)#{#filename#=#file#;#}##void#setInternalRecursive#(#boolean#recurse#)#{#recursive#=#recurse#;#}##void#setInternalComment#(#String#text#)#{#comment#=#text#;#}##void#setInternalLabel#(#String#text#)#{#label#=#text#;#}##void#setInternalVersion#(#String#text#)#{#version#=#text#;#}##String#getSosCommand#(#)#{#if#(#sosCmdDir#==#null#)#{#return#COMMAND_SOS_EXE#;#}#else#{#return#sosCmdDir#+#File#.#separator#+#COMMAND_SOS_EXE#;#}#}##String#getComment#(#)#{#return#comment#;#}##String#getVersion#(#)#{#return#version#;#}##String#getLabel#(#)#{#return#label#;#}##String#getUsername#(#)#{#return#sosUsername#;#}##String#getPassword#(#)#{#return#sosPassword#;#}##String#getProjectPath#(#)#{#return#projectPath#;#}##String#getVssServerPath#(#)#{#return#vssServerPath#;#}##String#getSosHome#(#)#{#return#sosHome#;#}##String#getSosServerPath#(#)#{#return#sosServerPath#;#}##String#getFilename#(#)#{#return#filename#;#}##String#getNoCompress#(#)#{#return#noCompress#?#FLAG_NO_COMPRESSION#:#""#;#}##String#getNoCache#(#)#{#return#noCache#?#FLAG_NO_CACHE#:#""#;#}##String#getVerbose#(#)#{#return#verbose#?#FLAG_VERBOSE#:#""#;#}##String#getRecursive#(#)#{#return#recursive#?#FLAG_RECURSION#:#""#;#}##String#getLocalPath#(#)#{#if#(#localPath#==#null#)#{#return#getProject#(#)#.#getBaseDir#(#)#.#getAbsolutePath#(#)#;#}#else#{#// make sure localDir exists, create it if it doesn't#File#dir#=#getProject#(#)#.#resolveFile#(#localPath#)#;#if#(#!#dir#.#exists#(#)#)#{#boolean#done#=#dir#.#mkdirs#(#)#;#if#(#!#done#)#{#String#msg#=#"Directory "#+#localPath#+#" creation was not "#+#"successful for an unknown reason"#;#throw#new#BuildException#(#msg#,#getLocation#(#)#)#;#}#getProject#(#)#.#log#(#"Created dir: "#+#dir#.#getAbsolutePath#(#)#)#;#}#return#dir#.#getAbsolutePath#(#)#;#}#}##Commandline#buildCmdLine#(#)#;##void#execute#(#)#throws#BuildException#{#int#result#=#0#;#buildCmdLine#(#)#;#result#=#run#(#commandLine#)#;#if#(#result#==#ERROR_EXIT_STATUS#)#{#// This is the exit status#String#msg#=#"Failed executing: "#+#commandLine#.#toString#(#)#;#throw#new#BuildException#(#msg#,#getLocation#(#)#)#;#}#}##int#run#(#Commandline#cmd#)#{#try#{#Execute#exe#=#new#Execute#(#new#LogStreamHandler#(#this#,#Project#.#MSG_INFO#,#Project#.#MSG_WARN#)#)#;#exe#.#setAntRun#(#getProject#(#)#)#;#exe#.#setWorkingDirectory#(#getProject#(#)#.#getBaseDir#(#)#)#;#exe#.#setCommandline#(#cmd#.#getCommandline#(#)#)#;#exe#.#setVMLauncher#(#false#)#;#// Use the OS VM launcher so we get environment variables#return#exe#.#execute#(#)#;#}#catch#(#java#.#io#.#IOException#e#)#{#throw#new#BuildException#(#e#,#getLocation#(#)#)#;#}#}##void#getRequiredAttributes#(#)#{#// Get the path to the soscmd(.exe)#commandLine#.#setExecutable#(#getSosCommand#(#)#)#;#// SOS server address is required#if#(#getSosServerPath#(#)#==#null#)#{#throw#new#BuildException#(#"sosserverpath attribute must be set!"#,#getLocation#(#)#)#;#}#commandLine#.#createArgument#(#)#.#setValue#(#FLAG_SOS_SERVER#)#;#commandLine#.#createArgument#(#)#.#setValue#(#getSosServerPath#(#)#)#;#// Login info is required#if#(#getUsername#(#)#==#null#)#{#throw#new#BuildException#(#"username attribute must be set!"#,#getLocation#(#)#)#;#}#commandLine#.#createArgument#(#)#.#setValue#(#FLAG_USERNAME#)#;#commandLine#.#createArgument#(#)#.#setValue#(#getUsername#(#)#)#;#// The SOS class knows that the SOS server needs the password flag,#// even if there is no password ,so we send a " "#commandLine#.#createArgument#(#)#.#setValue#(#FLAG_PASSWORD#)#;#commandLine#.#createArgument#(#)#.#setValue#(#getPassword#(#)#)#;#// VSS Info is required#if#(#getVssServerPath#(#)#==#null#)#{#throw#new#BuildException#(#"vssserverpath attribute must be set!"#,#getLocation#(#)#)#;#}#commandLine#.#createArgument#(#)#.#setValue#(#FLAG_VSS_SERVER#)#;#commandLine#.#createArgument#(#)#.#setValue#(#getVssServerPath#(#)#)#;#// VSS project is required#if#(#getProjectPath#(#)#==#null#)#{#throw#new#BuildException#(#"projectpath attribute must be set!"#,#getLocation#(#)#)#;#}#commandLine#.#createArgument#(#)#.#setValue#(#FLAG_PROJECT#)#;#commandLine#.#createArgument#(#)#.#setValue#(#getProjectPath#(#)#)#;#}##void#getOptionalAttributes#(#)#{#// -verbose#commandLine#.#createArgument#(#)#.#setValue#(#getVerbose#(#)#)#;#// Disable Compression#commandLine#.#createArgument#(#)#.#setValue#(#getNoCompress#(#)#)#;#// Path to the SourceOffSite home directory /home/user/.sos#if#(#getSosHome#(#)#==#null#)#{#// If -soshome was not specified then we can look for nocache#commandLine#.#createArgument#(#)#.#setValue#(#getNoCache#(#)#)#;#}#else#{#commandLine#.#createArgument#(#)#.#setValue#(#FLAG_SOS_HOME#)#;#commandLine#.#createArgument#(#)#.#setValue#(#getSosHome#(#)#)#;#}#//If a working directory was specified then add it to the command line#if#(#getLocalPath#(#)#!=#null#)#{#commandLine#.#createArgument#(#)#.#setValue#(#FLAG_WORKING_DIR#)#;#commandLine#.#createArgument#(#)#.#setValue#(#getLocalPath#(#)#)#;#}#}##