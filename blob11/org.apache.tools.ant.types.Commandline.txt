void#setValue#(#String#value#)#{#parts#=#new#String#[#]#{#value#}#;#}##void#setLine#(#String#line#)#{#if#(#line#==#null#)#{#return#;#}#parts#=#translateCommandline#(#line#)#;#}##void#setPath#(#Path#value#)#{#parts#=#new#String#[#]#{#value#.#toString#(#)#}#;#}##void#setPathref#(#Reference#value#)#{#Path#p#=#new#Path#(#getProject#(#)#)#;#p#.#setRefid#(#value#)#;#parts#=#new#String#[#]#{#p#.#toString#(#)#}#;#}##void#setFile#(#File#value#)#{#parts#=#new#String#[#]#{#value#.#getAbsolutePath#(#)#}#;#}##void#setPrefix#(#String#prefix#)#{#this#.#prefix#=#prefix#!=#null#?#prefix#:#""#;#}##void#setSuffix#(#String#suffix#)#{#this#.#suffix#=#suffix#!=#null#?#suffix#:#""#;#}##String#[#]#getParts#(#)#{#if#(#parts#==#null#||#parts#.#length#==#0#||#(#prefix#.#length#(#)#==#0#&&#suffix#.#length#(#)#==#0#)#)#{#return#parts#;#}#String#[#]#fullParts#=#new#String#[#parts#.#length#]#;#for#(#int#i#=#0#;#i#<#fullParts#.#length#;#++#i#)#{#fullParts#[#i#]#=#prefix#+#parts#[#i#]#+#suffix#;#}#return#fullParts#;#}##int#getPosition#(#)#{#if#(#realPos#==#-#1#)#{#realPos#=#(#executable#==#null#?#0#:#1#)#;#for#(#int#i#=#0#;#i#<#position#;#i#++#)#{#Argument#arg#=#(#Argument#)#arguments#.#elementAt#(#i#)#;#realPos#+=#arg#.#getParts#(#)#.#length#;#}#}#return#realPos#;#}##void#setPrefix#(#String#prefix#)#{#this#.#prefix#=#prefix#!=#null#?#prefix#:#""#;#}##String#getPrefix#(#)#{#return#prefix#;#}##void#setSuffix#(#String#suffix#)#{#this#.#suffix#=#suffix#!=#null#?#suffix#:#""#;#}##String#getSuffix#(#)#{#return#suffix#;#}##Argument#createArgument#(#)#{#return#this#.#createArgument#(#false#)#;#}##Argument#createArgument#(#boolean#insertAtStart#)#{#Argument#argument#=#new#Argument#(#)#;#if#(#insertAtStart#)#{#arguments#.#insertElementAt#(#argument#,#0#)#;#}#else#{#arguments#.#addElement#(#argument#)#;#}#return#argument#;#}##void#setExecutable#(#String#executable#)#{#if#(#executable#==#null#||#executable#.#length#(#)#==#0#)#{#return#;#}#this#.#executable#=#executable#.#replace#(#'/'#,#File#.#separatorChar#)#.#replace#(#'\\'#,#File#.#separatorChar#)#;#}##String#getExecutable#(#)#{#return#executable#;#}##void#addArguments#(#String#[#]#line#)#{#for#(#int#i#=#0#;#i#<#line#.#length#;#i#++#)#{#createArgument#(#)#.#setValue#(#line#[#i#]#)#;#}#}##String#[#]#getCommandline#(#)#{#List#commands#=#new#LinkedList#(#)#;#ListIterator#list#=#commands#.#listIterator#(#)#;#addCommandToList#(#list#)#;#final#String#[#]#result#=#new#String#[#commands#.#size#(#)#]#;#return#(#String#[#]#)#commands#.#toArray#(#result#)#;#}##void#addCommandToList#(#ListIterator#list#)#{#if#(#executable#!=#null#)#{#list#.#add#(#executable#)#;#}#addArgumentsToList#(#list#)#;#}##String#[#]#getArguments#(#)#{#List#result#=#new#ArrayList#(#arguments#.#size#(#)#*#2#)#;#addArgumentsToList#(#result#.#listIterator#(#)#)#;#String#[#]#res#=#new#String#[#result#.#size#(#)#]#;#return#(#String#[#]#)#result#.#toArray#(#res#)#;#}##void#addArgumentsToList#(#ListIterator#list#)#{#for#(#int#i#=#0#;#i#<#arguments#.#size#(#)#;#i#++#)#{#Argument#arg#=#(#Argument#)#arguments#.#elementAt#(#i#)#;#String#[#]#s#=#arg#.#getParts#(#)#;#if#(#s#!=#null#)#{#for#(#int#j#=#0#;#j#<#s#.#length#;#j#++#)#{#list#.#add#(#s#[#j#]#)#;#}#}#}#}##String#toString#(#)#{#return#toString#(#getCommandline#(#)#)#;#}##String#quoteArgument#(#String#argument#)#{#if#(#argument#.#indexOf#(#"\""#)#>#-#1#)#{#if#(#argument#.#indexOf#(#"\'"#)#>#-#1#)#{#throw#new#BuildException#(#"Can\'t handle single and double"#+#" quotes in same argument"#)#;#}#else#{#return#'\''#+#argument#+#'\''#;#}#}#else#if#(#argument#.#indexOf#(#"\'"#)#>#-#1#||#argument#.#indexOf#(#" "#)#>#-#1#// WIN9x uses a bat file for executing commands#||#(#IS_WIN_9X#&&#argument#.#indexOf#(#';'#)#!=#-#1#)#)#{#return#'\"'#+#argument#+#'\"'#;#}#else#{#return#argument#;#}#}##String#toString#(#String#[#]#line#)#{#// empty path return empty string#if#(#line#==#null#||#line#.#length#==#0#)#{#return#""#;#}#// path containing one or more elements#final#StringBuffer#result#=#new#StringBuffer#(#)#;#for#(#int#i#=#0#;#i#<#line#.#length#;#i#++#)#{#if#(#i#>#0#)#{#result#.#append#(#' '#)#;#}#result#.#append#(#quoteArgument#(#line#[#i#]#)#)#;#}#return#result#.#toString#(#)#;#}##String#[#]#translateCommandline#(#String#toProcess#)#{#if#(#toProcess#==#null#||#toProcess#.#length#(#)#==#0#)#{#//no command? no string#return#new#String#[#0#]#;#}#// parse with a simple finite state machine#final#int#normal#=#0#;#final#int#inQuote#=#1#;#final#int#inDoubleQuote#=#2#;#int#state#=#normal#;#StringTokenizer#tok#=#new#StringTokenizer#(#toProcess#,#"\"\' "#,#true#)#;#Vector#v#=#new#Vector#(#)#;#StringBuffer#current#=#new#StringBuffer#(#)#;#boolean#lastTokenHasBeenQuoted#=#false#;#while#(#tok#.#hasMoreTokens#(#)#)#{#String#nextTok#=#tok#.#nextToken#(#)#;#switch#(#state#)#{#case#inQuote#:#if#(#"\'"#.#equals#(#nextTok#)#)#{#lastTokenHasBeenQuoted#=#true#;#state#=#normal#;#}#else#{#current#.#append#(#nextTok#)#;#}#break#;#case#inDoubleQuote#:#if#(#"\""#.#equals#(#nextTok#)#)#{#lastTokenHasBeenQuoted#=#true#;#state#=#normal#;#}#else#{#current#.#append#(#nextTok#)#;#}#break#;#default#:#if#(#"\'"#.#equals#(#nextTok#)#)#{#state#=#inQuote#;#}#else#if#(#"\""#.#equals#(#nextTok#)#)#{#state#=#inDoubleQuote#;#}#else#if#(#" "#.#equals#(#nextTok#)#)#{#if#(#lastTokenHasBeenQuoted#||#current#.#length#(#)#!=#0#)#{#v#.#addElement#(#current#.#toString#(#)#)#;#current#=#new#StringBuffer#(#)#;#}#}#else#{#current#.#append#(#nextTok#)#;#}#lastTokenHasBeenQuoted#=#false#;#break#;#}#}#if#(#lastTokenHasBeenQuoted#||#current#.#length#(#)#!=#0#)#{#v#.#addElement#(#current#.#toString#(#)#)#;#}#if#(#state#==#inQuote#||#state#==#inDoubleQuote#)#{#throw#new#BuildException#(#"unbalanced quotes in "#+#toProcess#)#;#}#String#[#]#args#=#new#String#[#v#.#size#(#)#]#;#v#.#copyInto#(#args#)#;#return#args#;#}##int#size#(#)#{#return#getCommandline#(#)#.#length#;#}##Object#clone#(#)#{#try#{#Commandline#c#=#(#Commandline#)#super#.#clone#(#)#;#c#.#arguments#=#(#Vector#)#arguments#.#clone#(#)#;#return#c#;#}#catch#(#CloneNotSupportedException#e#)#{#throw#new#BuildException#(#e#)#;#}#}##void#clear#(#)#{#executable#=#null#;#arguments#.#removeAllElements#(#)#;#}##void#clearArgs#(#)#{#arguments#.#removeAllElements#(#)#;#}##Marker#createMarker#(#)#{#return#new#Marker#(#arguments#.#size#(#)#)#;#}##String#describeCommand#(#)#{#return#describeCommand#(#this#)#;#}##String#describeArguments#(#)#{#return#describeArguments#(#this#)#;#}##String#describeCommand#(#Commandline#line#)#{#return#describeCommand#(#line#.#getCommandline#(#)#)#;#}##String#describeArguments#(#Commandline#line#)#{#return#describeArguments#(#line#.#getArguments#(#)#)#;#}##String#describeCommand#(#String#[#]#args#)#{#if#(#args#==#null#||#args#.#length#==#0#)#{#return#""#;#}#StringBuffer#buf#=#new#StringBuffer#(#"Executing \'"#)#;#buf#.#append#(#args#[#0#]#)#;#buf#.#append#(#"\'"#)#;#if#(#args#.#length#>#1#)#{#buf#.#append#(#" with "#)#;#buf#.#append#(#describeArguments#(#args#,#1#)#)#;#}#else#{#buf#.#append#(#DISCLAIMER#)#;#}#return#buf#.#toString#(#)#;#}##String#describeArguments#(#String#[#]#args#)#{#return#describeArguments#(#args#,#0#)#;#}##String#describeArguments#(#String#[#]#args#,#int#offset#)#{#if#(#args#==#null#||#args#.#length#<=#offset#)#{#return#""#;#}#StringBuffer#buf#=#new#StringBuffer#(#"argument"#)#;#if#(#args#.#length#>#offset#)#{#buf#.#append#(#"s"#)#;#}#buf#.#append#(#":"#)#.#append#(#StringUtils#.#LINE_SEP#)#;#for#(#int#i#=#offset#;#i#<#args#.#length#;#i#++#)#{#buf#.#append#(#"\'"#)#.#append#(#args#[#i#]#)#.#append#(#"\'"#)#.#append#(#StringUtils#.#LINE_SEP#)#;#}#buf#.#append#(#DISCLAIMER#)#;#return#buf#.#toString#(#)#;#}##Iterator#iterator#(#)#{#return#arguments#.#iterator#(#)#;#}##