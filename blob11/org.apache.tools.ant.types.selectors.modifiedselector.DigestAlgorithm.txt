void#setAlgorithm#(#String#algorithm#)#{#this#.#algorithm#=#algorithm#;#}##void#setProvider#(#String#provider#)#{#this#.#provider#=#provider#;#}##void#initMessageDigest#(#)#{#if#(#messageDigest#!=#null#)#{#return#;#}#if#(#(#provider#!=#null#)#&&#!#""#.#equals#(#provider#)#&&#!#"null"#.#equals#(#provider#)#)#{#try#{#messageDigest#=#MessageDigest#.#getInstance#(#algorithm#,#provider#)#;#}#catch#(#NoSuchAlgorithmException#noalgo#)#{#throw#new#BuildException#(#noalgo#)#;#}#catch#(#NoSuchProviderException#noprovider#)#{#throw#new#BuildException#(#noprovider#)#;#}#}#else#{#try#{#messageDigest#=#MessageDigest#.#getInstance#(#algorithm#)#;#}#catch#(#NoSuchAlgorithmException#noalgo#)#{#throw#new#BuildException#(#noalgo#)#;#}#}#}##boolean#isValid#(#)#{#return#"SHA"#.#equalsIgnoreCase#(#algorithm#)#||#"MD5"#.#equalsIgnoreCase#(#algorithm#)#;#}##String#getValue#(#File#file#)#{#initMessageDigest#(#)#;#String#checksum#=#null#;#try#{#if#(#!#file#.#canRead#(#)#)#{#return#null#;#}#FileInputStream#fis#=#null#;#byte#[#]#buf#=#new#byte#[#readBufferSize#]#;#try#{#messageDigest#.#reset#(#)#;#fis#=#new#FileInputStream#(#file#)#;#DigestInputStream#dis#=#new#DigestInputStream#(#fis#,#messageDigest#)#;#while#(#dis#.#read#(#buf#,#0#,#readBufferSize#)#!=#-#1#)#{#// do nothing#}#dis#.#close#(#)#;#fis#.#close#(#)#;#fis#=#null#;#byte#[#]#fileDigest#=#messageDigest#.#digest#(#)#;#StringBuffer#checksumSb#=#new#StringBuffer#(#)#;#for#(#int#i#=#0#;#i#<#fileDigest#.#length#;#i#++#)#{#String#hexStr#=#Integer#.#toHexString#(#BYTE_MASK#&#fileDigest#[#i#]#)#;#if#(#hexStr#.#length#(#)#<#2#)#{#checksumSb#.#append#(#"0"#)#;#}#checksumSb#.#append#(#hexStr#)#;#}#checksum#=#checksumSb#.#toString#(#)#;#}#catch#(#Exception#e#)#{#return#null#;#}#}#catch#(#Exception#e#)#{#return#null#;#}#return#checksum#;#}##String#toString#(#)#{#StringBuffer#buf#=#new#StringBuffer#(#)#;#buf#.#append#(#"<DigestAlgorithm:"#)#;#buf#.#append#(#"algorithm="#)#.#append#(#algorithm#)#;#buf#.#append#(#";provider="#)#.#append#(#provider#)#;#buf#.#append#(#">"#)#;#return#buf#.#toString#(#)#;#}##