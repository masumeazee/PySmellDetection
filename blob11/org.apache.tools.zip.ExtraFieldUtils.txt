void#register#(#Class#c#)#{#try#{#ZipExtraField#ze#=#(#ZipExtraField#)#c#.#newInstance#(#)#;#implementations#.#put#(#ze#.#getHeaderId#(#)#,#c#)#;#}#catch#(#ClassCastException#cc#)#{#throw#new#RuntimeException#(#c#+#" doesn\'t implement ZipExtraField"#)#;#}#catch#(#InstantiationException#ie#)#{#throw#new#RuntimeException#(#c#+#" is not a concrete class"#)#;#}#catch#(#IllegalAccessException#ie#)#{#throw#new#RuntimeException#(#c#+#"\'s no-arg constructor is not public"#)#;#}#}##ZipExtraField#createExtraField#(#ZipShort#headerId#)#throws#InstantiationException#,#IllegalAccessException#{#Class#c#=#(#Class#)#implementations#.#get#(#headerId#)#;#if#(#c#!=#null#)#{#return#(#ZipExtraField#)#c#.#newInstance#(#)#;#}#UnrecognizedExtraField#u#=#new#UnrecognizedExtraField#(#)#;#u#.#setHeaderId#(#headerId#)#;#return#u#;#}##ZipExtraField#[#]#parse#(#byte#[#]#data#)#throws#ZipException#{#return#parse#(#data#,#true#)#;#}##ZipExtraField#[#]#parse#(#byte#[#]#data#,#boolean#local#)#throws#ZipException#{#List#v#=#new#ArrayList#(#)#;#int#start#=#0#;#while#(#start#<=#data#.#length#-#WORD#)#{#ZipShort#headerId#=#new#ZipShort#(#data#,#start#)#;#int#length#=#(#new#ZipShort#(#data#,#start#+#2#)#)#.#getValue#(#)#;#if#(#start#+#WORD#+#length#>#data#.#length#)#{#throw#new#ZipException#(#"data starting at "#+#start#+#" is in unknown format"#)#;#}#try#{#ZipExtraField#ze#=#createExtraField#(#headerId#)#;#if#(#local#||#!#(#ze#instanceof#CentralDirectoryParsingZipExtraField#)#)#{#ze#.#parseFromLocalFileData#(#data#,#start#+#WORD#,#length#)#;#}#else#{#(#(#CentralDirectoryParsingZipExtraField#)#ze#)#.#parseFromCentralDirectoryData#(#data#,#start#+#WORD#,#length#)#;#}#v#.#add#(#ze#)#;#}#catch#(#InstantiationException#ie#)#{#throw#new#ZipException#(#ie#.#getMessage#(#)#)#;#}#catch#(#IllegalAccessException#iae#)#{#throw#new#ZipException#(#iae#.#getMessage#(#)#)#;#}#start#+=#(#length#+#WORD#)#;#}#ZipExtraField#[#]#result#=#new#ZipExtraField#[#v#.#size#(#)#]#;#return#(#ZipExtraField#[#]#)#v#.#toArray#(#result#)#;#}##byte#[#]#mergeLocalFileDataData#(#ZipExtraField#[#]#data#)#{#int#sum#=#WORD#*#data#.#length#;#for#(#int#i#=#0#;#i#<#data#.#length#;#i#++#)#{#sum#+=#data#[#i#]#.#getLocalFileDataLength#(#)#.#getValue#(#)#;#}#byte#[#]#result#=#new#byte#[#sum#]#;#int#start#=#0#;#for#(#int#i#=#0#;#i#<#data#.#length#;#i#++#)#{#System#.#arraycopy#(#data#[#i#]#.#getHeaderId#(#)#.#getBytes#(#)#,#0#,#result#,#start#,#2#)#;#System#.#arraycopy#(#data#[#i#]#.#getLocalFileDataLength#(#)#.#getBytes#(#)#,#0#,#result#,#start#+#2#,#2#)#;#byte#[#]#local#=#data#[#i#]#.#getLocalFileDataData#(#)#;#System#.#arraycopy#(#local#,#0#,#result#,#start#+#WORD#,#local#.#length#)#;#start#+=#(#local#.#length#+#WORD#)#;#}#return#result#;#}##byte#[#]#mergeCentralDirectoryData#(#ZipExtraField#[#]#data#)#{#int#sum#=#WORD#*#data#.#length#;#for#(#int#i#=#0#;#i#<#data#.#length#;#i#++#)#{#sum#+=#data#[#i#]#.#getCentralDirectoryLength#(#)#.#getValue#(#)#;#}#byte#[#]#result#=#new#byte#[#sum#]#;#int#start#=#0#;#for#(#int#i#=#0#;#i#<#data#.#length#;#i#++#)#{#System#.#arraycopy#(#data#[#i#]#.#getHeaderId#(#)#.#getBytes#(#)#,#0#,#result#,#start#,#2#)#;#System#.#arraycopy#(#data#[#i#]#.#getCentralDirectoryLength#(#)#.#getBytes#(#)#,#0#,#result#,#start#+#2#,#2#)#;#byte#[#]#local#=#data#[#i#]#.#getCentralDirectoryData#(#)#;#System#.#arraycopy#(#local#,#0#,#result#,#start#+#WORD#,#local#.#length#)#;#start#+=#(#local#.#length#+#WORD#)#;#}#return#result#;#}##