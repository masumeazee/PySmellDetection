String#getPackage#(#)#{#return#packageName#;#}##void#setPackage#(#String#package1#)#{#packageName#=#package1#;#}##void#addConfiguredIgnore#(#Ignore#ignore#)#{#ignoredPackaged#.#add#(#ignore#.#getPackage#(#)#)#;#}##File#getTo#(#)#{#return#to#;#}##void#setTo#(#File#to#)#{#this#.#to#=#to#;#}##String#getModule#(#)#{#return#module#;#}##void#setModule#(#String#module#)#{#this#.#module#=#module#;#}##String#getOrganisation#(#)#{#return#organisation#;#}##void#setOrganisation#(#String#organisation#)#{#this#.#organisation#=#organisation#;#}##String#getRevision#(#)#{#return#revision#;#}##void#setRevision#(#String#revision#)#{#this#.#revision#=#revision#;#}##String#getStatus#(#)#{#return#status#;#}##void#setStatus#(#String#status#)#{#this#.#status#=#status#;#}##void#addConfiguredMapping#(#PackageMapping#mapping#)#{#this#.#mapping#.#put#(#mapping#.#getPackage#(#)#,#mapping#.#getModuleRevisionId#(#)#)#;#}##void#addFileSet#(#FileSet#fileSet#)#{#concat#.#addFileset#(#fileSet#)#;#}##void#execute#(#)#throws#BuildException#{#configureConcat#(#)#;#Writer#out#=#new#StringWriter#(#)#;#concat#.#setWriter#(#out#)#;#concat#.#execute#(#)#;#Set#importsSet#=#new#HashSet#(#Arrays#.#asList#(#out#.#toString#(#)#.#split#(#"\n"#)#)#)#;#Set#dependencies#=#new#HashSet#(#)#;#for#(#Iterator#iter#=#importsSet#.#iterator#(#)#;#iter#.#hasNext#(#)#;#)#{#String#pack#=#(#(#String#)#iter#.#next#(#)#)#.#trim#(#)#;#ModuleRevisionId#mrid#=#getMapping#(#pack#)#;#if#(#mrid#!=#null#)#{#dependencies#.#add#(#mrid#)#;#}#}#try#{#PrintWriter#writer#=#new#PrintWriter#(#new#FileOutputStream#(#to#)#)#;#writer#.#println#(#"<ivy-module version=\"1.0\">"#)#;#writer#.#println#(#"\t<info organisation=\""#+#organisation#+#"\""#)#;#writer#.#println#(#"\t       module=\""#+#module#+#"\""#)#;#if#(#revision#!=#null#)#{#writer#.#println#(#"\t       revision=\""#+#revision#+#"\""#)#;#}#if#(#status#!=#null#)#{#writer#.#println#(#"\t       status=\""#+#status#+#"\""#)#;#}#else#{#writer#.#println#(#"\t       status=\"integration\""#)#;#}#writer#.#println#(#"\t/>"#)#;#if#(#!#dependencies#.#isEmpty#(#)#)#{#writer#.#println#(#"\t<dependencies>"#)#;#for#(#Iterator#iter#=#dependencies#.#iterator#(#)#;#iter#.#hasNext#(#)#;#)#{#ModuleRevisionId#mrid#=#(#ModuleRevisionId#)#iter#.#next#(#)#;#writer#.#println#(#"\t\t<dependency org=\""#+#mrid#.#getOrganisation#(#)#+#"\" name=\""#+#mrid#.#getName#(#)#+#"\" rev=\""#+#mrid#.#getRevision#(#)#+#"\"/>"#)#;#}#writer#.#println#(#"\t</dependencies>"#)#;#}#writer#.#println#(#"</ivy-module>"#)#;#writer#.#close#(#)#;#log#(#dependencies#.#size#(#)#+#" dependencies put in "#+#to#)#;#}#catch#(#FileNotFoundException#e#)#{#throw#new#BuildException#(#"impossible to create file "#+#to#+#": "#+#e#,#e#)#;#}#}##ModuleRevisionId#getMapping#(#String#pack#)#{#String#askedPack#=#pack#;#ModuleRevisionId#ret#=#null#;#while#(#ret#==#null#&&#pack#.#length#(#)#>#0#)#{#if#(#ignoredPackaged#.#contains#(#pack#)#)#{#return#null#;#}#ret#=#(#ModuleRevisionId#)#mapping#.#get#(#pack#)#;#int#lastDotIndex#=#pack#.#lastIndexOf#(#'.'#)#;#if#(#lastDotIndex#!=#-#1#)#{#pack#=#pack#.#substring#(#0#,#lastDotIndex#)#;#}#else#{#break#;#}#}#if#(#ret#==#null#)#{#log#(#"no mapping found for "#+#askedPack#,#Project#.#MSG_VERBOSE#)#;#}#return#ret#;#}##void#configureConcat#(#)#{#concat#.#setProject#(#getProject#(#)#)#;#concat#.#setTaskName#(#getTaskName#(#)#)#;#FilterChain#filterChain#=#new#FilterChain#(#)#;#LineContainsRegExp#lcre#=#new#LineContainsRegExp#(#)#;#RegularExpression#regexp#=#new#RegularExpression#(#)#;#regexp#.#setPattern#(#"^import .+;"#)#;#lcre#.#addConfiguredRegexp#(#regexp#)#;#filterChain#.#add#(#lcre#)#;#TokenFilter#tf#=#new#TokenFilter#(#)#;#TokenFilter#.#ReplaceRegex#rre#=#new#TokenFilter#.#ReplaceRegex#(#)#;#rre#.#setPattern#(#"import (.+);.*"#)#;#rre#.#setReplace#(#"\\1"#)#;#tf#.#add#(#rre#)#;#filterChain#.#add#(#tf#)#;#concat#.#addFilterChain#(#filterChain#)#;#}##