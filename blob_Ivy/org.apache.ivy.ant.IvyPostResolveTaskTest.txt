void#setUp#(#)#throws#Exception#{#Message#.#setDefaultLogger#(#new#DefaultMessageLogger#(#10#)#)#;#createCache#(#)#;#project#=#new#Project#(#)#;#project#.#setProperty#(#"ivy.settings.file"#,#"test/repositories/ivysettings.xml"#)#;#task#=#new#IvyPostResolveTask#(#)#{#public#void#doExecute#(#)#throws#BuildException#{#prepareAndCheck#(#)#;#}#}#;#task#.#setProject#(#project#)#;#System#.#setProperty#(#"ivy.cache.dir"#,#cache#.#getAbsolutePath#(#)#)#;#}##void#doExecute#(#)#throws#BuildException#{#prepareAndCheck#(#)#;#}##void#createCache#(#)#{#cache#=#new#File#(#"build/cache"#)#;#cache#.#mkdirs#(#)#;#}##void#tearDown#(#)#throws#Exception#{#CacheCleaner#.#deleteDir#(#cache#)#;#}##void#testWithPreviousResolveInSameBuildAndLessConfs#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-multiconf.xml"#)#)#;#resolve#.#setConf#(#"default,compile"#)#;#resolve#.#execute#(#)#;#ResolveReport#reportBefore#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#task#.#setConf#(#"default"#)#;#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#reportBefore#,#reportAfter#)#;#}##void#testWithPreviousResolveInSameBuildAndSameConfs#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-multiconf.xml"#)#)#;#resolve#.#setConf#(#"default"#)#;#resolve#.#execute#(#)#;#ResolveReport#reportBefore#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#task#.#setConf#(#"default"#)#;#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#reportBefore#,#reportAfter#)#;#}##void#testWithPreviousResolveInSameBuildAndWildcard#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-multiconf.xml"#)#)#;#resolve#.#setConf#(#"*"#)#;#resolve#.#execute#(#)#;#ResolveReport#reportBefore#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#task#.#setConf#(#"default"#)#;#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#reportBefore#,#reportAfter#)#;#}##void#testWithPreviousResolveInSameBuildAndBothWildcard#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-multiconf.xml"#)#)#;#resolve#.#setConf#(#"*"#)#;#resolve#.#execute#(#)#;#ResolveReport#reportBefore#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#task#.#setConf#(#"*"#)#;#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#reportBefore#,#reportAfter#)#;#}##void#testWithPreviousResolveInSameBuildAndMoreConfs#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-multiconf.xml"#)#)#;#resolve#.#setConf#(#"compile"#)#;#resolve#.#execute#(#)#;#ResolveReport#reportBefore#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#assertTrue#(#getArchiveFileInCache#(#"org1"#,#"mod1.1"#,#"2.0"#,#"mod1.1"#,#"jar"#,#"jar"#)#.#exists#(#)#)#;#assertFalse#(#getArchiveFileInCache#(#"org1"#,#"mod1.2"#,#"2.0"#,#"mod1.2"#,#"jar"#,#"jar"#)#.#exists#(#)#)#;#task#.#setConf#(#"*"#)#;#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#assertNotSame#(#"IvyPostResolveTask hasn't performed a resolve where it should have"#,#reportBefore#,#reportAfter#)#;#assertTrue#(#getArchiveFileInCache#(#"org1"#,#"mod1.2"#,#"2.0"#,#"mod1.2"#,#"jar"#,#"jar"#)#.#exists#(#)#)#;#}##void#testWithoutKeep#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-multiconf.xml"#)#)#;#resolve#.#setConf#(#"compile"#)#;#resolve#.#execute#(#)#;#ResolveReport#reportBefore#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#assertTrue#(#getArchiveFileInCache#(#"org1"#,#"mod1.1"#,#"2.0"#,#"mod1.1"#,#"jar"#,#"jar"#)#.#exists#(#)#)#;#assertFalse#(#getArchiveFileInCache#(#"org1"#,#"mod1.2"#,#"2.0"#,#"mod1.2"#,#"jar"#,#"jar"#)#.#exists#(#)#)#;#task#.#setConf#(#"*"#)#;#// will trigger a resolve#task#.#setKeep#(#false#)#;#// don't keep the resolve results#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#assertSame#(#"IvyPostResolveTask has kept the resolve report where it should have"#,#reportBefore#,#reportAfter#)#;#assertTrue#(#getArchiveFileInCache#(#"org1"#,#"mod1.2"#,#"2.0"#,#"mod1.2"#,#"jar"#,#"jar"#)#.#exists#(#)#)#;#}##void#testInlineWithoutKeep#(#)#throws#Exception#{#task#.#setOrganisation#(#"org1"#)#;#task#.#setModule#(#"mod1.1"#)#;#task#.#setRevision#(#"2.0"#)#;#task#.#setInline#(#true#)#;#task#.#setConf#(#"*"#)#;#// will trigger a resolve#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#assertNull#(#"IvyPostResolveTask has kept the resolve report where it should have"#,#reportAfter#)#;#assertTrue#(#getArchiveFileInCache#(#"org1"#,#"mod1.2"#,#"2.1"#,#"mod1.2"#,#"jar"#,#"jar"#)#.#exists#(#)#)#;#}##void#testInlineWithKeep#(#)#throws#Exception#{#task#.#setOrganisation#(#"org1"#)#;#task#.#setModule#(#"mod1.1"#)#;#task#.#setRevision#(#"2.0"#)#;#task#.#setInline#(#true#)#;#task#.#setKeep#(#true#)#;#task#.#setConf#(#"*"#)#;#// will trigger a resolve#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#assertNotNull#(#"IvyPostResolveTask has kept the resolve report where it should have"#,#reportAfter#)#;#assertTrue#(#getArchiveFileInCache#(#"org1"#,#"mod1.2"#,#"2.1"#,#"mod1.2"#,#"jar"#,#"jar"#)#.#exists#(#)#)#;#}##void#testWithResolveIdAndPreviousResolveInSameBuildAndLessConfs#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-multiconf.xml"#)#)#;#resolve#.#setConf#(#"default,compile"#)#;#resolve#.#setResolveId#(#"testResolveId"#)#;#resolve#.#execute#(#)#;#ResolveReport#report1#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report.testResolveId"#)#;#// perform another resolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-simple.xml"#)#)#;#resolve#.#setConf#(#"*"#)#;#resolve#.#execute#(#)#;#ResolveReport#reportBefore#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#task#.#setConf#(#"default"#)#;#task#.#setResolveId#(#"testResolveId"#)#;#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#ResolveReport#report2#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report.testResolveId"#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#reportBefore#,#reportAfter#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#report1#,#report2#)#;#}##void#testWithResolveIdAndPreviousResolveInSameBuildAndSameConfs#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-multiconf.xml"#)#)#;#resolve#.#setConf#(#"default"#)#;#resolve#.#setResolveId#(#"testResolveId"#)#;#resolve#.#execute#(#)#;#ResolveReport#report1#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report.testResolveId"#)#;#// perform another resolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-simple.xml"#)#)#;#resolve#.#setConf#(#"*"#)#;#resolve#.#execute#(#)#;#ResolveReport#reportBefore#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#task#.#setConf#(#"default"#)#;#task#.#setResolveId#(#"testResolveId"#)#;#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#ResolveReport#report2#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report.testResolveId"#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#reportBefore#,#reportAfter#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#report1#,#report2#)#;#}##void#testWithResolveIdAndPreviousResolveInSameBuildAndWildcard#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-multiconf.xml"#)#)#;#resolve#.#setConf#(#"*"#)#;#resolve#.#setResolveId#(#"testResolveId"#)#;#resolve#.#execute#(#)#;#ResolveReport#report1#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report.testResolveId"#)#;#// perform another resolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-simple.xml"#)#)#;#resolve#.#setConf#(#"*"#)#;#resolve#.#execute#(#)#;#ResolveReport#reportBefore#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#task#.#setConf#(#"default"#)#;#task#.#setResolveId#(#"testResolveId"#)#;#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#ResolveReport#report2#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report.testResolveId"#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#reportBefore#,#reportAfter#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#report1#,#report2#)#;#}##void#testWithResolveIdAndPreviousResolveInSameBuildAndBothWildcard#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-multiconf.xml"#)#)#;#resolve#.#setConf#(#"*"#)#;#resolve#.#setResolveId#(#"testResolveId"#)#;#resolve#.#execute#(#)#;#ResolveReport#report1#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report.testResolveId"#)#;#// perform another resolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-simple.xml"#)#)#;#resolve#.#setConf#(#"*"#)#;#resolve#.#execute#(#)#;#ResolveReport#reportBefore#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#task#.#setConf#(#"*"#)#;#task#.#setResolveId#(#"testResolveId"#)#;#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#ResolveReport#report2#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report.testResolveId"#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#reportBefore#,#reportAfter#)#;#assertSame#(#"IvyPostResolveTask has performed a resolve where it shouldn't"#,#report1#,#report2#)#;#}##void#testWithResolveIdAndPreviousResolveInSameBuildAndMoreConfs#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-multiconf.xml"#)#)#;#resolve#.#setConf#(#"compile"#)#;#resolve#.#setResolveId#(#"testResolveId"#)#;#resolve#.#execute#(#)#;#ResolveReport#report1#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report.testResolveId"#)#;#assertTrue#(#getArchiveFileInCache#(#"org1"#,#"mod1.1"#,#"2.0"#,#"mod1.1"#,#"jar"#,#"jar"#)#.#exists#(#)#)#;#assertFalse#(#getArchiveFileInCache#(#"org1"#,#"mod1.2"#,#"2.0"#,#"mod1.2"#,#"jar"#,#"jar"#)#.#exists#(#)#)#;#// perform another resolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-simple.xml"#)#)#;#resolve#.#setConf#(#"*"#)#;#resolve#.#execute#(#)#;#ResolveReport#reportBefore#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#task#.#setConf#(#"*"#)#;#task#.#setResolveId#(#"testResolveId"#)#;#task#.#execute#(#)#;#ResolveReport#reportAfter#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report"#)#;#ResolveReport#report2#=#(#ResolveReport#)#project#.#getReference#(#"ivy.resolved.report.testResolveId"#)#;#assertNotSame#(#"IvyPostResolveTask hasn't performed a resolve where it should have"#,#reportBefore#,#reportAfter#)#;#assertNotSame#(#"IvyPostResolveTask hasn't performed a resolve where it should have"#,#report1#,#report2#)#;#assertTrue#(#getArchiveFileInCache#(#"org1"#,#"mod1.2"#,#"2.0"#,#"mod1.2"#,#"jar"#,#"jar"#)#.#exists#(#)#)#;#}##File#getArchiveFileInCache#(#String#organisation#,#String#module#,#String#revision#,#String#artifact#,#String#type#,#String#ext#)#{#return#TestHelper#.#getArchiveFileInCache#(#task#.#getIvyInstance#(#)#,#organisation#,#module#,#revision#,#artifact#,#type#,#ext#)#;#}##