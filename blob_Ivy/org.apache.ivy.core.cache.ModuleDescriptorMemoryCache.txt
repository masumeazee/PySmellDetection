ModuleDescriptor#get#(#File#ivyFile#,#ParserSettings#ivySettings#,#boolean#validated#,#ModuleDescriptorProvider#mdProvider#)#throws#ParseException#,#IOException#{#ModuleDescriptor#descriptor#=#getFromCache#(#ivyFile#,#ivySettings#,#validated#)#;#if#(#descriptor#==#null#)#{#descriptor#=#getStale#(#ivyFile#,#ivySettings#,#validated#,#mdProvider#)#;#}#return#descriptor#;#}##ModuleDescriptor#getStale#(#File#ivyFile#,#ParserSettings#ivySettings#,#boolean#validated#,#ModuleDescriptorProvider#mdProvider#)#throws#ParseException#,#IOException#{#ParserSettingsMonitor#settingsMonitor#=#new#ParserSettingsMonitor#(#ivySettings#)#;#ModuleDescriptor#descriptor#=#mdProvider#.#provideModule#(#settingsMonitor#.#getMonitoredSettings#(#)#,#ivyFile#,#validated#)#;#putInCache#(#ivyFile#,#settingsMonitor#,#validated#,#descriptor#)#;#return#descriptor#;#}##ModuleDescriptor#getFromCache#(#File#ivyFile#,#ParserSettings#ivySettings#,#boolean#validated#)#{#if#(#maxSize#<=#0#)#{#//cache is disbaled#return#null#;#}#CacheEntry#entry#=#(#CacheEntry#)#valueMap#.#get#(#ivyFile#)#;#if#(#entry#!=#null#)#{#if#(#entry#.#isStale#(#validated#,#ivySettings#)#)#{#Message#.#debug#(#"Entry is found in the ModuleDescriptorCache but entry should be "#+#"reevaluated : "#+#ivyFile#)#;#valueMap#.#remove#(#ivyFile#)#;#return#null#;#}#else#{#//Move the entry at the end of the list#valueMap#.#remove#(#ivyFile#)#;#valueMap#.#put#(#ivyFile#,#entry#)#;#Message#.#debug#(#"Entry is found in the ModuleDescriptorCache : "#+#ivyFile#)#;#return#entry#.#md#;#}#}#else#{#Message#.#debug#(#"No entry is found in the ModuleDescriptorCache : "#+#ivyFile#)#;#return#null#;#}#}##void#putInCache#(#File#url#,#ParserSettingsMonitor#ivySettingsMonitor#,#boolean#validated#,#ModuleDescriptor#descriptor#)#{#if#(#maxSize#<=#0#)#{#//cache is disabled#return#;#}#if#(#valueMap#.#size#(#)#>=#maxSize#)#{#Message#.#debug#(#"ModuleDescriptorCache is full, remove one entry"#)#;#Iterator#it#=#valueMap#.#values#(#)#.#iterator#(#)#;#it#.#next#(#)#;#it#.#remove#(#)#;#}#valueMap#.#put#(#url#,#new#CacheEntry#(#descriptor#,#validated#,#ivySettingsMonitor#)#)#;#}##boolean#isStale#(#boolean#validated#,#ParserSettings#newParserSettings#)#{#return#(#validated#&&#!#this#.#validated#)#||#parserSettingsMonitor#.#hasChanged#(#newParserSettings#)#;#}##