ModuleDescriptor#parseDescriptor#(#ParserSettings#ivySettings#,#URL#descriptorURL#,#boolean#validate#)#throws#ParseException#,#IOException#{#return#parseDescriptor#(#ivySettings#,#descriptorURL#,#new#URLResource#(#descriptorURL#)#,#validate#)#;#}##String#getType#(#)#{#return#"ivy"#;#}##Artifact#getMetadataArtifact#(#ModuleRevisionId#mrid#,#Resource#res#)#{#return#DefaultArtifact#.#newIvyArtifact#(#mrid#,#new#Date#(#res#.#getLastModified#(#)#)#)#;#}##ModuleDescriptorParser#getModuleDescriptorParser#(#)#{#return#parser#;#}##void#checkErrors#(#)#throws#ParseException#{#if#(#!#errors#.#isEmpty#(#)#)#{#throw#new#ParseException#(#errors#.#toString#(#)#,#0#)#;#}#}##void#setResource#(#Resource#res#)#{#this#.#res#=#res#;#// used for log and date only#md#=#new#DefaultModuleDescriptor#(#parser#,#res#)#;#md#.#setLastModified#(#ResourceHelper#.#getLastModifiedOrDefault#(#res#)#)#;#}##Resource#getResource#(#)#{#return#res#;#}##String#getDefaultConfMapping#(#)#{#return#defaultConfMapping#;#}##void#setDefaultConfMapping#(#String#defaultConf#)#{#defaultConfMapping#=#defaultConf#;#}##void#parseDepsConfs#(#String#confs#,#DefaultDependencyDescriptor#dd#)#{#parseDepsConfs#(#confs#,#dd#,#defaultConfMapping#!=#null#)#;#}##void#parseDepsConfs#(#String#confs#,#DefaultDependencyDescriptor#dd#,#boolean#useDefaultMappingToGuessRightOperande#)#{#parseDepsConfs#(#confs#,#dd#,#useDefaultMappingToGuessRightOperande#,#true#)#;#}##void#parseDepsConfs#(#String#confs#,#DefaultDependencyDescriptor#dd#,#boolean#useDefaultMappingToGuessRightOperande#,#boolean#evaluateConditions#)#{#if#(#confs#==#null#)#{#return#;#}#String#[#]#conf#=#confs#.#split#(#";"#)#;#parseDepsConfs#(#conf#,#dd#,#useDefaultMappingToGuessRightOperande#,#evaluateConditions#)#;#}##void#parseDepsConfs#(#String#[#]#conf#,#DefaultDependencyDescriptor#dd#,#boolean#useDefaultMappingToGuessRightOperande#)#{#parseDepsConfs#(#conf#,#dd#,#useDefaultMappingToGuessRightOperande#,#true#)#;#}##void#parseDepsConfs#(#String#[#]#conf#,#DefaultDependencyDescriptor#dd#,#boolean#useDefaultMappingToGuessRightOperande#,#boolean#evaluateConditions#)#{#replaceConfigurationWildcards#(#md#)#;#for#(#int#i#=#0#;#i#<#conf#.#length#;#i#++#)#{#String#[#]#ops#=#conf#[#i#]#.#split#(#"->"#)#;#if#(#ops#.#length#==#1#)#{#String#[#]#modConfs#=#ops#[#0#]#.#split#(#","#)#;#if#(#!#useDefaultMappingToGuessRightOperande#)#{#for#(#int#j#=#0#;#j#<#modConfs#.#length#;#j#++#)#{#dd#.#addDependencyConfiguration#(#modConfs#[#j#]#.#trim#(#)#,#modConfs#[#j#]#.#trim#(#)#)#;#}#}#else#{#for#(#int#j#=#0#;#j#<#modConfs#.#length#;#j#++#)#{#String#[#]#depConfs#=#getDefaultConfMappingDescriptor#(#)#.#getDependencyConfigurations#(#modConfs#[#j#]#)#;#if#(#depConfs#.#length#>#0#)#{#for#(#int#k#=#0#;#k#<#depConfs#.#length#;#k#++#)#{#String#mappedDependency#=#evaluateConditions#?#evaluateCondition#(#depConfs#[#k#]#.#trim#(#)#,#dd#)#:#depConfs#[#k#]#.#trim#(#)#;#if#(#mappedDependency#!=#null#)#{#dd#.#addDependencyConfiguration#(#modConfs#[#j#]#.#trim#(#)#,#mappedDependency#)#;#}#}#}#else#{#// no default mapping found for this configuration, map#// configuration to itself#dd#.#addDependencyConfiguration#(#modConfs#[#j#]#.#trim#(#)#,#modConfs#[#j#]#.#trim#(#)#)#;#}#}#}#}#else#if#(#ops#.#length#==#2#)#{#String#[#]#modConfs#=#ops#[#0#]#.#split#(#","#)#;#String#[#]#depConfs#=#ops#[#1#]#.#split#(#","#)#;#for#(#int#j#=#0#;#j#<#modConfs#.#length#;#j#++#)#{#for#(#int#k#=#0#;#k#<#depConfs#.#length#;#k#++#)#{#String#mappedDependency#=#evaluateConditions#?#evaluateCondition#(#depConfs#[#k#]#.#trim#(#)#,#dd#)#:#depConfs#[#k#]#.#trim#(#)#;#if#(#mappedDependency#!=#null#)#{#dd#.#addDependencyConfiguration#(#modConfs#[#j#]#.#trim#(#)#,#mappedDependency#)#;#}#}#}#}#else#{#addError#(#"invalid conf "#+#conf#[#i#]#+#" for "#+#dd#)#;#}#}#if#(#md#.#isMappingOverride#(#)#)#{#addExtendingConfigurations#(#conf#,#dd#,#useDefaultMappingToGuessRightOperande#)#;#}#}##String#evaluateCondition#(#String#conf#,#DefaultDependencyDescriptor#dd#)#{#if#(#conf#.#charAt#(#0#)#!=#'['#)#{#return#conf#;#}#int#endConditionIndex#=#conf#.#indexOf#(#']'#)#;#if#(#endConditionIndex#==#-#1#)#{#addError#(#"invalid conf "#+#conf#+#" for "#+#dd#)#;#return#null#;#}#String#condition#=#conf#.#substring#(#1#,#endConditionIndex#)#;#int#notEqualIndex#=#condition#.#indexOf#(#"!="#)#;#if#(#notEqualIndex#==#-#1#)#{#int#equalIndex#=#condition#.#indexOf#(#'='#)#;#if#(#equalIndex#==#-#1#)#{#addError#(#"invalid conf "#+#conf#+#" for "#+#dd#.#getDependencyRevisionId#(#)#)#;#return#null#;#}#String#leftOp#=#condition#.#substring#(#0#,#equalIndex#)#.#trim#(#)#;#String#rightOp#=#condition#.#substring#(#equalIndex#+#1#)#.#trim#(#)#;#// allow organisation synonyms, like 'org' or 'organization'#if#(#leftOp#.#equals#(#"org"#)#||#leftOp#.#equals#(#"organization"#)#)#{#leftOp#=#"organisation"#;#}#String#attrValue#=#dd#.#getAttribute#(#leftOp#)#;#if#(#!#rightOp#.#equals#(#attrValue#)#)#{#return#null#;#}#}#else#{#String#leftOp#=#condition#.#substring#(#0#,#notEqualIndex#)#.#trim#(#)#;#String#rightOp#=#condition#.#substring#(#notEqualIndex#+#2#)#.#trim#(#)#;#// allow organisation synonyms, like 'org' or 'organization'#if#(#leftOp#.#equals#(#"org"#)#||#leftOp#.#equals#(#"organization"#)#)#{#leftOp#=#"organisation"#;#}#String#attrValue#=#dd#.#getAttribute#(#leftOp#)#;#if#(#rightOp#.#equals#(#attrValue#)#)#{#return#null#;#}#}#return#conf#.#substring#(#endConditionIndex#+#1#)#;#}##void#addExtendingConfigurations#(#String#[#]#confs#,#DefaultDependencyDescriptor#dd#,#boolean#useDefaultMappingToGuessRightOperande#)#{#for#(#int#i#=#0#;#i#<#confs#.#length#;#i#++#)#{#addExtendingConfigurations#(#confs#[#i#]#,#dd#,#useDefaultMappingToGuessRightOperande#)#;#}#}##void#addExtendingConfigurations#(#String#conf#,#DefaultDependencyDescriptor#dd#,#boolean#useDefaultMappingToGuessRightOperande#)#{#Set#configsToAdd#=#new#HashSet#(#)#;#Configuration#[#]#configs#=#md#.#getConfigurations#(#)#;#for#(#int#i#=#0#;#i#<#configs#.#length#;#i#++#)#{#String#[#]#ext#=#configs#[#i#]#.#getExtends#(#)#;#for#(#int#j#=#0#;#j#<#ext#.#length#;#j#++#)#{#if#(#conf#.#equals#(#ext#[#j#]#)#)#{#String#configName#=#configs#[#i#]#.#getName#(#)#;#configsToAdd#.#add#(#configName#)#;#addExtendingConfigurations#(#configName#,#dd#,#useDefaultMappingToGuessRightOperande#)#;#}#}#}#String#[#]#confs#=#(#String#[#]#)#configsToAdd#.#toArray#(#new#String#[#configsToAdd#.#size#(#)#]#)#;#parseDepsConfs#(#confs#,#dd#,#useDefaultMappingToGuessRightOperande#)#;#}##DependencyDescriptor#getDefaultConfMappingDescriptor#(#)#{#if#(#defaultConfMappingDescriptor#==#null#)#{#defaultConfMappingDescriptor#=#new#DefaultDependencyDescriptor#(#ModuleRevisionId#.#newInstance#(#""#,#""#,#""#)#,#false#)#;#parseDepsConfs#(#defaultConfMapping#,#defaultConfMappingDescriptor#,#false#,#false#)#;#}#return#defaultConfMappingDescriptor#;#}##void#addError#(#String#msg#)#{#if#(#res#!=#null#)#{#errors#.#add#(#msg#+#" in "#+#res#+#"\n"#)#;#}#else#{#errors#.#add#(#msg#+#"\n"#)#;#}#}##void#warning#(#SAXParseException#ex#)#{#Message#.#warn#(#"xml parsing: "#+#getLocationString#(#ex#)#+#": "#+#ex#.#getMessage#(#)#)#;#}##void#error#(#SAXParseException#ex#)#{#addError#(#"xml parsing: "#+#getLocationString#(#ex#)#+#": "#+#ex#.#getMessage#(#)#)#;#}##void#fatalError#(#SAXParseException#ex#)#throws#SAXException#{#addError#(#"[Fatal Error] "#+#getLocationString#(#ex#)#+#": "#+#ex#.#getMessage#(#)#)#;#}##String#getLocationString#(#SAXParseException#ex#)#{#StringBuffer#str#=#new#StringBuffer#(#)#;#String#systemId#=#ex#.#getSystemId#(#)#;#if#(#systemId#!=#null#)#{#int#index#=#systemId#.#lastIndexOf#(#'/'#)#;#if#(#index#!=#-#1#)#{#systemId#=#systemId#.#substring#(#index#+#1#)#;#}#str#.#append#(#systemId#)#;#}#else#if#(#getResource#(#)#!=#null#)#{#str#.#append#(#getResource#(#)#.#toString#(#)#)#;#}#str#.#append#(#':'#)#;#str#.#append#(#ex#.#getLineNumber#(#)#)#;#str#.#append#(#':'#)#;#str#.#append#(#ex#.#getColumnNumber#(#)#)#;#return#str#.#toString#(#)#;#}##String#getDefaultConf#(#)#{#return#defaultConfMapping#!=#null#?#defaultConfMapping#:#(#defaultConf#!=#null#?#defaultConf#:#DEFAULT_CONF_MAPPING#)#;#}##void#setDefaultConf#(#String#defaultConf#)#{#this#.#defaultConf#=#defaultConf#;#}##ModuleDescriptor#getModuleDescriptor#(#)#throws#ParseException#{#checkErrors#(#)#;#return#md#;#}##Date#getDefaultPubDate#(#)#{#return#new#Date#(#md#.#getLastModified#(#)#)#;#}##void#replaceConfigurationWildcards#(#ModuleDescriptor#md#)#{#Configuration#[#]#configs#=#md#.#getConfigurations#(#)#;#for#(#int#i#=#0#;#i#<#configs#.#length#;#i#++#)#{#configs#[#i#]#.#replaceWildcards#(#md#)#;#}#}##void#setMd#(#DefaultModuleDescriptor#md#)#{#this#.#md#=#md#;#}##DefaultModuleDescriptor#getMd#(#)#{#return#md#;#}##