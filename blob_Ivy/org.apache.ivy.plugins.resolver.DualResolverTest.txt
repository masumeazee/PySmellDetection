void#setUp#(#)#throws#Exception#{#_settings#=#new#IvySettings#(#)#;#_engine#=#new#ResolveEngine#(#_settings#,#new#EventManager#(#)#,#new#SortEngine#(#_settings#)#)#;#_cache#=#new#File#(#"build/cache"#)#;#_data#=#new#ResolveData#(#_engine#,#new#ResolveOptions#(#)#)#;#_cache#.#mkdirs#(#)#;#_settings#.#setDefaultCache#(#_cache#)#;#}##void#testFromConf#(#)#throws#Exception#{#new#XmlSettingsParser#(#_settings#)#.#parse#(#DualResolverTest#.#class#.#getResource#(#"dualresolverconf.xml"#)#)#;#DependencyResolver#resolver#=#_settings#.#getResolver#(#"dualok"#)#;#assertNotNull#(#resolver#)#;#assertTrue#(#resolver#instanceof#DualResolver#)#;#DualResolver#dual#=#(#DualResolver#)#resolver#;#assertNotNull#(#dual#.#getIvyResolver#(#)#)#;#assertEquals#(#"ivy"#,#dual#.#getIvyResolver#(#)#.#getName#(#)#)#;#assertNotNull#(#dual#.#getArtifactResolver#(#)#)#;#assertEquals#(#"artifact"#,#dual#.#getArtifactResolver#(#)#.#getName#(#)#)#;#resolver#=#_settings#.#getResolver#(#"dualnotenough"#)#;#assertNotNull#(#resolver#)#;#assertTrue#(#resolver#instanceof#DualResolver#)#;#dual#=#(#DualResolver#)#resolver#;#assertNotNull#(#dual#.#getIvyResolver#(#)#)#;#assertNull#(#dual#.#getArtifactResolver#(#)#)#;#}##void#testFromBadConf#(#)#throws#Exception#{#try#{#new#XmlSettingsParser#(#_settings#)#.#parse#(#DualResolverTest#.#class#.#getResource#(#"dualresolverconf-bad.xml"#)#)#;#fail#(#"bad dual resolver configuration should raise exception"#)#;#}#catch#(#Exception#ex#)#{#// ok -> bad conf has raised an exception#}#}##void#testBad#(#)#throws#Exception#{#DualResolver#dual#=#new#DualResolver#(#)#;#dual#.#setIvyResolver#(#new#IBiblioResolver#(#)#)#;#DefaultDependencyDescriptor#dd#=#new#DefaultDependencyDescriptor#(#ModuleRevisionId#.#newInstance#(#"org"#,#"mod"#,#"rev"#)#,#false#)#;#try#{#dual#.#getDependency#(#dd#,#_data#)#;#fail#(#"bad dual resolver configuration should raise exception"#)#;#}#catch#(#Exception#ex#)#{#// ok -> should have raised an exception#}#}##void#testResolve#(#)#throws#Exception#{#DualResolver#dual#=#new#DualResolver#(#)#;#MockResolver#ivyResolver#=#MockResolver#.#buildMockResolver#(#_settings#,#"ivy"#,#true#,#new#GregorianCalendar#(#2005#,#1#,#20#)#.#getTime#(#)#)#;#MockResolver#artifactResolver#=#MockResolver#.#buildMockResolver#(#_settings#,#"artifact"#,#false#,#new#GregorianCalendar#(#2005#,#1#,#20#)#.#getTime#(#)#)#;#dual#.#setIvyResolver#(#ivyResolver#)#;#dual#.#setArtifactResolver#(#artifactResolver#)#;#DefaultDependencyDescriptor#dd#=#new#DefaultDependencyDescriptor#(#ModuleRevisionId#.#newInstance#(#"org"#,#"mod"#,#"rev"#)#,#false#)#;#ResolvedModuleRevision#rmr#=#dual#.#getDependency#(#dd#,#_data#)#;#assertNotNull#(#rmr#)#;#assertEquals#(#dual#,#rmr#.#getArtifactResolver#(#)#)#;#assertEquals#(#Arrays#.#asList#(#new#DependencyDescriptor#[#]#{#dd#}#)#,#ivyResolver#.#askedDeps#)#;#assertTrue#(#artifactResolver#.#askedDeps#.#isEmpty#(#)#)#;#}##void#testResolveFromArtifact#(#)#throws#Exception#{#DualResolver#dual#=#new#DualResolver#(#)#;#MockResolver#ivyResolver#=#MockResolver#.#buildMockResolver#(#_settings#,#"ivy"#,#false#,#new#GregorianCalendar#(#2005#,#1#,#20#)#.#getTime#(#)#)#;#MockResolver#artifactResolver#=#MockResolver#.#buildMockResolver#(#_settings#,#"artifact"#,#true#,#new#GregorianCalendar#(#2005#,#1#,#20#)#.#getTime#(#)#)#;#dual#.#setIvyResolver#(#ivyResolver#)#;#dual#.#setArtifactResolver#(#artifactResolver#)#;#DefaultDependencyDescriptor#dd#=#new#DefaultDependencyDescriptor#(#ModuleRevisionId#.#newInstance#(#"org"#,#"mod"#,#"rev"#)#,#false#)#;#ResolvedModuleRevision#rmr#=#dual#.#getDependency#(#dd#,#_data#)#;#assertNotNull#(#rmr#)#;#assertEquals#(#artifactResolver#,#rmr#.#getResolver#(#)#)#;#assertEquals#(#Arrays#.#asList#(#new#DependencyDescriptor#[#]#{#dd#}#)#,#ivyResolver#.#askedDeps#)#;#assertEquals#(#Arrays#.#asList#(#new#DependencyDescriptor#[#]#{#dd#}#)#,#artifactResolver#.#askedDeps#)#;#}##void#testResolveFail#(#)#throws#Exception#{#DualResolver#dual#=#new#DualResolver#(#)#;#MockResolver#ivyResolver#=#MockResolver#.#buildMockResolver#(#_settings#,#"ivy"#,#false#,#new#GregorianCalendar#(#2005#,#1#,#20#)#.#getTime#(#)#)#;#MockResolver#artifactResolver#=#MockResolver#.#buildMockResolver#(#_settings#,#"artifact"#,#false#,#new#GregorianCalendar#(#2005#,#1#,#20#)#.#getTime#(#)#)#;#dual#.#setIvyResolver#(#ivyResolver#)#;#dual#.#setArtifactResolver#(#artifactResolver#)#;#DefaultDependencyDescriptor#dd#=#new#DefaultDependencyDescriptor#(#ModuleRevisionId#.#newInstance#(#"org"#,#"mod"#,#"rev"#)#,#false#)#;#ResolvedModuleRevision#rmr#=#dual#.#getDependency#(#dd#,#_data#)#;#assertNull#(#rmr#)#;#assertEquals#(#Arrays#.#asList#(#new#DependencyDescriptor#[#]#{#dd#}#)#,#ivyResolver#.#askedDeps#)#;#assertEquals#(#Arrays#.#asList#(#new#DependencyDescriptor#[#]#{#dd#}#)#,#artifactResolver#.#askedDeps#)#;#}##