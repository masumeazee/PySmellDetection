boolean#isSelected#(#File#basedir#,#String#filename#,#File#file#)#{##// throw BuildException on error#validate#(#)#;#int#depth#=#-#1#;##// If you felt daring, you could cache the basedir absolute path#String#absBase#=#basedir#.#getAbsolutePath#(#)#;#String#absFile#=#file#.#getAbsolutePath#(#)#;#StringTokenizer#tokBase#=#new#StringTokenizer#(#absBase#,#File#.#separator#)#;#StringTokenizer#tokFile#=#new#StringTokenizer#(#absFile#,#File#.#separator#)#;##while#(#tokFile#.#hasMoreTokens#(#)#)#{#String#filetoken#=#tokFile#.#nextToken#(#)#;##if#(#tokBase#.#hasMoreTokens#(#)#)#{#String#basetoken#=#tokBase#.#nextToken#(#)#;##// Sanity check. Ditch it if you want faster performance##if#(#!#basetoken#.#equals#(#filetoken#)#)#{#throw#new#BuildException#(#"File "#+#filename#+#" does not appear within "#+#absBase#+#"directory"#)#;#}#}#else#{#depth#+=#1#;##if#(#max#>#-#1#&&#depth#>#max#)#{##return#false#;#}#}#}##if#(#tokBase#.#hasMoreTokens#(#)#)#{#throw#new#BuildException#(#"File "#+#filename#+#" is outside of "#+#absBase#+#"directory tree"#)#;#}##if#(#min#>#-#1#&&#depth#<#min#)#{##return#false#;#}##return#true#;#}