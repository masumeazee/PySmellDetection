void#saveProperties#(#Hashtable#allProps#,#OutputStream#os#)#throws#IOException#,#BuildException#{#final#List#keyList#=#new#ArrayList#(#allProps#.#keySet#(#)#)#;#Collections#.#sort#(#keyList#)#;#Properties#props#=#new#Properties#(#)#{#private#static#final#long#serialVersionUID#=#5090936442309201654L#;#public#Enumeration#keys#(#)#{##return#CollectionUtils#.#asEnumeration#(#keyList#.#iterator#(#)#)#;#}##public#Set#entrySet#(#)#{#Set#result#=#super#.#entrySet#(#)#;##if#(#JavaEnvUtils#.#isKaffe#(#)#)#{#TreeSet#t#=#new#TreeSet#(#new#Comparator#(#)#{#public#int#compare#(#Object#o1#,#Object#o2#)#{#String#key1#=#(#String#)#(#(#Map#.#Entry#)#o1#)#.#getKey#(#)#;#String#key2#=#(#String#)#(#(#Map#.#Entry#)#o2#)#.#getKey#(#)#;##return#key1#.#compareTo#(#key2#)#;#}#}#)#;#t#.#addAll#(#result#)#;#result#=#t#;#}##return#result#;#}#}#;##for#(#int#i#=#0#;##i#<#keyList#.#size#(#)#;#i#++#)#{#String#name#=#keyList#.#get#(#i#)#.#toString#(#)#;#String#value#=#allProps#.#get#(#name#)#.#toString#(#)#;#props#.#setProperty#(#name#,#value#)#;#}##if#(#"text"#.#equals#(#format#)#)#{#jdkSaveProperties#(#props#,#os#,#"Ant properties"#)#;#}#else##if#(#"xml"#.#equals#(#format#)#)#{#xmlSaveProperties#(#props#,#os#)#;#}#}