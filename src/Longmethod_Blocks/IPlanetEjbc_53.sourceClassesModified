long#sourceClassesModified#(#File#buildDir#)#{#long#latestModified#;##// The timestamp of the "newest" class#long#modified#;##// Timestamp for a given class#File#remoteFile#;##// File for the remote interface class#File#homeFile#;##// File for the home interface class#File#implFile#;##// File for the EJB implementation class#File#pkFile#;##// File for the EJB primary key class##/* Check the timestamp on the remote interface */#remoteFile#=#remote#.#getClassFile#(#buildDir#)#;#modified#=#remoteFile#.#lastModified#(#)#;##if#(#modified#==#-#1#)#{#System#.#out#.#println#(#"The class "#+#remote#.#getQualifiedClassName#(#)#+#" couldn't "#+#"be found on the classpath"#)#;##return#-#1#;#}##latestModified#=#modified#;##/* Check the timestamp on the home interface */#homeFile#=#home#.#getClassFile#(#buildDir#)#;#modified#=#homeFile#.#lastModified#(#)#;##if#(#modified#==#-#1#)#{#System#.#out#.#println#(#"The class "#+#home#.#getQualifiedClassName#(#)#+#" couldn't be "#+#"found on the classpath"#)#;##return#-#1#;#}##latestModified#=#Math#.#max#(#latestModified#,#modified#)#;##/* Check the timestamp of the primary key class */##if#(#primaryKey#!=#null#)#{#pkFile#=#primaryKey#.#getClassFile#(#buildDir#)#;#modified#=#pkFile#.#lastModified#(#)#;##if#(#modified#==#-#1#)#{#System#.#out#.#println#(#"The class "#+#primaryKey#.#getQualifiedClassName#(#)#+#"couldn't be "#+#"found on the classpath"#)#;##return#-#1#;#}##latestModified#=#Math#.#max#(#latestModified#,#modified#)#;#}#else#{#pkFile#=#null#;#}##/* Check the timestamp on the EJB implementation class.
             *
             * Note that if ONLY the implementation class has changed, it's not
             * necessary to rebuild the EJB stubs and skeletons.  For this
             * reason, we ensure the file exists (using lastModified above), but
             * we DON'T compare it's timestamp with the timestamps of the home
             * and remote interfaces (because it's irrelevant in determining if
             * ejbc must be run)
             */#implFile#=#implementation#.#getClassFile#(#buildDir#)#;#modified#=#implFile#.#lastModified#(#)#;##if#(#modified#==#-#1#)#{#System#.#out#.#println#(#"The class "#+#implementation#.#getQualifiedClassName#(#)#+#" couldn't be found on the classpath"#)#;##return#-#1#;#}##String#pathToFile#=#remote#.#getQualifiedClassName#(#)#;#pathToFile#=#pathToFile#.#replace#(#'.'#,#File#.#separatorChar#)#+#".class"#;#ejbFiles#.#put#(#pathToFile#,#remoteFile#)#;#pathToFile#=#home#.#getQualifiedClassName#(#)#;#pathToFile#=#pathToFile#.#replace#(#'.'#,#File#.#separatorChar#)#+#".class"#;#ejbFiles#.#put#(#pathToFile#,#homeFile#)#;#pathToFile#=#implementation#.#getQualifiedClassName#(#)#;#pathToFile#=#pathToFile#.#replace#(#'.'#,#File#.#separatorChar#)#+#".class"#;#ejbFiles#.#put#(#pathToFile#,#implFile#)#;##if#(#pkFile#!=#null#)#{#pathToFile#=#primaryKey#.#getQualifiedClassName#(#)#;#pathToFile#=#pathToFile#.#replace#(#'.'#,#File#.#separatorChar#)#+#".class"#;#ejbFiles#.#put#(#pathToFile#,#pkFile#)#;#}##return#latestModified#;#}