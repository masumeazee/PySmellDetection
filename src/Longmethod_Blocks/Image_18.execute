void#execute#(#)#throws#BuildException#{#validateAttributes#(#)#;##try#{#File#dest#=#destDir#!=#null#?#destDir#:#srcDir#;#int#writeCount#=#0#;##// build mapper#final#FileNameMapper#mapper#;##if#(#mapperElement#==#null#)#{#mapper#=#new#IdentityMapper#(#)#;#}#else#{#mapper#=#mapperElement#.#getImplementation#(#)#;#}##// deal with specified srcDir##if#(#srcDir#!=#null#)#{#final#DirectoryScanner#ds#=#super#.#getDirectoryScanner#(#srcDir#)#;#final#String#[#]#files#=#ds#.#getIncludedFiles#(#)#;#writeCount#+=#processDir#(#srcDir#,#files#,#dest#,#mapper#)#;#}##// deal with the filesets#for#(#int#i#=#0#;##i#<#filesets#.#size#(#)#;#i#++#)#{#final#FileSet#fs#=#(#FileSet#)#filesets#.#elementAt#(#i#)#;#final#DirectoryScanner#ds#=#fs#.#getDirectoryScanner#(#getProject#(#)#)#;#final#String#[#]#files#=#ds#.#getIncludedFiles#(#)#;#final#File#fromDir#=#fs#.#getDir#(#getProject#(#)#)#;#writeCount#+=#processDir#(#fromDir#,#files#,#dest#,#mapper#)#;#}##if#(#writeCount#>#0#)#{#log#(#"Processed "#+#writeCount#+#(#writeCount#==#1#?#" image."#:#" images."#)#)#;#}#}##catch#(#Exception#err#)#{#err#.#printStackTrace#(#)#;#throw#new#BuildException#(#err#.#getMessage#(#)#)#;#}#}