String#encodeURI#(#String#path#)#throws#UnsupportedEncodingException#{#int#i#=#0#;#int#len#=#path#.#length#(#)#;#int#ch#=#0#;#StringBuffer#sb#=#null#;##for#(#;##i#<#len#;#i#++#)#{#ch#=#path#.#charAt#(#i#)#;##// if it's not an ASCII character, break here, and use UTF-8 encoding##if#(#ch#>=#ASCII_SIZE#)#{#break#;#}##if#(#gNeedEscaping#[#ch#]#)#{##if#(#sb#==#null#)#{#sb#=#new#StringBuffer#(#path#.#substring#(#0#,#i#)#)#;#}##sb#.#append#(#'%'#)#;#sb#.#append#(#gAfterEscaping1#[#ch#]#)#;#sb#.#append#(#gAfterEscaping2#[#ch#]#)#;##// record the fact that it's escaped#}#else##if#(#sb#!=#null#)#{#sb#.#append#(#(#char#)#ch#)#;#}#}##// we saw some non-ascii character##if#(#i#<#len#)#{##if#(#sb#==#null#)#{#sb#=#new#StringBuffer#(#path#.#substring#(#0#,#i#)#)#;#}##// get UTF-8 bytes for the remaining sub-string#byte#[#]#bytes#=#null#;#byte#b#;#bytes#=#path#.#substring#(#i#)#.#getBytes#(#URI_ENCODING#)#;#len#=#bytes#.#length#;##// for each byte#for#(#i#=#0#;##i#<#len#;#i#++#)#{#b#=#bytes#[#i#]#;##// for non-ascii character: make it positive, then escape##if#(#b#<#0#)#{#ch#=#b#+#BYTE_SIZE#;#sb#.#append#(#'%'#)#;#sb#.#append#(#gHexChs#[#ch#>#>#NIBBLE#]#)#;#sb#.#append#(#gHexChs#[#ch#&#NIBBLE_MASK#]#)#;#}#else##if#(#gNeedEscaping#[#b#]#)#{#sb#.#append#(#'%'#)#;#sb#.#append#(#gAfterEscaping1#[#b#]#)#;#sb#.#append#(#gAfterEscaping2#[#b#]#)#;#}#else#{#sb#.#append#(#(#char#)#b#)#;#}#}#}##return#sb#==#null#?#path#:#sb#.#toString#(#)#;#}