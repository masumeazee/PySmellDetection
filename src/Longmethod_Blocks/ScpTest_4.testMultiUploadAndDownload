void#testMultiUploadAndDownload#(#)#throws#IOException#{#assertNotNull#(#"system property scp.tmp must be set"#,#tempDir#)#;#List#uploadList#=#new#ArrayList#(#)#;##for#(#int#i#=#0#;##i#<#5#;#i#++#)#{#uploadList#.#add#(#createTemporaryFile#(#)#)#;#}##Scp#scp#=#createTask#(#)#;#FilenameSelector#selector#=#new#FilenameSelector#(#)#;#selector#.#setName#(#"scp*"#)#;#FileSet#fileset#=#new#FileSet#(#)#;#fileset#.#setDir#(#tempDir#)#;#fileset#.#addFilename#(#selector#)#;#scp#.#addFileset#(#fileset#)#;#scp#.#setTodir#(#sshHostUri#)#;#scp#.#execute#(#)#;#File#multi#=#new#File#(#tempDir#,#"multi"#)#;#multi#.#mkdir#(#)#;#addCleanup#(#multi#)#;#Scp#scp2#=#createTask#(#)#;#scp2#.#setFile#(#sshHostUri#+#"/scp*"#)#;#scp2#.#setTodir#(#multi#.#getPath#(#)#)#;#scp2#.#execute#(#)#;#FilesMatch#match#=#new#FilesMatch#(#)#;##for#(#Iterator#i#=#uploadList#.#iterator#(#)#;##i#.#hasNext#(#)#;#)#{#File#f#=#(#File#)#i#.#next#(#)#;#match#.#setFile1#(#f#)#;#File#f2#=#new#File#(#multi#,#f#.#getName#(#)#)#;#match#.#setFile2#(#f2#)#;#assertTrue#(#"Assert file '"#+#f#.#getPath#(#)#+#"' and file '"#+#f2#.#getPath#(#)#+#"'"#,#match#.#eval#(#)#)#;#}#}