String#normalizeFileName#(#String#fileName#,#boolean#preserveLeadingSlashes#)#{#String#osname#=#System#.#getProperty#(#"os.name"#)#.#toLowerCase#(#Locale#.#US#)#;##if#(#osname#!=#null#)#{##// Strip off drive letters!##// REVIEW Would a better check be "(File.separator == '\')"?##if#(#osname#.#startsWith#(#"windows"#)#)#{##if#(#fileName#.#length#(#)#>#2#)#{#char#ch1#=#fileName#.#charAt#(#0#)#;#char#ch2#=#fileName#.#charAt#(#1#)#;##if#(#ch2#==#':'#&&#(#(#ch1#>=#'a'#&&#ch1#<=#'z'#)#||#(#ch1#>=#'A'#&&#ch1#<=#'Z'#)#)#)#{#fileName#=#fileName#.#substring#(#2#)#;#}#}#}#else##if#(#osname#.#indexOf#(#"netware"#)#>#-#1#)#{#int#colon#=#fileName#.#indexOf#(#':'#)#;##if#(#colon#!=#-#1#)#{#fileName#=#fileName#.#substring#(#colon#+#1#)#;#}#}#}##fileName#=#fileName#.#replace#(#File#.#separatorChar#,#'/'#)#;##// No absolute pathnames##// Windows (and Posix?) paths can start with "\\NetworkDrive\",##// so we loop on starting /'s.#while#(#!#preserveLeadingSlashes#&&#fileName#.#startsWith#(#"/"#)#)#{#fileName#=#fileName#.#substring#(#1#)#;#}##return#fileName#;#}