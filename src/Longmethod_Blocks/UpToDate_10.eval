boolean#eval#(#)#{##if#(#sourceFileSets#.#size#(#)#==#0#&&#sourceResources#.#size#(#)#==#0#&&#sourceFile#==#null#)#{#throw#new#BuildException#(#"At least one srcfile or a nested "#+#"<srcfiles> or <srcresources> element "#+#"must be set."#)#;#}##if#(#(#sourceFileSets#.#size#(#)#>#0#||#sourceResources#.#size#(#)#>#0#)#&&#sourceFile#!=#null#)#{#throw#new#BuildException#(#"Cannot specify both the srcfile "#+#"attribute and a nested <srcfiles> "#+#"or <srcresources> element."#)#;#}##if#(#targetFile#==#null#&&#mapperElement#==#null#)#{#throw#new#BuildException#(#"The targetfile attribute or a nested "#+#"mapper element must be set."#)#;#}##// if the target file is not there, then it can't be up-to-date##if#(#targetFile#!=#null#&&#!#targetFile#.#exists#(#)#)#{#log#(#"The targetfile \""#+#targetFile#.#getAbsolutePath#(#)#+#"\" does not exist."#,#Project#.#MSG_VERBOSE#)#;##return#false#;#}##// if the source file isn't there, throw an exception##if#(#sourceFile#!=#null#&&#!#sourceFile#.#exists#(#)#)#{#throw#new#BuildException#(#sourceFile#.#getAbsolutePath#(#)#+#" not found."#)#;#}##boolean#upToDate#=#true#;##if#(#sourceFile#!=#null#)#{##if#(#mapperElement#==#null#)#{#upToDate#=#targetFile#.#lastModified#(#)#>=#sourceFile#.#lastModified#(#)#;#}#else#{#SourceFileScanner#sfs#=#new#SourceFileScanner#(#this#)#;#upToDate#=#sfs#.#restrict#(#new#String#[#]#{#sourceFile#.#getAbsolutePath#(#)#}##,#null#,#null#,#mapperElement#.#getImplementation#(#)#)#.#length#==#0#;#}##if#(#!#upToDate#)#{#log#(#sourceFile#.#getAbsolutePath#(#)#+#" is newer than (one of) its target(s)."#,#Project#.#MSG_VERBOSE#)#;#}#}##// filesets are separate from the rest for performance##// reasons.  If we use the code for union below, we'll always##// scan all filesets, even if we know the target is out of##// date after the first test.#Enumeration#e#=#sourceFileSets#.#elements#(#)#;##while#(#upToDate#&&#e#.#hasMoreElements#(#)#)#{#FileSet#fs#=#(#FileSet#)#e#.#nextElement#(#)#;#DirectoryScanner#ds#=#fs#.#getDirectoryScanner#(#getProject#(#)#)#;#upToDate#=#scanDir#(#fs#.#getDir#(#getProject#(#)#)#,#ds#.#getIncludedFiles#(#)#)#;#}##if#(#upToDate#)#{#Resource#[#]#r#=#sourceResources#.#listResources#(#)#;##if#(#r#.#length#>#0#)#{#upToDate#=#ResourceUtils#.#selectOutOfDateSources#(#this#,#r#,#getMapper#(#)#,#getProject#(#)#)#.#length#==#0#;#}#}##return#upToDate#;#}