void#addVendorFiles#(#Hashtable#ejbFiles#,#String#ddPrefix#)#{#File#weblogicDD#=#new#File#(#getConfig#(#)#.#descriptorDir#,#ddPrefix#+#WL_DD#)#;##if#(#weblogicDD#.#exists#(#)#)#{#ejbFiles#.#put#(#META_DIR#+#WL_DD#,#weblogicDD#)#;#}#else#{#log#(#"Unable to locate weblogic deployment descriptor. "#+#"It was expected to be in "#+#weblogicDD#.#getPath#(#)#,#Project#.#MSG_WARN#)#;##return#;#}##if#(#!#newCMP#)#{#log#(#"The old method for locating CMP files has been DEPRECATED."#,#Project#.#MSG_VERBOSE#)#;#log#(#"Please adjust your weblogic descriptor and set "#+#"newCMP=\"true\" to use the new CMP descriptor "#+#"inclusion mechanism. "#,#Project#.#MSG_VERBOSE#)#;##// The the weblogic cmp deployment descriptor#File#weblogicCMPDD#=#new#File#(#getConfig#(#)#.#descriptorDir#,#ddPrefix#+#WL_CMP_DD#)#;##if#(#weblogicCMPDD#.#exists#(#)#)#{#ejbFiles#.#put#(#META_DIR#+#WL_CMP_DD#,#weblogicCMPDD#)#;#}#}#else#{##// now that we have the weblogic descriptor, we parse the file##// to find other descriptors needed to deploy the bean.##// this could be the weblogic-cmp-rdbms.xml or any other O/R##// mapping tool descriptors.#try#{#File#ejbDescriptor#=#(#File#)#ejbFiles#.#get#(#META_DIR#+#EJB_DD#)#;#SAXParserFactory#saxParserFactory#=#SAXParserFactory#.#newInstance#(#)#;#saxParserFactory#.#setValidating#(#true#)#;#SAXParser#saxParser#=#saxParserFactory#.#newSAXParser#(#)#;#DescriptorHandler#handler#=#getWeblogicDescriptorHandler#(#ejbDescriptor#.#getParentFile#(#)#)#;#saxParser#.#parse#(#new#InputSource#(#new#FileInputStream#(#weblogicDD#)#)#,#handler#)#;#Hashtable#ht#=#handler#.#getFiles#(#)#;#Enumeration#e#=#ht#.#keys#(#)#;##while#(#e#.#hasMoreElements#(#)#)#{#String#key#=#(#String#)#e#.#nextElement#(#)#;#ejbFiles#.#put#(#key#,#ht#.#get#(#key#)#)#;#}#}##catch#(#Exception#e#)#{#String#msg#=#"Exception while adding Vendor specific files: "#+#e#.#toString#(#)#;#throw#new#BuildException#(#msg#,#e#)#;#}#}#}