Element#createDocument#(#)#{##// create the dom tree#DocumentBuilder#builder#=#getDocumentBuilder#(#)#;#Document#doc#=#builder#.#newDocument#(#)#;#Element#rootElement#=#doc#.#createElement#(#TESTSUITES#)#;#doc#.#appendChild#(#rootElement#)#;#generatedId#=#0#;##// get all files and add them to the document#File#[#]#files#=#getFiles#(#)#;##for#(#int#i#=#0#;##i#<#files#.#length#;#i#++#)#{#File#file#=#files#[#i#]#;##try#{#log#(#"Parsing file: '"#+#file#+#"'"#,#Project#.#MSG_VERBOSE#)#;##if#(#file#.#length#(#)#>#0#)#{#Document#testsuiteDoc#=#builder#.#parse#(#FileUtils#.#getFileUtils#(#)#.#toURI#(#files#[#i#]#.#getAbsolutePath#(#)#)#)#;#Element#elem#=#testsuiteDoc#.#getDocumentElement#(#)#;##// make sure that this is REALLY a testsuite.##if#(#TESTSUITE#.#equals#(#elem#.#getNodeName#(#)#)#)#{#addTestSuite#(#rootElement#,#elem#)#;#generatedId#++#;#}#else#{##//wrong root element name##// issue a warning.#log#(#"the file "#+#file#+#WARNING_INVALID_ROOT_ELEMENT#,#Project#.#MSG_WARN#)#;#}#}#else#{#log#(#"the file "#+#file#+#WARNING_EMPTY_FILE#,#Project#.#MSG_WARN#)#;#}#}##catch#(#SAXException#e#)#{##// a testcase might have failed and write a zero-length document,##// It has already failed, but hey.... mm. just put a warning#log#(#"The file "#+#file#+#WARNING_IS_POSSIBLY_CORRUPTED#,#Project#.#MSG_WARN#)#;#log#(#StringUtils#.#getStackTrace#(#e#)#,#Project#.#MSG_DEBUG#)#;#}##catch#(#IOException#e#)#{#log#(#"Error while accessing file "#+#file#+#": "#+#e#.#getMessage#(#)#,#Project#.#MSG_ERR#)#;#}#}##return#rootElement#;#}