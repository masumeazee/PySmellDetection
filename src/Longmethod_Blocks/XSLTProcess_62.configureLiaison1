void#configureLiaison#(#Resource#stylesheet#)#throws#BuildException#{##if#(#stylesheetLoaded#&&#reuseLoadedStylesheet#)#{##return#;#}##stylesheetLoaded#=#true#;##try#{#log#(#"Loading stylesheet "#+#stylesheet#,#Project#.#MSG_INFO#)#;##// We call liason.configure() and then liaison.setStylesheet()##// so that the internal variables of liaison can be set up##if#(#liaison#instanceof#XSLTLiaison2#)#{#(#(#XSLTLiaison2#)#liaison#)#.#configure#(#this#)#;#}##if#(#liaison#instanceof#XSLTLiaison3#)#{##// If we are here we can set the stylesheet as a##// resource#(#(#XSLTLiaison3#)#liaison#)#.#setStylesheet#(#stylesheet#)#;#}#else#{##// If we are here we cannot set the stylesheet as##// a resource, but we can set it as a file. So,##// we make an attempt to get it as a file#FileProvider#fp#=#(#FileProvider#)#stylesheet#.#as#(#FileProvider#.#class#)#;##if#(#fp#!=#null#)#{#liaison#.#setStylesheet#(#fp#.#getFile#(#)#)#;#}#else#{#handleError#(#liaison#.#getClass#(#)#.#toString#(#)#+#" accepts the stylesheet only as a file"#)#;##return#;#}#}##for#(#Enumeration#e#=#params#.#elements#(#)#;##e#.#hasMoreElements#(#)#;#)#{#Param#p#=#(#Param#)#e#.#nextElement#(#)#;##if#(#p#.#shouldUse#(#)#)#{#liaison#.#addParam#(#p#.#getName#(#)#,#p#.#getExpression#(#)#)#;#}#}#}##catch#(#Exception#ex#)#{#log#(#"Failed to transform using stylesheet "#+#stylesheet#,#Project#.#MSG_INFO#)#;#handleTransformationError#(#ex#)#;#}#}