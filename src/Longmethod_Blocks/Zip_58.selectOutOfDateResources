Resource#[#]#selectOutOfDateResources#(#Resource#[#]#initial#,#FileNameMapper#mapper#)#{#Resource#[#]#rs#=#selectFileResources#(#initial#)#;#Resource#[#]#result#=#ResourceUtils#.#selectOutOfDateSources#(#this#,#rs#,#mapper#,#getZipScanner#(#)#)#;##if#(#!#doFilesonly#)#{#Union#u#=#new#Union#(#)#;#u#.#addAll#(#Arrays#.#asList#(#selectDirectoryResources#(#initial#)#)#)#;#ResourceCollection#rc#=#ResourceUtils#.#selectSources#(#this#,#u#,#mapper#,#getZipScanner#(#)#,#MISSING_DIR_PROVIDER#)#;##if#(#rc#.#size#(#)#>#0#)#{#ArrayList#newer#=#new#ArrayList#(#)#;#newer#.#addAll#(#Arrays#.#asList#(#(#(#Union#)#rc#)#.#listResources#(#)#)#)#;#newer#.#addAll#(#Arrays#.#asList#(#result#)#)#;#result#=#(#Resource#[#]#)#newer#.#toArray#(#result#)#;#}#}##return#result#;#}