void#setMaxmemory#(#String#max#)#{#maxMemory#=#max#;#}##void#setJar#(#final#File#jar#)#{#this#.#jar#=#jar#;#}##void#setAlias#(#final#String#alias#)#{#this#.#alias#=#alias#;#}##void#setKeystore#(#final#String#keystore#)#{#this#.#keystore#=#keystore#;#}##void#setStorepass#(#final#String#storepass#)#{#this#.#storepass#=#storepass#;#}##void#setStoretype#(#final#String#storetype#)#{#this#.#storetype#=#storetype#;#}##void#setKeypass#(#final#String#keypass#)#{#this#.#keypass#=#keypass#;#}##void#setVerbose#(#final#boolean#verbose#)#{#this#.#verbose#=#verbose#;#}##void#addFileset#(#final#FileSet#set#)#{#filesets#.#addElement#(#set#)#;#}##void#addSysproperty#(#Environment#.#Variable#sysp#)#{#sysProperties#.#addVariable#(#sysp#)#;#}##Path#createPath#(#)#{#if#(#path#==#null#)#{#path#=#new#Path#(#getProject#(#)#)#;#}#return#path#.#createPath#(#)#;#}##void#beginExecution#(#)#{#redirector#=#createRedirector#(#)#;#}##void#endExecution#(#)#{#redirector#=#null#;#}##RedirectorElement#createRedirector#(#)#{#RedirectorElement#result#=#new#RedirectorElement#(#)#;#if#(#storepass#!=#null#)#{#StringBuffer#input#=#new#StringBuffer#(#storepass#)#.#append#(#'\n'#)#;#if#(#keypass#!=#null#)#{#input#.#append#(#keypass#)#.#append#(#'\n'#)#;#}#result#.#setInputString#(#input#.#toString#(#)#)#;#result#.#setLogInputString#(#false#)#;#// Try to avoid showing password prompts on log output, as they would be confusing.#LineContainsRegExp#filter#=#new#LineContainsRegExp#(#)#;#RegularExpression#rx#=#new#RegularExpression#(#)#;#// XXX only handles English locale, not ja or zh_CN#rx#.#setPattern#(#"^(Enter Passphrase for keystore: |Enter key password for .+: )$"#)#;#filter#.#addConfiguredRegexp#(#rx#)#;#filter#.#setNegate#(#true#)#;#result#.#createErrorFilterChain#(#)#.#addLineContainsRegExp#(#filter#)#;#}#return#result#;#}##RedirectorElement#getRedirector#(#)#{#return#redirector#;#}##void#setExecutable#(#String#executable#)#{#this#.#executable#=#executable#;#}##void#setCommonOptions#(#final#ExecTask#cmd#)#{#if#(#maxMemory#!=#null#)#{#addValue#(#cmd#,#"-J-Xmx"#+#maxMemory#)#;#}#if#(#verbose#)#{#addValue#(#cmd#,#"-verbose"#)#;#}#//now patch in all system properties#Vector#props#=#sysProperties#.#getVariablesVector#(#)#;#Enumeration#e#=#props#.#elements#(#)#;#while#(#e#.#hasMoreElements#(#)#)#{#Environment#.#Variable#variable#=#(#Environment#.#Variable#)#e#.#nextElement#(#)#;#declareSysProperty#(#cmd#,#variable#)#;#}#}##void#declareSysProperty#(#ExecTask#cmd#,#Environment#.#Variable#property#)#throws#BuildException#{#addValue#(#cmd#,#"-J-D"#+#property#.#getContent#(#)#)#;#}##void#bindToKeystore#(#final#ExecTask#cmd#)#{#if#(#null#!=#keystore#)#{#// is the keystore a file#addValue#(#cmd#,#"-keystore"#)#;#String#loc#;#File#keystoreFile#=#getProject#(#)#.#resolveFile#(#keystore#)#;#if#(#keystoreFile#.#exists#(#)#)#{#loc#=#keystoreFile#.#getPath#(#)#;#}#else#{#// must be a URL - just pass as is#loc#=#keystore#;#}#addValue#(#cmd#,#loc#)#;#}#if#(#null#!=#storetype#)#{#addValue#(#cmd#,#"-storetype"#)#;#addValue#(#cmd#,#storetype#)#;#}#}##ExecTask#createJarSigner#(#)#{#final#ExecTask#cmd#=#new#ExecTask#(#this#)#;#if#(#executable#==#null#)#{#cmd#.#setExecutable#(#JavaEnvUtils#.#getJdkExecutable#(#JARSIGNER_COMMAND#)#)#;#}#else#{#cmd#.#setExecutable#(#executable#)#;#}#cmd#.#setTaskType#(#JARSIGNER_COMMAND#)#;#cmd#.#setFailonerror#(#true#)#;#cmd#.#addConfiguredRedirector#(#redirector#)#;#return#cmd#;#}##Vector#createUnifiedSources#(#)#{#Vector#sources#=#(#Vector#)#filesets#.#clone#(#)#;#if#(#jar#!=#null#)#{#//we create a fileset with the source file.#//this lets us combine our logic for handling output directories,#//mapping etc.#FileSet#sourceJar#=#new#FileSet#(#)#;#sourceJar#.#setProject#(#getProject#(#)#)#;#sourceJar#.#setFile#(#jar#)#;#sourceJar#.#setDir#(#jar#.#getParentFile#(#)#)#;#sources#.#add#(#sourceJar#)#;#}#return#sources#;#}##Path#createUnifiedSourcePath#(#)#{#Path#p#=#path#==#null#?#new#Path#(#getProject#(#)#)#:#(#Path#)#path#.#clone#(#)#;#Vector#s#=#createUnifiedSources#(#)#;#Enumeration#e#=#s#.#elements#(#)#;#while#(#e#.#hasMoreElements#(#)#)#{#p#.#add#(#(#FileSet#)#e#.#nextElement#(#)#)#;#}#return#p#;#}##boolean#hasResources#(#)#{#return#path#!=#null#||#filesets#.#size#(#)#>#0#;#}##void#addValue#(#final#ExecTask#cmd#,#String#value#)#{#cmd#.#createArg#(#)#.#setValue#(#value#)#;#}##