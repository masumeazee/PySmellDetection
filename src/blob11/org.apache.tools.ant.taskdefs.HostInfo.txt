void#setPrefix#(#String#aPrefix#)#{#prefix#=#aPrefix#;#if#(#!#prefix#.#endsWith#(#"."#)#)#{#prefix#+=#"."#;#}#}##void#setHost#(#String#aHost#)#{#host#=#aHost#;#}##void#execute#(#)#throws#BuildException#{#if#(#host#==#null#||#""#.#equals#(#host#)#)#{#executeLocal#(#)#;#}#else#{#executeRemote#(#)#;#}#}##void#executeLocal#(#)#{#try#{#Enumeration#interfaces#=#NetworkInterface#.#getNetworkInterfaces#(#)#;#inetAddrs#=#new#LinkedList#(#)#;#while#(#interfaces#.#hasMoreElements#(#)#)#{#NetworkInterface#currentif#=#(#NetworkInterface#)#interfaces#.#nextElement#(#)#;#Enumeration#addrs#=#currentif#.#getInetAddresses#(#)#;#while#(#addrs#.#hasMoreElements#(#)#)#{#inetAddrs#.#add#(#addrs#.#nextElement#(#)#)#;#}#}#selectAddresses#(#)#;#if#(#nameAddr#!=#null#)#{#setDomainAndName#(#nameAddr#.#getCanonicalHostName#(#)#)#;#}#else#{#setProperty#(#DOMAIN#,#DEF_DOMAIN#)#;#setProperty#(#NAME#,#DEF_LOCAL_NAME#)#;#}#if#(#best4#!=#null#)#{#setProperty#(#ADDR4#,#best4#.#getHostAddress#(#)#)#;#}#else#{#setProperty#(#ADDR4#,#DEF_LOCAL_ADDR4#)#;#}#if#(#best6#!=#null#)#{#setProperty#(#ADDR6#,#best6#.#getHostAddress#(#)#)#;#}#else#{#setProperty#(#ADDR6#,#DEF_LOCAL_ADDR6#)#;#}#}#catch#(#Exception#e#)#{#log#(#"Error retrieving local host information"#,#e#,#Project#.#MSG_WARN#)#;#setProperty#(#DOMAIN#,#DEF_DOMAIN#)#;#setProperty#(#NAME#,#DEF_LOCAL_NAME#)#;#setProperty#(#ADDR4#,#DEF_LOCAL_ADDR4#)#;#setProperty#(#ADDR6#,#DEF_LOCAL_ADDR6#)#;#}#}##void#selectAddresses#(#)#{#Iterator#i#=#inetAddrs#.#iterator#(#)#;#while#(#i#.#hasNext#(#)#)#{#InetAddress#current#=#(#InetAddress#)#i#.#next#(#)#;#if#(#!#current#.#isMulticastAddress#(#)#)#{#if#(#current#instanceof#Inet4Address#)#{#best4#=#selectBestAddress#(#best4#,#current#)#;#}#else#if#(#current#instanceof#Inet6Address#)#{#best6#=#selectBestAddress#(#best6#,#current#)#;#}#}#}#nameAddr#=#selectBestAddress#(#best6#,#best4#)#;#}##InetAddress#selectBestAddress#(#InetAddress#bestSoFar#,#InetAddress#current#)#{#InetAddress#best#=#bestSoFar#;#if#(#best#==#null#)#{#// none selected so far, so this one is better.#best#=#current#;#}#else#{#if#(#current#.#isLoopbackAddress#(#)#)#{#// definitely not better than the previously selected address.#}#else#if#(#current#.#isLinkLocalAddress#(#)#)#{#// link local considered better than loopback#if#(#best#.#isLoopbackAddress#(#)#)#{#best#=#current#;#}#}#else#if#(#current#.#isSiteLocalAddress#(#)#)#{#// site local considered better than link local (and loopback)#if#(#best#.#isLoopbackAddress#(#)#||#best#.#isLinkLocalAddress#(#)#)#{#best#=#current#;#}#}#else#{#// current is a global address, and therefore best (at least#// equally well)#best#=#current#;#}#}#return#best#;#}##void#executeRemote#(#)#{#try#{#inetAddrs#=#Arrays#.#asList#(#InetAddress#.#getAllByName#(#host#)#)#;#selectAddresses#(#)#;#if#(#nameAddr#!=#null#)#{#setDomainAndName#(#nameAddr#.#getCanonicalHostName#(#)#)#;#}#else#{#setDomainAndName#(#host#)#;#}#if#(#best4#!=#null#)#{#setProperty#(#ADDR4#,#best4#.#getHostAddress#(#)#)#;#}#else#{#setProperty#(#ADDR4#,#DEF_REM_ADDR4#)#;#}#if#(#best6#!=#null#)#{#setProperty#(#ADDR6#,#best6#.#getHostAddress#(#)#)#;#}#else#{#setProperty#(#ADDR6#,#DEF_REM_ADDR6#)#;#}#}#catch#(#Exception#e#)#{#log#(#"Error retrieving remote host information for host:"#+#host#+#"."#,#e#,#Project#.#MSG_WARN#)#;#setDomainAndName#(#host#)#;#setProperty#(#ADDR4#,#DEF_REM_ADDR4#)#;#setProperty#(#ADDR6#,#DEF_REM_ADDR6#)#;#}#}##void#setDomainAndName#(#String#fqdn#)#{#int#idx#=#fqdn#.#indexOf#(#'.'#)#;#if#(#idx#>#0#)#{#setProperty#(#NAME#,#fqdn#.#substring#(#0#,#idx#)#)#;#setProperty#(#DOMAIN#,#fqdn#.#substring#(#idx#+#1#)#)#;#}#else#{#setProperty#(#NAME#,#fqdn#)#;#setProperty#(#DOMAIN#,#DEF_DOMAIN#)#;#}#}##void#setProperty#(#String#name#,#String#value#)#{#getProject#(#)#.#setNewProperty#(#prefix#+#name#,#value#)#;#}##