void#setProcessOutputStream#(#InputStream#is#)#{#createProcessOutputPump#(#is#,#out#)#;#}##void#setProcessErrorStream#(#InputStream#is#)#{#if#(#err#!=#null#)#{#createProcessErrorPump#(#is#,#err#)#;#}#}##void#setProcessInputStream#(#OutputStream#os#)#{#if#(#input#!=#null#)#{#inputPump#=#createInputPump#(#input#,#os#,#true#)#;#}#else#{#try#{#os#.#close#(#)#;#}#catch#(#IOException#e#)#{#//ignore#}#}#}##void#start#(#)#{#outputThread#.#start#(#)#;#errorThread#.#start#(#)#;#if#(#inputPump#!=#null#)#{#Thread#inputThread#=#new#Thread#(#inputPump#)#;#inputThread#.#setDaemon#(#true#)#;#inputThread#.#start#(#)#;#}#}##void#stop#(#)#{#finish#(#outputThread#)#;#finish#(#errorThread#)#;#if#(#inputPump#!=#null#)#{#inputPump#.#stop#(#)#;#}#try#{#err#.#flush#(#)#;#}#catch#(#IOException#e#)#{#// ignore#}#try#{#out#.#flush#(#)#;#}#catch#(#IOException#e#)#{#// ignore#}#}##void#finish#(#Thread#t#)#{#try#{#t#.#join#(#JOIN_TIMEOUT#)#;#StreamPumper#s#=#null#;#if#(#t#instanceof#ThreadWithPumper#)#{#s#=#(#(#ThreadWithPumper#)#t#)#.#getPumper#(#)#;#}#if#(#s#!=#null#&&#!#s#.#isFinished#(#)#)#{#s#.#stop#(#)#;#}#while#(#(#s#==#null#||#!#s#.#isFinished#(#)#)#&&#t#.#isAlive#(#)#)#{#t#.#interrupt#(#)#;#t#.#join#(#JOIN_TIMEOUT#)#;#}#}#catch#(#InterruptedException#e#)#{#// ignore#}#}##OutputStream#getErr#(#)#{#return#err#;#}##OutputStream#getOut#(#)#{#return#out#;#}##void#createProcessOutputPump#(#InputStream#is#,#OutputStream#os#)#{#outputThread#=#createPump#(#is#,#os#)#;#}##void#createProcessErrorPump#(#InputStream#is#,#OutputStream#os#)#{#errorThread#=#createPump#(#is#,#os#)#;#}##Thread#createPump#(#InputStream#is#,#OutputStream#os#)#{#return#createPump#(#is#,#os#,#false#)#;#}##Thread#createPump#(#InputStream#is#,#OutputStream#os#,#boolean#closeWhenExhausted#)#{#final#Thread#result#=#new#ThreadWithPumper#(#new#StreamPumper#(#is#,#os#,#closeWhenExhausted#,#Os#.#isFamily#(#"windows"#)#)#)#;#result#.#setDaemon#(#true#)#;#return#result#;#}##StreamPumper#createInputPump#(#InputStream#is#,#OutputStream#os#,#boolean#closeWhenExhausted#)#{#StreamPumper#pumper#=#new#StreamPumper#(#is#,#os#,#closeWhenExhausted#,#false#)#;#pumper#.#setAutoflush#(#true#)#;#return#pumper#;#}##StreamPumper#getPumper#(#)#{#return#pumper#;#}##