void#setProperty#(#final#String#property#)#{#this#.#property#=#property#;#}##void#setValue#(#final#String#value#)#{#this#.#value#=#value#;#}##String#getValue#(#)#{#return#(#value#!=#null#)#?#value#:#"true"#;#}##void#setTargetFile#(#final#File#file#)#{#this#.#targetFile#=#file#;#}##void#setSrcfile#(#final#File#file#)#{#this#.#sourceFile#=#file#;#}##void#addSrcfiles#(#final#FileSet#fs#)#{#sourceFileSets#.#addElement#(#fs#)#;#}##Union#createSrcResources#(#)#{#return#sourceResources#;#}##Mapper#createMapper#(#)#throws#BuildException#{#if#(#mapperElement#!=#null#)#{#throw#new#BuildException#(#"Cannot define more than one mapper"#,#getLocation#(#)#)#;#}#mapperElement#=#new#Mapper#(#getProject#(#)#)#;#return#mapperElement#;#}##void#add#(#FileNameMapper#fileNameMapper#)#{#createMapper#(#)#.#add#(#fileNameMapper#)#;#}##boolean#eval#(#)#{#if#(#sourceFileSets#.#size#(#)#==#0#&&#sourceResources#.#size#(#)#==#0#&&#sourceFile#==#null#)#{#throw#new#BuildException#(#"At least one srcfile or a nested "#+#"<srcfiles> or <srcresources> element "#+#"must be set."#)#;#}#if#(#(#sourceFileSets#.#size#(#)#>#0#||#sourceResources#.#size#(#)#>#0#)#&&#sourceFile#!=#null#)#{#throw#new#BuildException#(#"Cannot specify both the srcfile "#+#"attribute and a nested <srcfiles> "#+#"or <srcresources> element."#)#;#}#if#(#targetFile#==#null#&&#mapperElement#==#null#)#{#throw#new#BuildException#(#"The targetfile attribute or a nested "#+#"mapper element must be set."#)#;#}#// if the target file is not there, then it can't be up-to-date#if#(#targetFile#!=#null#&&#!#targetFile#.#exists#(#)#)#{#log#(#"The targetfile \""#+#targetFile#.#getAbsolutePath#(#)#+#"\" does not exist."#,#Project#.#MSG_VERBOSE#)#;#return#false#;#}#// if the source file isn't there, throw an exception#if#(#sourceFile#!=#null#&&#!#sourceFile#.#exists#(#)#)#{#throw#new#BuildException#(#sourceFile#.#getAbsolutePath#(#)#+#" not found."#)#;#}#boolean#upToDate#=#true#;#if#(#sourceFile#!=#null#)#{#if#(#mapperElement#==#null#)#{#upToDate#=#targetFile#.#lastModified#(#)#>=#sourceFile#.#lastModified#(#)#;#}#else#{#SourceFileScanner#sfs#=#new#SourceFileScanner#(#this#)#;#upToDate#=#sfs#.#restrict#(#new#String#[#]#{#sourceFile#.#getAbsolutePath#(#)#}#,#null#,#null#,#mapperElement#.#getImplementation#(#)#)#.#length#==#0#;#}#if#(#!#upToDate#)#{#log#(#sourceFile#.#getAbsolutePath#(#)#+#" is newer than (one of) its target(s)."#,#Project#.#MSG_VERBOSE#)#;#}#}#// filesets are separate from the rest for performance#// reasons.  If we use the code for union below, we'll always#// scan all filesets, even if we know the target is out of#// date after the first test.#Enumeration#e#=#sourceFileSets#.#elements#(#)#;#while#(#upToDate#&&#e#.#hasMoreElements#(#)#)#{#FileSet#fs#=#(#FileSet#)#e#.#nextElement#(#)#;#DirectoryScanner#ds#=#fs#.#getDirectoryScanner#(#getProject#(#)#)#;#upToDate#=#scanDir#(#fs#.#getDir#(#getProject#(#)#)#,#ds#.#getIncludedFiles#(#)#)#;#}#if#(#upToDate#)#{#Resource#[#]#r#=#sourceResources#.#listResources#(#)#;#if#(#r#.#length#>#0#)#{#upToDate#=#ResourceUtils#.#selectOutOfDateSources#(#this#,#r#,#getMapper#(#)#,#getProject#(#)#)#.#length#==#0#;#}#}#return#upToDate#;#}##void#execute#(#)#throws#BuildException#{#if#(#property#==#null#)#{#throw#new#BuildException#(#"property attribute is required."#,#getLocation#(#)#)#;#}#boolean#upToDate#=#eval#(#)#;#if#(#upToDate#)#{#getProject#(#)#.#setNewProperty#(#property#,#getValue#(#)#)#;#if#(#mapperElement#==#null#)#{#log#(#"File \""#+#targetFile#.#getAbsolutePath#(#)#+#"\" is up-to-date."#,#Project#.#MSG_VERBOSE#)#;#}#else#{#log#(#"All target files are up-to-date."#,#Project#.#MSG_VERBOSE#)#;#}#}#}##boolean#scanDir#(#File#srcDir#,#String#[#]#files#)#{#SourceFileScanner#sfs#=#new#SourceFileScanner#(#this#)#;#FileNameMapper#mapper#=#getMapper#(#)#;#File#dir#=#srcDir#;#if#(#mapperElement#==#null#)#{#dir#=#null#;#}#return#sfs#.#restrict#(#files#,#srcDir#,#dir#,#mapper#)#.#length#==#0#;#}##FileNameMapper#getMapper#(#)#{#FileNameMapper#mapper#=#null#;#if#(#mapperElement#==#null#)#{#MergingMapper#mm#=#new#MergingMapper#(#)#;#mm#.#setTo#(#targetFile#.#getAbsolutePath#(#)#)#;#mapper#=#mm#;#}#else#{#mapper#=#mapperElement#.#getImplementation#(#)#;#}#return#mapper#;#}##