void#setMaxWait#(#long#time#)#{#maxWait#=#time#;#}##void#setMaxWaitUnit#(#Unit#unit#)#{#maxWaitMultiplier#=#unit#.#getMultiplier#(#)#;#}##void#setCheckEvery#(#long#time#)#{#checkEvery#=#time#;#}##void#setCheckEveryUnit#(#Unit#unit#)#{#checkEveryMultiplier#=#unit#.#getMultiplier#(#)#;#}##void#setTimeoutProperty#(#String#p#)#{#timeoutProperty#=#p#;#}##void#execute#(#)#throws#BuildException#{#if#(#countConditions#(#)#>#1#)#{#throw#new#BuildException#(#"You must not nest more than one "#+#"condition into "#+#getTaskName#(#)#)#;#}#if#(#countConditions#(#)#<#1#)#{#throw#new#BuildException#(#"You must nest a condition into "#+#getTaskName#(#)#)#;#}#Condition#c#=#(#Condition#)#getConditions#(#)#.#nextElement#(#)#;#try#{#long#maxWaitMillis#=#calculateMaxWaitMillis#(#)#;#long#checkEveryMillis#=#calculateCheckEveryMillis#(#)#;#long#start#=#System#.#currentTimeMillis#(#)#;#long#end#=#start#+#maxWaitMillis#;#while#(#System#.#currentTimeMillis#(#)#<#end#)#{#if#(#c#.#eval#(#)#)#{#processSuccess#(#)#;#return#;#}#Thread#.#sleep#(#checkEveryMillis#)#;#}#}#catch#(#InterruptedException#e#)#{#log#(#"Task "#+#getTaskName#(#)#+#" interrupted, treating as timed out."#)#;#}#processTimeout#(#)#;#}##long#calculateCheckEveryMillis#(#)#{#return#checkEvery#*#checkEveryMultiplier#;#}##long#calculateMaxWaitMillis#(#)#{#return#maxWait#*#maxWaitMultiplier#;#}##void#processSuccess#(#)#{#log#(#getTaskName#(#)#+#": condition was met"#,#Project#.#MSG_VERBOSE#)#;#}##void#processTimeout#(#)#{#log#(#getTaskName#(#)#+#": timeout"#,#Project#.#MSG_VERBOSE#)#;#if#(#timeoutProperty#!=#null#)#{#getProject#(#)#.#setNewProperty#(#timeoutProperty#,#"true"#)#;#}#}##long#getMultiplier#(#)#{#String#key#=#getValue#(#)#.#toLowerCase#(#)#;#Long#l#=#(#Long#)#timeTable#.#get#(#key#)#;#return#l#.#longValue#(#)#;#}##String#[#]#getValues#(#)#{#return#UNITS#;#}##