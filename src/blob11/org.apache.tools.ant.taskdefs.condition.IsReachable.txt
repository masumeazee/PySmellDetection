void#setHost#(#String#host#)#{#this#.#host#=#host#;#}##void#setUrl#(#String#url#)#{#this#.#url#=#url#;#}##void#setTimeout#(#int#timeout#)#{#this#.#timeout#=#timeout#;#}##boolean#empty#(#String#string#)#{#return#string#==#null#||#string#.#length#(#)#==#0#;#}##boolean#eval#(#)#throws#BuildException#{#if#(#empty#(#host#)#&&#empty#(#url#)#)#{#throw#new#BuildException#(#ERROR_NO_HOSTNAME#)#;#}#if#(#timeout#<#0#)#{#throw#new#BuildException#(#ERROR_BAD_TIMEOUT#)#;#}#String#target#=#host#;#if#(#!#empty#(#url#)#)#{#if#(#!#empty#(#host#)#)#{#throw#new#BuildException#(#ERROR_BOTH_TARGETS#)#;#}#try#{#//get the host of a url#URL#realURL#=#new#URL#(#url#)#;#target#=#realURL#.#getHost#(#)#;#if#(#empty#(#target#)#)#{#throw#new#BuildException#(#ERROR_NO_HOST_IN_URL#+#url#)#;#}#}#catch#(#MalformedURLException#e#)#{#throw#new#BuildException#(#ERROR_BAD_URL#+#url#,#e#)#;#}#}#log#(#"Probing host "#+#target#,#Project#.#MSG_VERBOSE#)#;#InetAddress#address#;#try#{#address#=#InetAddress#.#getByName#(#target#)#;#}#catch#(#UnknownHostException#e1#)#{#log#(#WARN_UNKNOWN_HOST#+#target#)#;#return#false#;#}#log#(#"Host address = "#+#address#.#getHostAddress#(#)#,#Project#.#MSG_VERBOSE#)#;#boolean#reachable#;#//Java1.5: reachable = address.isReachable(timeout * 1000);#Method#reachableMethod#=#null#;#try#{#reachableMethod#=#InetAddress#.#class#.#getMethod#(#METHOD_NAME#,#parameterTypes#)#;#Object#[#]#params#=#new#Object#[#1#]#;#params#[#0#]#=#new#Integer#(#timeout#*#SECOND#)#;#try#{#reachable#=#(#(#Boolean#)#reachableMethod#.#invoke#(#address#,#params#)#)#.#booleanValue#(#)#;#}#catch#(#IllegalAccessException#e#)#{#//utterly implausible, but catered for anyway#throw#new#BuildException#(#"When calling "#+#reachableMethod#)#;#}#catch#(#InvocationTargetException#e#)#{#//assume this is an IOexception about un readability#Throwable#nested#=#e#.#getTargetException#(#)#;#log#(#ERROR_ON_NETWORK#+#target#+#": "#+#nested#.#toString#(#)#)#;#//any kind of fault: not reachable.#reachable#=#false#;#}#}#catch#(#NoSuchMethodException#e#)#{#//java1.4#log#(#"Not found: InetAddress."#+#METHOD_NAME#,#Project#.#MSG_VERBOSE#)#;#log#(#MSG_NO_REACHABLE_TEST#)#;#reachable#=#true#;#}#log#(#"host is"#+#(#reachable#?#""#:#" not"#)#+#" reachable"#,#Project#.#MSG_VERBOSE#)#;#return#reachable#;#}##