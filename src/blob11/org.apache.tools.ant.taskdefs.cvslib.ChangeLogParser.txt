CVSEntry#[#]#getEntrySetAsArray#(#)#{#final#CVSEntry#[#]#array#=#new#CVSEntry#[#entries#.#size#(#)#]#;#int#i#=#0#;#for#(#Enumeration#e#=#entries#.#elements#(#)#;#e#.#hasMoreElements#(#)#;#)#{#array#[#i#++#]#=#(#CVSEntry#)#e#.#nextElement#(#)#;#}#return#array#;#}##void#stdout#(#final#String#line#)#{#switch#(#status#)#{#case#GET_FILE#:#// make sure attributes are reset when#// working on a 'new' file.#reset#(#)#;#processFile#(#line#)#;#break#;#case#GET_REVISION#:#processRevision#(#line#)#;#break#;#case#GET_DATE#:#processDate#(#line#)#;#break#;#case#GET_COMMENT#:#processComment#(#line#)#;#break#;#case#GET_PREVIOUS_REV#:#processGetPreviousRevision#(#line#)#;#break#;#default#:#// Do nothing#break#;#}#}##void#processComment#(#final#String#line#)#{#final#String#lineSeparator#=#System#.#getProperty#(#"line.separator"#)#;#if#(#line#.#equals#(#"============================================================================="#)#)#{#//We have ended changelog for that particular file#//so we can save it#final#int#end#=#comment#.#length#(#)#-#lineSeparator#.#length#(#)#;#//was -1#comment#=#comment#.#substring#(#0#,#end#)#;#saveEntry#(#)#;#status#=#GET_FILE#;#}#else#if#(#line#.#equals#(#"----------------------------"#)#)#{#final#int#end#=#comment#.#length#(#)#-#lineSeparator#.#length#(#)#;#//was -1#comment#=#comment#.#substring#(#0#,#end#)#;#status#=#GET_PREVIOUS_REV#;#}#else#{#comment#+=#line#+#lineSeparator#;#}#}##void#processFile#(#final#String#line#)#{#if#(#!#remote#&&#line#.#startsWith#(#"Working file:"#)#)#{#// CheckStyle:MagicNumber OFF#file#=#line#.#substring#(#14#,#line#.#length#(#)#)#;#// CheckStyle:MagicNumber ON#status#=#GET_REVISION#;#}#else#if#(#remote#&&#line#.#startsWith#(#"RCS file:"#)#)#{#// exclude the part of the RCS filename up to and#// including the module name (and the path separator)#int#startOfFileName#=#0#;#for#(#int#i#=#0#;#i#<#moduleNames#.#length#;#i#++#)#{#int#index#=#line#.#indexOf#(#moduleNames#[#i#]#)#;#if#(#index#>=#0#)#{#startOfFileName#=#index#+#moduleNameLengths#[#i#]#+#1#;#break#;#}#}#int#endOfFileName#=#line#.#indexOf#(#",v"#)#;#if#(#endOfFileName#==#-#1#)#{#file#=#line#.#substring#(#startOfFileName#)#;#}#else#{#file#=#line#.#substring#(#startOfFileName#,#endOfFileName#)#;#}#status#=#GET_REVISION#;#}#}##void#processRevision#(#final#String#line#)#{#if#(#line#.#startsWith#(#"revision"#)#)#{#// CheckStyle:MagicNumber OFF#revision#=#line#.#substring#(#9#)#;#// CheckStyle:MagicNumber ON#status#=#GET_DATE#;#}#else#if#(#line#.#startsWith#(#"======"#)#)#{#//There were no revisions in this changelog#//entry so lets move onto next file#status#=#GET_FILE#;#}#}##void#processDate#(#final#String#line#)#{#if#(#line#.#startsWith#(#"date:"#)#)#{#// The date format is using a - format since 1.12.9 so we have:#// 1.12.9-: 'date: YYYY/mm/dd HH:mm:ss;  author: name;'#// 1.12.9+: 'date: YYYY-mm-dd HH:mm:ss Z;  author: name'#int#endOfDateIndex#=#line#.#indexOf#(#';'#)#;#date#=#line#.#substring#(#"date: "#.#length#(#)#,#endOfDateIndex#)#;#int#startOfAuthorIndex#=#line#.#indexOf#(#"author: "#,#endOfDateIndex#+#1#)#;#int#endOfAuthorIndex#=#line#.#indexOf#(#';'#,#startOfAuthorIndex#+#1#)#;#author#=#line#.#substring#(#"author: "#.#length#(#)#+#startOfAuthorIndex#,#endOfAuthorIndex#)#;#status#=#GET_COMMENT#;#//Reset comment to empty here as we can accumulate multiple lines#//in the processComment method#comment#=#""#;#}#}##void#processGetPreviousRevision#(#final#String#line#)#{#if#(#!#line#.#startsWith#(#"revision "#)#)#{#throw#new#IllegalStateException#(#"Unexpected line from CVS: "#+#line#)#;#}#previousRevision#=#line#.#substring#(#"revision "#.#length#(#)#)#;#saveEntry#(#)#;#revision#=#previousRevision#;#status#=#GET_DATE#;#}##void#saveEntry#(#)#{#final#String#entryKey#=#date#+#author#+#comment#;#CVSEntry#entry#;#if#(#!#entries#.#containsKey#(#entryKey#)#)#{#Date#dateObject#=#parseDate#(#date#)#;#entry#=#new#CVSEntry#(#dateObject#,#author#,#comment#)#;#entries#.#put#(#entryKey#,#entry#)#;#}#else#{#entry#=#(#CVSEntry#)#entries#.#get#(#entryKey#)#;#}#entry#.#addFile#(#file#,#revision#,#previousRevision#)#;#}##Date#parseDate#(#final#String#date#)#{#try#{#return#INPUT_DATE#.#parse#(#date#)#;#}#catch#(#ParseException#e#)#{#try#{#return#CVS1129_INPUT_DATE#.#parse#(#date#)#;#}#catch#(#ParseException#e2#)#{#throw#new#IllegalStateException#(#"Invalid date format: "#+#date#)#;#}#}#}##void#reset#(#)#{#this#.#file#=#null#;#this#.#date#=#null#;#this#.#author#=#null#;#this#.#comment#=#null#;#this#.#revision#=#null#;#this#.#previousRevision#=#null#;#}##