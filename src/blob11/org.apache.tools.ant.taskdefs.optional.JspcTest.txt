void#setUp#(#)#{#configureProject#(#TASKDEFS_DIR#+#"jspc.xml"#)#;#baseDir#=#new#File#(#System#.#getProperty#(#"root"#)#,#TASKDEFS_DIR#)#;#outDir#=#new#File#(#baseDir#,#"jsp/java"#)#;#}##void#tearDown#(#)#{#executeTarget#(#"cleanup"#)#;#}##void#testSimple#(#)#throws#Exception#{#executeJspCompile#(#"testSimple"#,#"simple_jsp.java"#)#;#}##void#testUriroot#(#)#throws#Exception#{#executeJspCompile#(#"testUriroot"#,#"uriroot_jsp.java"#)#;#}##void#testXml#(#)#throws#Exception#{#executeJspCompile#(#"testXml"#,#"xml_jsp.java"#)#;#}##void#testKeyword#(#)#throws#Exception#{#executeJspCompile#(#"testKeyword"#,#"default_jsp.java"#)#;#}##void#testInvalidClassname#(#)#throws#Exception#{#executeJspCompile#(#"testInvalidClassname"#,#"_1nvalid_0002dclassname_jsp.java"#)#;#}##void#testNoTld#(#)#throws#Exception#{#//         expectBuildExceptionContaining("testNoTld",#//                 "Jasper found an error in a file",#//                 "Java returned: 9");#expectBuildExceptionContaining#(#"testNoTld"#,#"not found"#,#"Java returned: 9"#)#;#}##void#testNotAJspFile#(#)#throws#Exception#{#executeTarget#(#"testNotAJspFile"#)#;#}##void#executeJspCompile#(#String#target#,#String#javafile#)#throws#Exception#{#executeTarget#(#target#)#;#assertJavaFileCreated#(#javafile#)#;#}##void#assertJavaFileCreated#(#String#filename#)#throws#Exception#{#File#file#=#getOutputFile#(#filename#)#;#assertTrue#(#"file "#+#filename#+#" not found"#,#file#.#exists#(#)#)#;#assertTrue#(#"file "#+#filename#+#" is empty"#,#file#.#length#(#)#>#0#)#;#}##File#getOutputFile#(#String#subpath#)#{#return#new#File#(#outDir#,#subpath#)#;#}##void#testJasperNameManglerSelection#(#)#{#JspCompilerAdapter#adapter#=#JspCompilerAdapterFactory#.#getCompiler#(#"jasper"#,#null#,#null#)#;#JspMangler#mangler#=#adapter#.#createMangler#(#)#;#assertTrue#(#mangler#instanceof#JspNameMangler#)#;#adapter#=#JspCompilerAdapterFactory#.#getCompiler#(#"jasper41"#,#null#,#null#)#;#mangler#=#adapter#.#createMangler#(#)#;#assertTrue#(#mangler#instanceof#Jasper41Mangler#)#;#}##void#testJasper41#(#)#{#JspMangler#mangler#=#new#Jasper41Mangler#(#)#;#//java keywords are not special#assertMapped#(#mangler#,#"for.jsp"#,#"for_jsp"#)#;#//underscores go in front of invalid start chars#assertMapped#(#mangler#,#"0.jsp"#,#"_0_jsp"#)#;#//underscores at the front get an underscore too#assertMapped#(#mangler#,#"_.jsp"#,#"___jsp"#)#;#//non java char at start => underscore then the the _hex value#assertMapped#(#mangler#,#"-.jsp"#,#"__0002d_jsp"#)#;#//and paths are stripped#char#s#=#File#.#separatorChar#;#assertMapped#(#mangler#,#""#+#s#+#s#+#"somewhere"#+#s#+#"file"#+#s#+#"index.jsp"#,#"index_jsp"#)#;#}##void#assertMapped#(#JspMangler#mangler#,#String#filename#,#String#classname#)#{#String#mappedname#=#mangler#.#mapJspToJavaName#(#new#File#(#filename#)#)#;#assertTrue#(#filename#+#" should have mapped to "#+#classname#+#" but instead mapped to "#+#mappedname#,#classname#.#equals#(#mappedname#)#)#;#}##