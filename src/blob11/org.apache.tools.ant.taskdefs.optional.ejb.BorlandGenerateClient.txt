void#setVersion#(#int#version#)#{#this#.#version#=#version#;#}##void#setMode#(#String#s#)#{#mode#=#s#;#}##void#setDebug#(#boolean#debug#)#{#this#.#debug#=#debug#;#}##void#setEjbjar#(#File#ejbfile#)#{#ejbjarfile#=#ejbfile#;#}##void#setClientjar#(#File#clientjar#)#{#clientjarfile#=#clientjar#;#}##void#setClasspath#(#Path#classpath#)#{#if#(#this#.#classpath#==#null#)#{#this#.#classpath#=#classpath#;#}#else#{#this#.#classpath#.#append#(#classpath#)#;#}#}##Path#createClasspath#(#)#{#if#(#this#.#classpath#==#null#)#{#this#.#classpath#=#new#Path#(#getProject#(#)#)#;#}#return#this#.#classpath#.#createPath#(#)#;#}##void#setClasspathRef#(#Reference#r#)#{#createClasspath#(#)#.#setRefid#(#r#)#;#}##void#execute#(#)#throws#BuildException#{#if#(#ejbjarfile#==#null#||#ejbjarfile#.#isDirectory#(#)#)#{#throw#new#BuildException#(#"invalid ejb jar file."#)#;#}#if#(#clientjarfile#==#null#||#clientjarfile#.#isDirectory#(#)#)#{#log#(#"invalid or missing client jar file."#,#Project#.#MSG_VERBOSE#)#;#String#ejbjarname#=#ejbjarfile#.#getAbsolutePath#(#)#;#//clientname = ejbjarfile+client.jar#String#clientname#=#ejbjarname#.#substring#(#0#,#ejbjarname#.#lastIndexOf#(#"."#)#)#;#clientname#=#clientname#+#"client.jar"#;#clientjarfile#=#new#File#(#clientname#)#;#}#if#(#mode#==#null#)#{#log#(#"mode is null default mode  is java"#)#;#setMode#(#JAVA_MODE#)#;#}#if#(#!#(#version#==#BorlandDeploymentTool#.#BES#||#version#==#BorlandDeploymentTool#.#BAS#)#)#{#throw#new#BuildException#(#"version "#+#version#+#" is not supported"#)#;#}#log#(#"client jar file is "#+#clientjarfile#)#;#if#(#mode#.#equalsIgnoreCase#(#FORK_MODE#)#)#{#executeFork#(#)#;#}#else#{#executeJava#(#)#;#}#// end of else#}##void#executeJava#(#)#throws#BuildException#{#try#{#if#(#version#==#BorlandDeploymentTool#.#BES#)#{#throw#new#BuildException#(#"java mode is supported only for "#+#"previous version <="#+#BorlandDeploymentTool#.#BAS#)#;#}#log#(#"mode : java"#)#;#Java#execTask#=#null#;#execTask#=#new#Java#(#this#)#;#execTask#.#setDir#(#new#File#(#"."#)#)#;#execTask#.#setClassname#(#"com.inprise.server.commandline.EJBUtilities"#)#;#//classpath#//add at the end of the classpath#//the system classpath in order to find the tools.jar file#execTask#.#setClasspath#(#classpath#.#concatSystemClasspath#(#)#)#;#execTask#.#setFork#(#true#)#;#execTask#.#createArg#(#)#.#setValue#(#"generateclient"#)#;#if#(#debug#)#{#execTask#.#createArg#(#)#.#setValue#(#"-trace"#)#;#}#execTask#.#createArg#(#)#.#setValue#(#"-short"#)#;#execTask#.#createArg#(#)#.#setValue#(#"-jarfile"#)#;#// ejb jar file#execTask#.#createArg#(#)#.#setValue#(#ejbjarfile#.#getAbsolutePath#(#)#)#;#//client jar file#execTask#.#createArg#(#)#.#setValue#(#"-single"#)#;#execTask#.#createArg#(#)#.#setValue#(#"-clientjarfile"#)#;#execTask#.#createArg#(#)#.#setValue#(#clientjarfile#.#getAbsolutePath#(#)#)#;#log#(#"Calling EJBUtilities"#,#Project#.#MSG_VERBOSE#)#;#execTask#.#execute#(#)#;#}#catch#(#Exception#e#)#{#// Have to catch this because of the semantics of calling main()#String#msg#=#"Exception while calling generateclient Details: "#+#e#.#toString#(#)#;#throw#new#BuildException#(#msg#,#e#)#;#}#}##void#executeFork#(#)#throws#BuildException#{#if#(#version#==#BorlandDeploymentTool#.#BAS#)#{#executeForkV4#(#)#;#}#if#(#version#==#BorlandDeploymentTool#.#BES#)#{#executeForkV5#(#)#;#}#}##void#executeForkV4#(#)#throws#BuildException#{#try#{#log#(#"mode : fork "#+#BorlandDeploymentTool#.#BAS#,#Project#.#MSG_DEBUG#)#;#ExecTask#execTask#=#new#ExecTask#(#this#)#;#execTask#.#setDir#(#new#File#(#"."#)#)#;#execTask#.#setExecutable#(#"iastool"#)#;#execTask#.#createArg#(#)#.#setValue#(#"generateclient"#)#;#if#(#debug#)#{#execTask#.#createArg#(#)#.#setValue#(#"-trace"#)#;#}#execTask#.#createArg#(#)#.#setValue#(#"-short"#)#;#execTask#.#createArg#(#)#.#setValue#(#"-jarfile"#)#;#// ejb jar file#execTask#.#createArg#(#)#.#setValue#(#ejbjarfile#.#getAbsolutePath#(#)#)#;#//client jar file#execTask#.#createArg#(#)#.#setValue#(#"-single"#)#;#execTask#.#createArg#(#)#.#setValue#(#"-clientjarfile"#)#;#execTask#.#createArg#(#)#.#setValue#(#clientjarfile#.#getAbsolutePath#(#)#)#;#log#(#"Calling iastool"#,#Project#.#MSG_VERBOSE#)#;#execTask#.#execute#(#)#;#}#catch#(#Exception#e#)#{#// Have to catch this because of the semantics of calling main()#String#msg#=#"Exception while calling generateclient Details: "#+#e#.#toString#(#)#;#throw#new#BuildException#(#msg#,#e#)#;#}#}##void#executeForkV5#(#)#throws#BuildException#{#try#{#log#(#"mode : fork "#+#BorlandDeploymentTool#.#BES#,#Project#.#MSG_DEBUG#)#;#ExecTask#execTask#=#new#ExecTask#(#this#)#;#execTask#.#setDir#(#new#File#(#"."#)#)#;#execTask#.#setExecutable#(#"iastool"#)#;#if#(#debug#)#{#execTask#.#createArg#(#)#.#setValue#(#"-debug"#)#;#}#execTask#.#createArg#(#)#.#setValue#(#"-genclient"#)#;#execTask#.#createArg#(#)#.#setValue#(#"-jars"#)#;#// ejb jar file#execTask#.#createArg#(#)#.#setValue#(#ejbjarfile#.#getAbsolutePath#(#)#)#;#//client jar file#execTask#.#createArg#(#)#.#setValue#(#"-target"#)#;#execTask#.#createArg#(#)#.#setValue#(#clientjarfile#.#getAbsolutePath#(#)#)#;#//classpath#execTask#.#createArg#(#)#.#setValue#(#"-cp"#)#;#execTask#.#createArg#(#)#.#setValue#(#classpath#.#toString#(#)#)#;#log#(#"Calling iastool"#,#Project#.#MSG_VERBOSE#)#;#execTask#.#execute#(#)#;#}#catch#(#Exception#e#)#{#// Have to catch this because of the semantics of calling main()#String#msg#=#"Exception while calling generateclient Details: "#+#e#.#toString#(#)#;#throw#new#BuildException#(#msg#,#e#)#;#}#}##