Extension#[#]#getAvailable#(#final#Manifest#manifest#)#{#if#(#null#==#manifest#)#{#return#new#Extension#[#0#]#;#}#final#ArrayList#results#=#new#ArrayList#(#)#;#final#Attributes#mainAttributes#=#manifest#.#getMainAttributes#(#)#;#if#(#null#!=#mainAttributes#)#{#final#Extension#extension#=#getExtension#(#""#,#mainAttributes#)#;#if#(#null#!=#extension#)#{#results#.#add#(#extension#)#;#}#}#final#Map#entries#=#manifest#.#getEntries#(#)#;#final#Iterator#keys#=#entries#.#keySet#(#)#.#iterator#(#)#;#while#(#keys#.#hasNext#(#)#)#{#final#String#key#=#(#String#)#keys#.#next#(#)#;#final#Attributes#attributes#=#(#Attributes#)#entries#.#get#(#key#)#;#final#Extension#extension#=#getExtension#(#""#,#attributes#)#;#if#(#null#!=#extension#)#{#results#.#add#(#extension#)#;#}#}#return#(#Extension#[#]#)#results#.#toArray#(#new#Extension#[#results#.#size#(#)#]#)#;#}##Extension#[#]#getRequired#(#final#Manifest#manifest#)#{#return#getListed#(#manifest#,#Attributes#.#Name#.#EXTENSION_LIST#)#;#}##Extension#[#]#getOptions#(#final#Manifest#manifest#)#{#return#getListed#(#manifest#,#OPTIONAL_EXTENSION_LIST#)#;#}##void#addExtension#(#final#Extension#extension#,#final#Attributes#attributes#)#{#addExtension#(#extension#,#""#,#attributes#)#;#}##void#addExtension#(#final#Extension#extension#,#final#String#prefix#,#final#Attributes#attributes#)#{#attributes#.#putValue#(#prefix#+#EXTENSION_NAME#,#extension#.#getExtensionName#(#)#)#;#final#String#specificationVendor#=#extension#.#getSpecificationVendor#(#)#;#if#(#null#!=#specificationVendor#)#{#attributes#.#putValue#(#prefix#+#SPECIFICATION_VENDOR#,#specificationVendor#)#;#}#final#DeweyDecimal#specificationVersion#=#extension#.#getSpecificationVersion#(#)#;#if#(#null#!=#specificationVersion#)#{#attributes#.#putValue#(#prefix#+#SPECIFICATION_VERSION#,#specificationVersion#.#toString#(#)#)#;#}#final#String#implementationVendorID#=#extension#.#getImplementationVendorID#(#)#;#if#(#null#!=#implementationVendorID#)#{#attributes#.#putValue#(#prefix#+#IMPLEMENTATION_VENDOR_ID#,#implementationVendorID#)#;#}#final#String#implementationVendor#=#extension#.#getImplementationVendor#(#)#;#if#(#null#!=#implementationVendor#)#{#attributes#.#putValue#(#prefix#+#IMPLEMENTATION_VENDOR#,#implementationVendor#)#;#}#final#DeweyDecimal#implementationVersion#=#extension#.#getImplementationVersion#(#)#;#if#(#null#!=#implementationVersion#)#{#attributes#.#putValue#(#prefix#+#IMPLEMENTATION_VERSION#,#implementationVersion#.#toString#(#)#)#;#}#final#String#implementationURL#=#extension#.#getImplementationURL#(#)#;#if#(#null#!=#implementationURL#)#{#attributes#.#putValue#(#prefix#+#IMPLEMENTATION_URL#,#implementationURL#)#;#}#}##String#getExtensionName#(#)#{#return#extensionName#;#}##String#getSpecificationVendor#(#)#{#return#specificationVendor#;#}##DeweyDecimal#getSpecificationVersion#(#)#{#return#specificationVersion#;#}##String#getImplementationURL#(#)#{#return#implementationURL#;#}##String#getImplementationVendor#(#)#{#return#implementationVendor#;#}##String#getImplementationVendorID#(#)#{#return#implementationVendorID#;#}##DeweyDecimal#getImplementationVersion#(#)#{#return#implementationVersion#;#}##Compatibility#getCompatibilityWith#(#final#Extension#required#)#{#// Extension Name must match#if#(#!#extensionName#.#equals#(#required#.#getExtensionName#(#)#)#)#{#return#INCOMPATIBLE#;#}#// Available specification version must be >= required#final#DeweyDecimal#requiredSpecificationVersion#=#required#.#getSpecificationVersion#(#)#;#if#(#null#!=#requiredSpecificationVersion#)#{#if#(#null#==#specificationVersion#||#!#isCompatible#(#specificationVersion#,#requiredSpecificationVersion#)#)#{#return#REQUIRE_SPECIFICATION_UPGRADE#;#}#}#// Implementation Vendor ID must match#final#String#requiredImplementationVendorID#=#required#.#getImplementationVendorID#(#)#;#if#(#null#!=#requiredImplementationVendorID#)#{#if#(#null#==#implementationVendorID#||#!#implementationVendorID#.#equals#(#requiredImplementationVendorID#)#)#{#return#REQUIRE_VENDOR_SWITCH#;#}#}#// Implementation version must be >= required#final#DeweyDecimal#requiredImplementationVersion#=#required#.#getImplementationVersion#(#)#;#if#(#null#!=#requiredImplementationVersion#)#{#if#(#null#==#implementationVersion#||#!#isCompatible#(#implementationVersion#,#requiredImplementationVersion#)#)#{#return#REQUIRE_IMPLEMENTATION_UPGRADE#;#}#}#// This available optional package satisfies the requirements#return#COMPATIBLE#;#}##boolean#isCompatibleWith#(#final#Extension#required#)#{#return#(#COMPATIBLE#==#getCompatibilityWith#(#required#)#)#;#}##String#toString#(#)#{#final#String#brace#=#": "#;#final#StringBuffer#sb#=#new#StringBuffer#(#EXTENSION_NAME#.#toString#(#)#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#extensionName#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#if#(#null#!=#specificationVersion#)#{#sb#.#append#(#SPECIFICATION_VERSION#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#specificationVersion#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#}#if#(#null#!=#specificationVendor#)#{#sb#.#append#(#SPECIFICATION_VENDOR#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#specificationVendor#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#}#if#(#null#!=#implementationVersion#)#{#sb#.#append#(#IMPLEMENTATION_VERSION#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#implementationVersion#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#}#if#(#null#!=#implementationVendorID#)#{#sb#.#append#(#IMPLEMENTATION_VENDOR_ID#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#implementationVendorID#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#}#if#(#null#!=#implementationVendor#)#{#sb#.#append#(#IMPLEMENTATION_VENDOR#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#implementationVendor#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#}#if#(#null#!=#implementationURL#)#{#sb#.#append#(#IMPLEMENTATION_URL#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#implementationURL#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#}#return#sb#.#toString#(#)#;#}##boolean#isCompatible#(#final#DeweyDecimal#first#,#final#DeweyDecimal#second#)#{#return#first#.#isGreaterThanOrEqual#(#second#)#;#}##Extension#[#]#getListed#(#final#Manifest#manifest#,#final#Attributes#.#Name#listKey#)#{#final#ArrayList#results#=#new#ArrayList#(#)#;#final#Attributes#mainAttributes#=#manifest#.#getMainAttributes#(#)#;#if#(#null#!=#mainAttributes#)#{#getExtension#(#mainAttributes#,#results#,#listKey#)#;#}#final#Map#entries#=#manifest#.#getEntries#(#)#;#final#Iterator#keys#=#entries#.#keySet#(#)#.#iterator#(#)#;#while#(#keys#.#hasNext#(#)#)#{#final#String#key#=#(#String#)#keys#.#next#(#)#;#final#Attributes#attributes#=#(#Attributes#)#entries#.#get#(#key#)#;#getExtension#(#attributes#,#results#,#listKey#)#;#}#return#(#Extension#[#]#)#results#.#toArray#(#new#Extension#[#results#.#size#(#)#]#)#;#}##void#getExtension#(#final#Attributes#attributes#,#final#ArrayList#required#,#final#Attributes#.#Name#listKey#)#{#final#String#names#=#attributes#.#getValue#(#listKey#)#;#if#(#null#==#names#)#{#return#;#}#final#String#[#]#extentions#=#split#(#names#,#" "#)#;#for#(#int#i#=#0#;#i#<#extentions#.#length#;#i#++#)#{#final#String#prefix#=#extentions#[#i#]#+#"-"#;#final#Extension#extension#=#getExtension#(#prefix#,#attributes#)#;#if#(#null#!=#extension#)#{#required#.#add#(#extension#)#;#}#}#}##String#[#]#split#(#final#String#string#,#final#String#onToken#)#{#final#StringTokenizer#tokenizer#=#new#StringTokenizer#(#string#,#onToken#)#;#final#String#[#]#result#=#new#String#[#tokenizer#.#countTokens#(#)#]#;#for#(#int#i#=#0#;#i#<#result#.#length#;#i#++#)#{#result#[#i#]#=#tokenizer#.#nextToken#(#)#;#}#return#result#;#}##Extension#getExtension#(#final#String#prefix#,#final#Attributes#attributes#)#{#//WARNING: We trim the values of all the attributes because#//Some extension declarations are badly defined (ie have spaces#//after version or vendorID)#final#String#nameKey#=#prefix#+#EXTENSION_NAME#;#final#String#name#=#getTrimmedString#(#attributes#.#getValue#(#nameKey#)#)#;#if#(#null#==#name#)#{#return#null#;#}#final#String#specVendorKey#=#prefix#+#SPECIFICATION_VENDOR#;#final#String#specVendor#=#getTrimmedString#(#attributes#.#getValue#(#specVendorKey#)#)#;#final#String#specVersionKey#=#prefix#+#SPECIFICATION_VERSION#;#final#String#specVersion#=#getTrimmedString#(#attributes#.#getValue#(#specVersionKey#)#)#;#final#String#impVersionKey#=#prefix#+#IMPLEMENTATION_VERSION#;#final#String#impVersion#=#getTrimmedString#(#attributes#.#getValue#(#impVersionKey#)#)#;#final#String#impVendorKey#=#prefix#+#IMPLEMENTATION_VENDOR#;#final#String#impVendor#=#getTrimmedString#(#attributes#.#getValue#(#impVendorKey#)#)#;#final#String#impVendorIDKey#=#prefix#+#IMPLEMENTATION_VENDOR_ID#;#final#String#impVendorId#=#getTrimmedString#(#attributes#.#getValue#(#impVendorIDKey#)#)#;#final#String#impURLKey#=#prefix#+#IMPLEMENTATION_URL#;#final#String#impURL#=#getTrimmedString#(#attributes#.#getValue#(#impURLKey#)#)#;#return#new#Extension#(#name#,#specVersion#,#specVendor#,#impVersion#,#impVendor#,#impVendorId#,#impURL#)#;#}##String#getTrimmedString#(#final#String#value#)#{#return#null#==#value#?#null#:#value#.#trim#(#)#;#}##