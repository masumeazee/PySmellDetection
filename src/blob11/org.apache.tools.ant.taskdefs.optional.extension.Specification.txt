Specification#[#]#getSpecifications#(#final#Manifest#manifest#)#throws#ParseException#{#if#(#null#==#manifest#)#{#return#new#Specification#[#0#]#;#}#final#ArrayList#results#=#new#ArrayList#(#)#;#final#Map#entries#=#manifest#.#getEntries#(#)#;#final#Iterator#keys#=#entries#.#keySet#(#)#.#iterator#(#)#;#while#(#keys#.#hasNext#(#)#)#{#final#String#key#=#(#String#)#keys#.#next#(#)#;#final#Attributes#attributes#=#(#Attributes#)#entries#.#get#(#key#)#;#final#Specification#specification#=#getSpecification#(#key#,#attributes#)#;#if#(#null#!=#specification#)#{#results#.#add#(#specification#)#;#}#}#final#ArrayList#trimmedResults#=#removeDuplicates#(#results#)#;#return#(#Specification#[#]#)#trimmedResults#.#toArray#(#new#Specification#[#trimmedResults#.#size#(#)#]#)#;#}##String#getSpecificationTitle#(#)#{#return#specificationTitle#;#}##String#getSpecificationVendor#(#)#{#return#specificationVendor#;#}##String#getImplementationTitle#(#)#{#return#implementationTitle#;#}##DeweyDecimal#getSpecificationVersion#(#)#{#return#specificationVersion#;#}##String#getImplementationVendor#(#)#{#return#implementationVendor#;#}##String#getImplementationVersion#(#)#{#return#implementationVersion#;#}##String#[#]#getSections#(#)#{#if#(#null#==#sections#)#{#return#null#;#}#final#String#[#]#newSections#=#new#String#[#sections#.#length#]#;#System#.#arraycopy#(#sections#,#0#,#newSections#,#0#,#sections#.#length#)#;#return#newSections#;#}##Compatibility#getCompatibilityWith#(#final#Specification#other#)#{#// Specification Name must match#if#(#!#specificationTitle#.#equals#(#other#.#getSpecificationTitle#(#)#)#)#{#return#INCOMPATIBLE#;#}#// Available specification version must be >= required#final#DeweyDecimal#otherSpecificationVersion#=#other#.#getSpecificationVersion#(#)#;#if#(#null#!=#specificationVersion#)#{#if#(#null#==#otherSpecificationVersion#||#!#isCompatible#(#specificationVersion#,#otherSpecificationVersion#)#)#{#return#REQUIRE_SPECIFICATION_UPGRADE#;#}#}#// Implementation Vendor ID must match#final#String#otherImplementationVendor#=#other#.#getImplementationVendor#(#)#;#if#(#null#!=#implementationVendor#)#{#if#(#null#==#otherImplementationVendor#||#!#implementationVendor#.#equals#(#otherImplementationVendor#)#)#{#return#REQUIRE_VENDOR_SWITCH#;#}#}#// Implementation version must be >= required#final#String#otherImplementationVersion#=#other#.#getImplementationVersion#(#)#;#if#(#null#!=#implementationVersion#)#{#if#(#null#==#otherImplementationVersion#||#!#implementationVersion#.#equals#(#otherImplementationVersion#)#)#{#return#REQUIRE_IMPLEMENTATION_CHANGE#;#}#}#// This available optional package satisfies the requirements#return#COMPATIBLE#;#}##boolean#isCompatibleWith#(#final#Specification#other#)#{#return#(#COMPATIBLE#==#getCompatibilityWith#(#other#)#)#;#}##String#toString#(#)#{#final#String#brace#=#": "#;#final#StringBuffer#sb#=#new#StringBuffer#(#SPECIFICATION_TITLE#.#toString#(#)#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#specificationTitle#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#if#(#null#!=#specificationVersion#)#{#sb#.#append#(#SPECIFICATION_VERSION#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#specificationVersion#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#}#if#(#null#!=#specificationVendor#)#{#sb#.#append#(#SPECIFICATION_VENDOR#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#specificationVendor#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#}#if#(#null#!=#implementationTitle#)#{#sb#.#append#(#IMPLEMENTATION_TITLE#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#implementationTitle#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#}#if#(#null#!=#implementationVersion#)#{#sb#.#append#(#IMPLEMENTATION_VERSION#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#implementationVersion#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#}#if#(#null#!=#implementationVendor#)#{#sb#.#append#(#IMPLEMENTATION_VENDOR#)#;#sb#.#append#(#brace#)#;#sb#.#append#(#implementationVendor#)#;#sb#.#append#(#StringUtils#.#LINE_SEP#)#;#}#return#sb#.#toString#(#)#;#}##boolean#isCompatible#(#final#DeweyDecimal#first#,#final#DeweyDecimal#second#)#{#return#first#.#isGreaterThanOrEqual#(#second#)#;#}##ArrayList#removeDuplicates#(#final#ArrayList#list#)#{#final#ArrayList#results#=#new#ArrayList#(#)#;#final#ArrayList#sections#=#new#ArrayList#(#)#;#while#(#list#.#size#(#)#>#0#)#{#final#Specification#specification#=#(#Specification#)#list#.#remove#(#0#)#;#final#Iterator#iterator#=#list#.#iterator#(#)#;#while#(#iterator#.#hasNext#(#)#)#{#final#Specification#other#=#(#Specification#)#iterator#.#next#(#)#;#if#(#isEqual#(#specification#,#other#)#)#{#final#String#[#]#otherSections#=#other#.#getSections#(#)#;#if#(#null#!=#otherSections#)#{#sections#.#addAll#(#Arrays#.#asList#(#otherSections#)#)#;#}#iterator#.#remove#(#)#;#}#}#final#Specification#merged#=#mergeInSections#(#specification#,#sections#)#;#results#.#add#(#merged#)#;#//Reset list of sections#sections#.#clear#(#)#;#}#return#results#;#}##boolean#isEqual#(#final#Specification#specification#,#final#Specification#other#)#{#return#specification#.#getSpecificationTitle#(#)#.#equals#(#other#.#getSpecificationTitle#(#)#)#&&#specification#.#getSpecificationVersion#(#)#.#isEqual#(#other#.#getSpecificationVersion#(#)#)#&&#specification#.#getSpecificationVendor#(#)#.#equals#(#other#.#getSpecificationVendor#(#)#)#&&#specification#.#getImplementationTitle#(#)#.#equals#(#other#.#getImplementationTitle#(#)#)#&&#specification#.#getImplementationVersion#(#)#.#equals#(#other#.#getImplementationVersion#(#)#)#&&#specification#.#getImplementationVendor#(#)#.#equals#(#other#.#getImplementationVendor#(#)#)#;#}##Specification#mergeInSections#(#final#Specification#specification#,#final#ArrayList#sectionsToAdd#)#{#if#(#0#==#sectionsToAdd#.#size#(#)#)#{#return#specification#;#}#sectionsToAdd#.#addAll#(#Arrays#.#asList#(#specification#.#getSections#(#)#)#)#;#final#String#[#]#sections#=#(#String#[#]#)#sectionsToAdd#.#toArray#(#new#String#[#sectionsToAdd#.#size#(#)#]#)#;#return#new#Specification#(#specification#.#getSpecificationTitle#(#)#,#specification#.#getSpecificationVersion#(#)#.#toString#(#)#,#specification#.#getSpecificationVendor#(#)#,#specification#.#getImplementationTitle#(#)#,#specification#.#getImplementationVersion#(#)#,#specification#.#getImplementationVendor#(#)#,#sections#)#;#}##String#getTrimmedString#(#final#String#value#)#{#return#value#==#null#?#null#:#value#.#trim#(#)#;#}##Specification#getSpecification#(#final#String#section#,#final#Attributes#attributes#)#throws#ParseException#{#//WARNING: We trim the values of all the attributes because#//Some extension declarations are badly defined (ie have spaces#//after version or vendor)#final#String#name#=#getTrimmedString#(#attributes#.#getValue#(#SPECIFICATION_TITLE#)#)#;#if#(#null#==#name#)#{#return#null#;#}#final#String#specVendor#=#getTrimmedString#(#attributes#.#getValue#(#SPECIFICATION_VENDOR#)#)#;#if#(#null#==#specVendor#)#{#throw#new#ParseException#(#MISSING#+#SPECIFICATION_VENDOR#,#0#)#;#}#final#String#specVersion#=#getTrimmedString#(#attributes#.#getValue#(#SPECIFICATION_VERSION#)#)#;#if#(#null#==#specVersion#)#{#throw#new#ParseException#(#MISSING#+#SPECIFICATION_VERSION#,#0#)#;#}#final#String#impTitle#=#getTrimmedString#(#attributes#.#getValue#(#IMPLEMENTATION_TITLE#)#)#;#if#(#null#==#impTitle#)#{#throw#new#ParseException#(#MISSING#+#IMPLEMENTATION_TITLE#,#0#)#;#}#final#String#impVersion#=#getTrimmedString#(#attributes#.#getValue#(#IMPLEMENTATION_VERSION#)#)#;#if#(#null#==#impVersion#)#{#throw#new#ParseException#(#MISSING#+#IMPLEMENTATION_VERSION#,#0#)#;#}#final#String#impVendor#=#getTrimmedString#(#attributes#.#getValue#(#IMPLEMENTATION_VENDOR#)#)#;#if#(#null#==#impVendor#)#{#throw#new#ParseException#(#MISSING#+#IMPLEMENTATION_VENDOR#,#0#)#;#}#return#new#Specification#(#name#,#specVersion#,#specVendor#,#impTitle#,#impVersion#,#impVendor#,#new#String#[#]#{#section#}#)#;#}##