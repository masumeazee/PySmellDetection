void#setLookahead#(#int#lookahead#)#{#optionalAttrs#.#put#(#LOOKAHEAD#,#new#Integer#(#lookahead#)#)#;#}##void#setChoiceambiguitycheck#(#int#choiceAmbiguityCheck#)#{#optionalAttrs#.#put#(#CHOICE_AMBIGUITY_CHECK#,#new#Integer#(#choiceAmbiguityCheck#)#)#;#}##void#setOtherambiguityCheck#(#int#otherAmbiguityCheck#)#{#optionalAttrs#.#put#(#OTHER_AMBIGUITY_CHECK#,#new#Integer#(#otherAmbiguityCheck#)#)#;#}##void#setStatic#(#boolean#staticParser#)#{#optionalAttrs#.#put#(#STATIC#,#staticParser#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setDebugparser#(#boolean#debugParser#)#{#optionalAttrs#.#put#(#DEBUG_PARSER#,#debugParser#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setDebuglookahead#(#boolean#debugLookahead#)#{#optionalAttrs#.#put#(#DEBUG_LOOKAHEAD#,#debugLookahead#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setDebugtokenmanager#(#boolean#debugTokenManager#)#{#optionalAttrs#.#put#(#DEBUG_TOKEN_MANAGER#,#debugTokenManager#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setOptimizetokenmanager#(#boolean#optimizeTokenManager#)#{#optionalAttrs#.#put#(#OPTIMIZE_TOKEN_MANAGER#,#optimizeTokenManager#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setErrorreporting#(#boolean#errorReporting#)#{#optionalAttrs#.#put#(#ERROR_REPORTING#,#errorReporting#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setJavaunicodeescape#(#boolean#javaUnicodeEscape#)#{#optionalAttrs#.#put#(#JAVA_UNICODE_ESCAPE#,#javaUnicodeEscape#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setUnicodeinput#(#boolean#unicodeInput#)#{#optionalAttrs#.#put#(#UNICODE_INPUT#,#unicodeInput#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setIgnorecase#(#boolean#ignoreCase#)#{#optionalAttrs#.#put#(#IGNORE_CASE#,#ignoreCase#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setCommontokenaction#(#boolean#commonTokenAction#)#{#optionalAttrs#.#put#(#COMMON_TOKEN_ACTION#,#commonTokenAction#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setUsertokenmanager#(#boolean#userTokenManager#)#{#optionalAttrs#.#put#(#USER_TOKEN_MANAGER#,#userTokenManager#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setUsercharstream#(#boolean#userCharStream#)#{#optionalAttrs#.#put#(#USER_CHAR_STREAM#,#userCharStream#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setBuildparser#(#boolean#buildParser#)#{#optionalAttrs#.#put#(#BUILD_PARSER#,#buildParser#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setBuildtokenmanager#(#boolean#buildTokenManager#)#{#optionalAttrs#.#put#(#BUILD_TOKEN_MANAGER#,#buildTokenManager#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setSanitycheck#(#boolean#sanityCheck#)#{#optionalAttrs#.#put#(#SANITY_CHECK#,#sanityCheck#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setForcelacheck#(#boolean#forceLACheck#)#{#optionalAttrs#.#put#(#FORCE_LA_CHECK#,#forceLACheck#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setCachetokens#(#boolean#cacheTokens#)#{#optionalAttrs#.#put#(#CACHE_TOKENS#,#cacheTokens#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setKeeplinecolumn#(#boolean#keepLineColumn#)#{#optionalAttrs#.#put#(#KEEP_LINE_COLUMN#,#keepLineColumn#?#Boolean#.#TRUE#:#Boolean#.#FALSE#)#;#}##void#setJDKversion#(#String#jdkVersion#)#{#optionalAttrs#.#put#(#JDK_VERSION#,#jdkVersion#)#;#}##void#setOutputdirectory#(#File#outputDirectory#)#{#this#.#outputDirectory#=#outputDirectory#;#}##void#setTarget#(#File#targetFile#)#{#this#.#targetFile#=#targetFile#;#}##void#setJavacchome#(#File#javaccHome#)#{#this#.#javaccHome#=#javaccHome#;#}##void#execute#(#)#throws#BuildException#{#// load command line with optional attributes#Enumeration#iter#=#optionalAttrs#.#keys#(#)#;#while#(#iter#.#hasMoreElements#(#)#)#{#String#name#=#(#String#)#iter#.#nextElement#(#)#;#Object#value#=#optionalAttrs#.#get#(#name#)#;#cmdl#.#createArgument#(#)#.#setValue#(#"-"#+#name#+#":"#+#value#.#toString#(#)#)#;#}#// check the target is a file#if#(#targetFile#==#null#||#!#targetFile#.#isFile#(#)#)#{#throw#new#BuildException#(#"Invalid target: "#+#targetFile#)#;#}#// use the directory containing the target as the output directory#if#(#outputDirectory#==#null#)#{#outputDirectory#=#new#File#(#targetFile#.#getParent#(#)#)#;#}#else#if#(#!#outputDirectory#.#isDirectory#(#)#)#{#throw#new#BuildException#(#"Outputdir not a directory."#)#;#}#cmdl#.#createArgument#(#)#.#setValue#(#"-OUTPUT_DIRECTORY:"#+#outputDirectory#.#getAbsolutePath#(#)#)#;#// determine if the generated java file is up-to-date#final#File#javaFile#=#getOutputJavaFile#(#outputDirectory#,#targetFile#)#;#if#(#javaFile#.#exists#(#)#&&#targetFile#.#lastModified#(#)#<#javaFile#.#lastModified#(#)#)#{#log#(#"Target is already built - skipping ("#+#targetFile#+#")"#,#Project#.#MSG_VERBOSE#)#;#return#;#}#cmdl#.#createArgument#(#)#.#setValue#(#targetFile#.#getAbsolutePath#(#)#)#;#final#Path#classpath#=#cmdl#.#createClasspath#(#getProject#(#)#)#;#final#File#javaccJar#=#JavaCC#.#getArchiveFile#(#javaccHome#)#;#classpath#.#createPathElement#(#)#.#setPath#(#javaccJar#.#getAbsolutePath#(#)#)#;#classpath#.#addJavaRuntime#(#)#;#cmdl#.#setClassname#(#JavaCC#.#getMainClass#(#classpath#,#JavaCC#.#TASKDEF_TYPE_JAVACC#)#)#;#final#Commandline#.#Argument#arg#=#cmdl#.#createVmArgument#(#)#;#arg#.#setValue#(#"-mx140M"#)#;#arg#.#setValue#(#"-Dinstall.root="#+#javaccHome#.#getAbsolutePath#(#)#)#;#Execute#.#runCommand#(#this#,#cmdl#.#getCommandline#(#)#)#;#}##File#getArchiveFile#(#File#home#)#throws#BuildException#{#return#new#File#(#home#,#ARCHIVE_LOCATIONS#[#getArchiveLocationIndex#(#home#)#]#)#;#}##String#getMainClass#(#File#home#,#int#type#)#throws#BuildException#{#Path#p#=#new#Path#(#null#)#;#p#.#createPathElement#(#)#.#setLocation#(#getArchiveFile#(#home#)#)#;#p#.#addJavaRuntime#(#)#;#return#getMainClass#(#p#,#type#)#;#}##String#getMainClass#(#Path#path#,#int#type#)#throws#BuildException#{#String#packagePrefix#=#null#;#String#mainClass#=#null#;#AntClassLoader#l#=#null#;#try#{#l#=#AntClassLoader#.#newAntClassLoader#(#null#,#null#,#path#.#concatSystemClasspath#(#"ignore"#)#,#true#)#;#String#javaccClass#=#COM_PACKAGE#+#COM_JAVACC_CLASS#;#InputStream#is#=#l#.#getResourceAsStream#(#javaccClass#.#replace#(#'.'#,#'/'#)#+#".class"#)#;#if#(#is#!=#null#)#{#packagePrefix#=#COM_PACKAGE#;#switch#(#type#)#{#case#TASKDEF_TYPE_JAVACC#:#mainClass#=#COM_JAVACC_CLASS#;#break#;#case#TASKDEF_TYPE_JJTREE#:#mainClass#=#COM_JJTREE_CLASS#;#break#;#case#TASKDEF_TYPE_JJDOC#:#mainClass#=#COM_JJDOC_CLASS#;#break#;#default#:#// Fall Through#}#}#else#{#javaccClass#=#ORG_PACKAGE_3_1#+#ORG_JAVACC_CLASS#;#is#=#l#.#getResourceAsStream#(#javaccClass#.#replace#(#'.'#,#'/'#)#+#".class"#)#;#if#(#is#!=#null#)#{#packagePrefix#=#ORG_PACKAGE_3_1#;#}#else#{#javaccClass#=#ORG_PACKAGE_3_0#+#ORG_JAVACC_CLASS#;#is#=#l#.#getResourceAsStream#(#javaccClass#.#replace#(#'.'#,#'/'#)#+#".class"#)#;#if#(#is#!=#null#)#{#packagePrefix#=#ORG_PACKAGE_3_0#;#}#}#if#(#is#!=#null#)#{#switch#(#type#)#{#case#TASKDEF_TYPE_JAVACC#:#mainClass#=#ORG_JAVACC_CLASS#;#break#;#case#TASKDEF_TYPE_JJTREE#:#mainClass#=#ORG_JJTREE_CLASS#;#break#;#case#TASKDEF_TYPE_JJDOC#:#mainClass#=#ORG_JJDOC_CLASS#;#break#;#default#:#// Fall Through#}#}#}#if#(#packagePrefix#==#null#)#{#throw#new#BuildException#(#"failed to load JavaCC"#)#;#}#if#(#mainClass#==#null#)#{#throw#new#BuildException#(#"unknown task type "#+#type#)#;#}#return#packagePrefix#+#mainClass#;#}#finally#{#if#(#l#!=#null#)#{#l#.#cleanup#(#)#;#}#}#}##int#getArchiveLocationIndex#(#File#home#)#throws#BuildException#{#if#(#home#==#null#||#!#home#.#isDirectory#(#)#)#{#throw#new#BuildException#(#"JavaCC home must be a valid directory."#)#;#}#for#(#int#i#=#0#;#i#<#ARCHIVE_LOCATIONS#.#length#;#i#++#)#{#File#f#=#new#File#(#home#,#ARCHIVE_LOCATIONS#[#i#]#)#;#if#(#f#.#exists#(#)#)#{#return#i#;#}#}#throw#new#BuildException#(#"Could not find a path to JavaCC.zip "#+#"or javacc.jar from '"#+#home#+#"'."#)#;#}##int#getMajorVersionNumber#(#File#home#)#throws#BuildException#{#return#ARCHIVE_LOCATIONS_VS_MAJOR_VERSION#[#getArchiveLocationIndex#(#home#)#]#;#}##File#getOutputJavaFile#(#File#outputdir#,#File#srcfile#)#{#String#path#=#srcfile#.#getPath#(#)#;#// Extract file's base-name#int#startBasename#=#path#.#lastIndexOf#(#File#.#separator#)#;#if#(#startBasename#!=#-#1#)#{#path#=#path#.#substring#(#startBasename#+#1#)#;#}#// Replace the file's extension with '.java'#int#startExtn#=#path#.#lastIndexOf#(#'.'#)#;#if#(#startExtn#!=#-#1#)#{#path#=#path#.#substring#(#0#,#startExtn#)#+#".java"#;#}#else#{#path#+=#".java"#;#}#// Change the directory#if#(#outputdir#!=#null#)#{#path#=#outputdir#+#File#.#separator#+#path#;#}#return#new#File#(#path#)#;#}##