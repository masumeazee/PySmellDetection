String#getImplementation#(#)#throws#BuildException#{#return#tfactory#.#getClass#(#)#.#getName#(#)#;#}##String#getProcVersion#(#String#classNameImpl#)#throws#BuildException#{#try#{#// xalan 2#if#(#classNameImpl#.#equals#(#APAC#+#"processor.TransformerFactoryImpl"#)#||#classNameImpl#.#equals#(#APAC#+#"xslt.XSLTProcessorFactory"#)#)#{#return#getXalanVersion#(#APAC#+#"processor.XSLProcessorVersion"#)#;#}#// xalan xsltc#if#(#classNameImpl#.#equals#(#APAC#+#"xsltc.trax.TransformerFactoryImpl"#)#)#{#return#getXSLTCVersion#(#APAC#+#"xsltc.ProcessorVersion"#)#;#}#// jdk 1.5 xsltc#if#(#classNameImpl#.#equals#(#SPAC#+#"internal.xsltc.trax.TransformerFactoryImpl"#)#)#{#return#getXSLTCVersion#(#SPAC#+#"internal.xsltc.ProcessorVersion"#)#;#}#throw#new#BuildException#(#"Could not find a valid processor version"#+#" implementation from "#+#classNameImpl#)#;#}#catch#(#ClassNotFoundException#e#)#{#throw#new#BuildException#(#"Could not find processor version "#+#"implementation"#,#e#)#;#}#}##void#execute#(#)#throws#Exception#{#String#systemId#=#caller#.#getStylesheetSystemId#(#)#;#Source#xslSrc#=#new#StreamSource#(#systemId#)#;#Transformer#tformer#=#tfactory#.#newTransformer#(#xslSrc#)#;#Source#xmlSrc#=#new#DOMSource#(#caller#.#document#)#;#OutputStream#os#=#getOutputStream#(#)#;#try#{#tformer#.#setParameter#(#"output.dir"#,#caller#.#toDir#.#getAbsolutePath#(#)#)#;#Result#result#=#new#StreamResult#(#os#)#;#tformer#.#transform#(#xmlSrc#,#result#)#;#}#finally#{#os#.#close#(#)#;#}#}##