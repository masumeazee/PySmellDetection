void#execute#(#)#throws#IOException#,#JSchException#{#ChannelSftp#channel#=#openSftpChannel#(#)#;#try#{#channel#.#connect#(#)#;#try#{#SftpATTRS#attrs#=#channel#.#stat#(#remoteFile#)#;#if#(#attrs#.#isDir#(#)#&&#!#remoteFile#.#endsWith#(#"/"#)#)#{#remoteFile#=#remoteFile#+#"/"#;#}#}#catch#(#SftpException#ee#)#{#// Ignored#}#getDir#(#channel#,#remoteFile#,#localFile#)#;#}#catch#(#SftpException#e#)#{#JSchException#schException#=#new#JSchException#(#"Could not get '"#+#remoteFile#+#"' to '"#+#localFile#+#"' - "#+#e#.#toString#(#)#)#;#schException#.#initCause#(#e#)#;#throw#schException#;#}#finally#{#if#(#channel#!=#null#)#{#channel#.#disconnect#(#)#;#}#}#log#(#"done\n"#)#;#}##void#getDir#(#ChannelSftp#channel#,#String#remoteFile#,#File#localFile#)#throws#IOException#,#SftpException#{#String#pwd#=#remoteFile#;#if#(#remoteFile#.#lastIndexOf#(#'/'#)#!=#-#1#)#{#if#(#remoteFile#.#length#(#)#>#1#)#{#pwd#=#remoteFile#.#substring#(#0#,#remoteFile#.#lastIndexOf#(#'/'#)#)#;#}#}#channel#.#cd#(#pwd#)#;#if#(#!#localFile#.#exists#(#)#)#{#localFile#.#mkdirs#(#)#;#}#java#.#util#.#Vector#files#=#channel#.#ls#(#remoteFile#)#;#for#(#int#i#=#0#;#i#<#files#.#size#(#)#;#i#++#)#{#ChannelSftp#.#LsEntry#le#=#(#ChannelSftp#.#LsEntry#)#files#.#elementAt#(#i#)#;#String#name#=#le#.#getFilename#(#)#;#if#(#le#.#getAttrs#(#)#.#isDir#(#)#)#{#if#(#name#.#equals#(#"."#)#||#name#.#equals#(#".."#)#)#{#continue#;#}#getDir#(#channel#,#channel#.#pwd#(#)#+#"/"#+#name#+#"/"#,#new#File#(#localFile#,#le#.#getFilename#(#)#)#)#;#}#else#{#getFile#(#channel#,#le#,#localFile#)#;#}#}#channel#.#cd#(#".."#)#;#}##void#getFile#(#ChannelSftp#channel#,#ChannelSftp#.#LsEntry#le#,#File#localFile#)#throws#IOException#,#SftpException#{#String#remoteFile#=#le#.#getFilename#(#)#;#if#(#!#localFile#.#exists#(#)#)#{#String#path#=#localFile#.#getAbsolutePath#(#)#;#int#i#=#path#.#lastIndexOf#(#File#.#pathSeparator#)#;#if#(#i#!=#-#1#)#{#if#(#path#.#length#(#)#>#File#.#pathSeparator#.#length#(#)#)#{#new#File#(#path#.#substring#(#0#,#i#)#)#.#mkdirs#(#)#;#}#}#}#if#(#localFile#.#isDirectory#(#)#)#{#localFile#=#new#File#(#localFile#,#remoteFile#)#;#}#long#startTime#=#System#.#currentTimeMillis#(#)#;#long#totalLength#=#le#.#getAttrs#(#)#.#getSize#(#)#;#SftpProgressMonitor#monitor#=#null#;#boolean#trackProgress#=#getVerbose#(#)#&&#totalLength#>#HUNDRED_KILOBYTES#;#if#(#trackProgress#)#{#monitor#=#getProgressMonitor#(#)#;#}#try#{#log#(#"Receiving: "#+#remoteFile#+#" : "#+#le#.#getAttrs#(#)#.#getSize#(#)#)#;#channel#.#get#(#remoteFile#,#localFile#.#getAbsolutePath#(#)#,#monitor#)#;#}#finally#{#long#endTime#=#System#.#currentTimeMillis#(#)#;#logStats#(#startTime#,#endTime#,#(#int#)#totalLength#)#;#}#if#(#getPreserveLastModified#(#)#)#{#FileUtils#.#getFileUtils#(#)#.#setFileLastModified#(#localFile#,#(#(#long#)#le#.#getAttrs#(#)#.#getMTime#(#)#)#*#1000#)#;#}#}##