Commandline#buildCmdLine#(#)#{#Commandline#commandLine#=#new#Commandline#(#)#;#// first off, make sure that we've got a command and a vssdir and a label ...#if#(#getVsspath#(#)#==#null#)#{#String#msg#=#"vsspath attribute must be set!"#;#throw#new#BuildException#(#msg#,#getLocation#(#)#)#;#}#// build the command line from what we got the format is#// ss History elements [-H] [-L] [-N] [-O] [-V] [-Y] [-#] [-?]#// as specified in the SS.EXE help#commandLine#.#setExecutable#(#getSSCommand#(#)#)#;#commandLine#.#createArgument#(#)#.#setValue#(#COMMAND_HISTORY#)#;#// VSS items#commandLine#.#createArgument#(#)#.#setValue#(#getVsspath#(#)#)#;#// -I-#commandLine#.#createArgument#(#)#.#setValue#(#FLAG_AUTORESPONSE_DEF#)#;#// ignore all errors#// -Vd#commandLine#.#createArgument#(#)#.#setValue#(#getVersionDate#(#)#)#;#// -VL#commandLine#.#createArgument#(#)#.#setValue#(#getVersionLabel#(#)#)#;#// -R#commandLine#.#createArgument#(#)#.#setValue#(#getRecursive#(#)#)#;#// -B / -D / -F-#commandLine#.#createArgument#(#)#.#setValue#(#getStyle#(#)#)#;#// -Y#commandLine#.#createArgument#(#)#.#setValue#(#getLogin#(#)#)#;#// -O#commandLine#.#createArgument#(#)#.#setValue#(#getOutput#(#)#)#;#return#commandLine#;#}##void#setRecursive#(#boolean#recursive#)#{#super#.#setInternalRecursive#(#recursive#)#;#}##void#setUser#(#String#user#)#{#super#.#setInternalUser#(#user#)#;#}##void#setFromDate#(#String#fromDate#)#{#super#.#setInternalFromDate#(#fromDate#)#;#}##void#setToDate#(#String#toDate#)#{#super#.#setInternalToDate#(#toDate#)#;#}##void#setFromLabel#(#String#fromLabel#)#{#super#.#setInternalFromLabel#(#fromLabel#)#;#}##void#setToLabel#(#String#toLabel#)#{#super#.#setInternalToLabel#(#toLabel#)#;#}##void#setNumdays#(#int#numd#)#{#super#.#setInternalNumDays#(#numd#)#;#}##void#setOutput#(#File#outfile#)#{#if#(#outfile#!=#null#)#{#super#.#setInternalOutputFilename#(#outfile#.#getAbsolutePath#(#)#)#;#}#}##void#setDateFormat#(#String#dateFormat#)#{#super#.#setInternalDateFormat#(#new#SimpleDateFormat#(#dateFormat#)#)#;#}##void#setStyle#(#BriefCodediffNofile#attr#)#{#String#option#=#attr#.#getValue#(#)#;#if#(#option#.#equals#(#STYLE_BRIEF#)#)#{#super#.#setInternalStyle#(#FLAG_BRIEF#)#;#}#else#if#(#option#.#equals#(#STYLE_CODEDIFF#)#)#{#super#.#setInternalStyle#(#FLAG_CODEDIFF#)#;#}#else#if#(#option#.#equals#(#STYLE_DEFAULT#)#)#{#super#.#setInternalStyle#(#""#)#;#}#else#if#(#option#.#equals#(#STYLE_NOFILE#)#)#{#super#.#setInternalStyle#(#FLAG_NO_FILE#)#;#}#else#{#throw#new#BuildException#(#"Style "#+#attr#+#" unknown."#,#getLocation#(#)#)#;#}#}##String#[#]#getValues#(#)#{#return#new#String#[#]#{#STYLE_BRIEF#,#STYLE_CODEDIFF#,#STYLE_NOFILE#,#STYLE_DEFAULT#}#;#}##