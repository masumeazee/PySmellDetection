void#setLocation#(#File#loc#)#{#parts#=#new#String#[#]#{#translateFile#(#loc#.#getAbsolutePath#(#)#)#}#;#}##void#setPath#(#String#path#)#{#parts#=#Path#.#translatePath#(#getProject#(#)#,#path#)#;#}##String#[#]#getParts#(#)#{#return#parts#;#}##Iterator#iterator#(#)#{#return#new#FileResourceIterator#(#getProject#(#)#,#null#,#parts#)#;#}##boolean#isFilesystemOnly#(#)#{#return#true#;#}##int#size#(#)#{#return#parts#==#null#?#0#:#parts#.#length#;#}##void#setLocation#(#File#location#)#throws#BuildException#{#checkAttributesAllowed#(#)#;#createPathElement#(#)#.#setLocation#(#location#)#;#}##void#setPath#(#String#path#)#throws#BuildException#{#checkAttributesAllowed#(#)#;#createPathElement#(#)#.#setPath#(#path#)#;#}##void#setRefid#(#Reference#r#)#throws#BuildException#{#if#(#union#!=#null#)#{#throw#tooManyAttributes#(#)#;#}#super#.#setRefid#(#r#)#;#}##PathElement#createPathElement#(#)#throws#BuildException#{#if#(#isReference#(#)#)#{#throw#noChildrenAllowed#(#)#;#}#PathElement#pe#=#new#PathElement#(#)#;#add#(#pe#)#;#return#pe#;#}##void#addFileset#(#FileSet#fs#)#throws#BuildException#{#if#(#fs#.#getProject#(#)#==#null#)#{#fs#.#setProject#(#getProject#(#)#)#;#}#add#(#fs#)#;#}##void#addFilelist#(#FileList#fl#)#throws#BuildException#{#if#(#fl#.#getProject#(#)#==#null#)#{#fl#.#setProject#(#getProject#(#)#)#;#}#add#(#fl#)#;#}##void#addDirset#(#DirSet#dset#)#throws#BuildException#{#if#(#dset#.#getProject#(#)#==#null#)#{#dset#.#setProject#(#getProject#(#)#)#;#}#add#(#dset#)#;#}##void#add#(#Path#path#)#throws#BuildException#{#if#(#path#==#this#)#{#throw#circularReference#(#)#;#}#if#(#path#.#getProject#(#)#==#null#)#{#path#.#setProject#(#getProject#(#)#)#;#}#add#(#(#ResourceCollection#)#path#)#;#}##void#add#(#ResourceCollection#c#)#{#checkChildrenAllowed#(#)#;#if#(#c#==#null#)#{#return#;#}#if#(#union#==#null#)#{#union#=#new#Union#(#)#;#union#.#setProject#(#getProject#(#)#)#;#union#.#setCache#(#cache#)#;#}#union#.#add#(#c#)#;#setChecked#(#false#)#;#}##Path#createPath#(#)#throws#BuildException#{#Path#p#=#new#Path#(#getProject#(#)#)#;#add#(#p#)#;#return#p#;#}##void#append#(#Path#other#)#{#if#(#other#==#null#)#{#return#;#}#add#(#other#)#;#}##void#addExisting#(#Path#source#)#{#addExisting#(#source#,#false#)#;#}##void#addExisting#(#Path#source#,#boolean#tryUserDir#)#{#String#[#]#list#=#source#.#list#(#)#;#File#userDir#=#(#tryUserDir#)#?#new#File#(#System#.#getProperty#(#"user.dir"#)#)#:#null#;#for#(#int#i#=#0#;#i#<#list#.#length#;#i#++#)#{#File#f#=#resolveFile#(#getProject#(#)#,#list#[#i#]#)#;#// probably not the best choice, but it solves the problem of#// relative paths in CLASSPATH#if#(#tryUserDir#&&#!#f#.#exists#(#)#)#{#f#=#new#File#(#userDir#,#list#[#i#]#)#;#}#if#(#f#.#exists#(#)#)#{#setLocation#(#f#)#;#}#else#{#log#(#"dropping "#+#f#+#" from path as it doesn't exist"#,#Project#.#MSG_VERBOSE#)#;#}#}#}##void#setCache#(#boolean#b#)#{#checkAttributesAllowed#(#)#;#cache#=#b#;#if#(#union#!=#null#)#{#union#.#setCache#(#b#)#;#}#}##String#[#]#list#(#)#{#if#(#isReference#(#)#)#{#return#(#(#Path#)#getCheckedRef#(#)#)#.#list#(#)#;#}#return#assertFilesystemOnly#(#union#)#==#null#?#new#String#[#0#]#:#union#.#list#(#)#;#}##String#toString#(#)#{#return#isReference#(#)#?#getCheckedRef#(#)#.#toString#(#)#:#union#==#null#?#""#:#union#.#toString#(#)#;#}##String#[#]#translatePath#(#Project#project#,#String#source#)#{#final#Vector#result#=#new#Vector#(#)#;#if#(#source#==#null#)#{#return#new#String#[#0#]#;#}#PathTokenizer#tok#=#new#PathTokenizer#(#source#)#;#StringBuffer#element#=#new#StringBuffer#(#)#;#while#(#tok#.#hasMoreTokens#(#)#)#{#String#pathElement#=#tok#.#nextToken#(#)#;#try#{#element#.#append#(#resolveFile#(#project#,#pathElement#)#.#getPath#(#)#)#;#}#catch#(#BuildException#e#)#{#project#.#log#(#"Dropping path element "#+#pathElement#+#" as it is not valid relative to the project"#,#Project#.#MSG_VERBOSE#)#;#}#for#(#int#i#=#0#;#i#<#element#.#length#(#)#;#i#++#)#{#translateFileSep#(#element#,#i#)#;#}#result#.#addElement#(#element#.#toString#(#)#)#;#element#=#new#StringBuffer#(#)#;#}#String#[#]#res#=#new#String#[#result#.#size#(#)#]#;#result#.#copyInto#(#res#)#;#return#res#;#}##String#translateFile#(#String#source#)#{#if#(#source#==#null#)#{#return#""#;#}#final#StringBuffer#result#=#new#StringBuffer#(#source#)#;#for#(#int#i#=#0#;#i#<#result#.#length#(#)#;#i#++#)#{#translateFileSep#(#result#,#i#)#;#}#return#result#.#toString#(#)#;#}##boolean#translateFileSep#(#StringBuffer#buffer#,#int#pos#)#{#if#(#buffer#.#charAt#(#pos#)#==#'/'#||#buffer#.#charAt#(#pos#)#==#'\\'#)#{#buffer#.#setCharAt#(#pos#,#File#.#separatorChar#)#;#return#true#;#}#return#false#;#}##int#size#(#)#{#if#(#isReference#(#)#)#{#return#(#(#Path#)#getCheckedRef#(#)#)#.#size#(#)#;#}#dieOnCircularReference#(#)#;#return#union#==#null#?#0#:#assertFilesystemOnly#(#union#)#.#size#(#)#;#}##Object#clone#(#)#{#try#{#Path#result#=#(#Path#)#super#.#clone#(#)#;#result#.#union#=#union#==#null#?#union#:#(#Union#)#union#.#clone#(#)#;#return#result#;#}#catch#(#CloneNotSupportedException#e#)#{#throw#new#BuildException#(#e#)#;#}#}##void#dieOnCircularReference#(#Stack#stk#,#Project#p#)#throws#BuildException#{#if#(#isChecked#(#)#)#{#return#;#}#if#(#isReference#(#)#)#{#super#.#dieOnCircularReference#(#stk#,#p#)#;#}#else#{#if#(#union#!=#null#)#{#pushAndInvokeCircularReferenceCheck#(#union#,#stk#,#p#)#;#}#setChecked#(#true#)#;#}#}##File#resolveFile#(#Project#project#,#String#relativeName#)#{#return#FileUtils#.#getFileUtils#(#)#.#resolveFile#(#(#project#==#null#)#?#null#:#project#.#getBaseDir#(#)#,#relativeName#)#;#}##Path#concatSystemClasspath#(#)#{#return#concatSystemClasspath#(#"last"#)#;#}##Path#concatSystemClasspath#(#String#defValue#)#{#return#concatSpecialPath#(#defValue#,#Path#.#systemClasspath#)#;#}##Path#concatSystemBootClasspath#(#String#defValue#)#{#return#concatSpecialPath#(#defValue#,#Path#.#systemBootClasspath#)#;#}##Path#concatSpecialPath#(#String#defValue#,#Path#p#)#{#Path#result#=#new#Path#(#getProject#(#)#)#;#String#order#=#defValue#;#if#(#getProject#(#)#!=#null#)#{#String#o#=#getProject#(#)#.#getProperty#(#"build.sysclasspath"#)#;#if#(#o#!=#null#)#{#order#=#o#;#}#}#if#(#order#.#equals#(#"only"#)#)#{#// only: the developer knows what (s)he is doing#result#.#addExisting#(#p#,#true#)#;#}#else#if#(#order#.#equals#(#"first"#)#)#{#// first: developer could use a little help#result#.#addExisting#(#p#,#true#)#;#result#.#addExisting#(#this#)#;#}#else#if#(#order#.#equals#(#"ignore"#)#)#{#// ignore: don't trust anyone#result#.#addExisting#(#this#)#;#}#else#{#// last: don't trust the developer#if#(#!#order#.#equals#(#"last"#)#)#{#log#(#"invalid value for build.sysclasspath: "#+#order#,#Project#.#MSG_WARN#)#;#}#result#.#addExisting#(#this#)#;#result#.#addExisting#(#p#,#true#)#;#}#return#result#;#}##void#addJavaRuntime#(#)#{#if#(#JavaEnvUtils#.#isKaffe#(#)#)#{#// newer versions of Kaffe (1.1.1+) won't have this,#// but this will be sorted by FileSet anyway.#File#kaffeShare#=#new#File#(#System#.#getProperty#(#"java.home"#)#+#File#.#separator#+#"share"#+#File#.#separator#+#"kaffe"#)#;#if#(#kaffeShare#.#isDirectory#(#)#)#{#FileSet#kaffeJarFiles#=#new#FileSet#(#)#;#kaffeJarFiles#.#setDir#(#kaffeShare#)#;#kaffeJarFiles#.#setIncludes#(#"*.jar"#)#;#addFileset#(#kaffeJarFiles#)#;#}#}#else#if#(#"GNU libgcj"#.#equals#(#System#.#getProperty#(#"java.vm.name"#)#)#)#{#addExisting#(#systemBootClasspath#)#;#}#if#(#System#.#getProperty#(#"java.vendor"#)#.#toLowerCase#(#Locale#.#US#)#.#indexOf#(#"microsoft"#)#>=#0#)#{#// XXX is this code still necessary? is there any 1.2+ port?#// Pull in *.zip from packages directory#FileSet#msZipFiles#=#new#FileSet#(#)#;#msZipFiles#.#setDir#(#new#File#(#System#.#getProperty#(#"java.home"#)#+#File#.#separator#+#"Packages"#)#)#;#msZipFiles#.#setIncludes#(#"*.ZIP"#)#;#addFileset#(#msZipFiles#)#;#}#else#{#// JDK 1.2+ seems to set java.home to the JRE directory.#addExisting#(#new#Path#(#null#,#System#.#getProperty#(#"java.home"#)#+#File#.#separator#+#"lib"#+#File#.#separator#+#"rt.jar"#)#)#;#// Just keep the old version as well and let addExisting#// sort it out.#addExisting#(#new#Path#(#null#,#System#.#getProperty#(#"java.home"#)#+#File#.#separator#+#"jre"#+#File#.#separator#+#"lib"#+#File#.#separator#+#"rt.jar"#)#)#;#// Sun's and Apple's 1.4 have JCE and JSSE in separate jars.#String#[#]#secJars#=#{#"jce"#,#"jsse"#}#;#for#(#int#i#=#0#;#i#<#secJars#.#length#;#i#++#)#{#addExisting#(#new#Path#(#null#,#System#.#getProperty#(#"java.home"#)#+#File#.#separator#+#"lib"#+#File#.#separator#+#secJars#[#i#]#+#".jar"#)#)#;#addExisting#(#new#Path#(#null#,#System#.#getProperty#(#"java.home"#)#+#File#.#separator#+#".."#+#File#.#separator#+#"Classes"#+#File#.#separator#+#secJars#[#i#]#+#".jar"#)#)#;#}#// IBM's 1.4 has rt.jar split into 4 smaller jars and a combined#// JCE/JSSE in security.jar.#String#[#]#ibmJars#=#{#"core"#,#"graphics"#,#"security"#,#"server"#,#"xml"#}#;#for#(#int#i#=#0#;#i#<#ibmJars#.#length#;#i#++#)#{#addExisting#(#new#Path#(#null#,#System#.#getProperty#(#"java.home"#)#+#File#.#separator#+#"lib"#+#File#.#separator#+#ibmJars#[#i#]#+#".jar"#)#)#;#}#// Added for MacOS X#addExisting#(#new#Path#(#null#,#System#.#getProperty#(#"java.home"#)#+#File#.#separator#+#".."#+#File#.#separator#+#"Classes"#+#File#.#separator#+#"classes.jar"#)#)#;#addExisting#(#new#Path#(#null#,#System#.#getProperty#(#"java.home"#)#+#File#.#separator#+#".."#+#File#.#separator#+#"Classes"#+#File#.#separator#+#"ui.jar"#)#)#;#}#}##void#addExtdirs#(#Path#extdirs#)#{#if#(#extdirs#==#null#)#{#String#extProp#=#System#.#getProperty#(#"java.ext.dirs"#)#;#if#(#extProp#!=#null#)#{#extdirs#=#new#Path#(#getProject#(#)#,#extProp#)#;#}#else#{#return#;#}#}#String#[#]#dirs#=#extdirs#.#list#(#)#;#for#(#int#i#=#0#;#i#<#dirs#.#length#;#i#++#)#{#File#dir#=#resolveFile#(#getProject#(#)#,#dirs#[#i#]#)#;#if#(#dir#.#exists#(#)#&&#dir#.#isDirectory#(#)#)#{#FileSet#fs#=#new#FileSet#(#)#;#fs#.#setDir#(#dir#)#;#fs#.#setIncludes#(#"*"#)#;#addFileset#(#fs#)#;#}#}#}##Iterator#iterator#(#)#{#if#(#isReference#(#)#)#{#return#(#(#Path#)#getCheckedRef#(#)#)#.#iterator#(#)#;#}#dieOnCircularReference#(#)#;#if#(#getPreserveBC#(#)#)#{#return#new#FileResourceIterator#(#getProject#(#)#,#null#,#list#(#)#)#;#}#return#union#==#null#?#EMPTY_ITERATOR#:#assertFilesystemOnly#(#union#)#.#iterator#(#)#;#}##boolean#isFilesystemOnly#(#)#{#if#(#isReference#(#)#)#{#return#(#(#Path#)#getCheckedRef#(#)#)#.#isFilesystemOnly#(#)#;#}#dieOnCircularReference#(#)#;#assertFilesystemOnly#(#union#)#;#return#true#;#}##ResourceCollection#assertFilesystemOnly#(#ResourceCollection#rc#)#{#if#(#rc#!=#null#&&#!#(#rc#.#isFilesystemOnly#(#)#)#)#{#throw#new#BuildException#(#getDataTypeName#(#)#+#" allows only filesystem resources."#)#;#}#return#rc#;#}##boolean#delegateIteratorToList#(#)#{#if#(#getClass#(#)#.#equals#(#Path#.#class#)#)#{#return#false#;#}#try#{#Method#listMethod#=#getClass#(#)#.#getMethod#(#"list"#,#(#Class#[#]#)#null#)#;#return#!#listMethod#.#getDeclaringClass#(#)#.#equals#(#Path#.#class#)#;#}#catch#(#Exception#e#)#{#//shouldn't happen, but#return#false#;#}#}##boolean#getPreserveBC#(#)#{#if#(#preserveBC#==#null#)#{#preserveBC#=#delegateIteratorToList#(#)#?#Boolean#.#TRUE#:#Boolean#.#FALSE#;#}#return#preserveBC#.#booleanValue#(#)#;#}##