void#setTargetdir#(#File#targetdir#)#{#this#.#targetdir#=#targetdir#;#}##Mapper#createMapper#(#)#throws#BuildException#{#if#(#map#!=#null#||#mapperElement#!=#null#)#{#throw#new#BuildException#(#"Cannot define more than one mapper"#)#;#}#mapperElement#=#new#Mapper#(#getProject#(#)#)#;#return#mapperElement#;#}##void#addConfigured#(#FileNameMapper#fileNameMapper#)#{#if#(#map#!=#null#||#mapperElement#!=#null#)#{#throw#new#BuildException#(#"Cannot define more than one mapper"#)#;#}#this#.#map#=#fileNameMapper#;#}##void#verifySettings#(#)#{#if#(#targetdir#==#null#)#{#setError#(#"The targetdir attribute is required."#)#;#}#if#(#map#==#null#)#{#if#(#mapperElement#==#null#)#{#map#=#new#IdentityMapper#(#)#;#}#else#{#map#=#mapperElement#.#getImplementation#(#)#;#if#(#map#==#null#)#{#setError#(#"Could not set <mapper> element."#)#;#}#}#}#}##boolean#isSelected#(#File#basedir#,#String#filename#,#File#file#)#{#// throw BuildException on error#validate#(#)#;#// Determine file whose out-of-dateness is to be checked#String#[#]#destfiles#=#map#.#mapFileName#(#filename#)#;#// If filename does not match the To attribute of the mapper#// then filter it out of the files we are considering#if#(#destfiles#==#null#)#{#return#false#;#}#// Sanity check#if#(#destfiles#.#length#!=#1#||#destfiles#[#0#]#==#null#)#{#throw#new#BuildException#(#"Invalid destination file results for "#+#targetdir#.#getName#(#)#+#" with filename "#+#filename#)#;#}#String#destname#=#destfiles#[#0#]#;#File#destfile#=#FILE_UTILS#.#resolveFile#(#targetdir#,#destname#)#;#boolean#selected#=#selectionTest#(#file#,#destfile#)#;#return#selected#;#}##boolean#selectionTest#(#File#srcfile#,#File#destfile#)#;##void#setGranularity#(#int#granularity#)#{#this#.#granularity#=#granularity#;#}##