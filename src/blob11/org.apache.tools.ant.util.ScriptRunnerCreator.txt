ScriptRunnerBase#createRunner#(#String#manager#,#String#language#,#ClassLoader#classLoader#)#{#this#.#manager#=#manager#;#this#.#language#=#language#;#this#.#scriptLoader#=#classLoader#;#if#(#language#==#null#)#{#throw#new#BuildException#(#"script language must be specified"#)#;#}#if#(#!#manager#.#equals#(#AUTO#)#&&#!#manager#.#equals#(#JAVAX#)#&&#!#manager#.#equals#(#BSF#)#)#{#throw#new#BuildException#(#"Unsupported language prefix "#+#manager#)#;#}#// Check for bsf first then javax#// This version does not check if the scriptManager#// supports the language.#ScriptRunnerBase#ret#=#null#;#ret#=#createRunner#(#BSF#,#BSF_MANAGER#,#BSF_RUNNER#)#;#if#(#ret#==#null#)#{#ret#=#createRunner#(#JAVAX#,#JAVAX_MANAGER#,#JAVAX_RUNNER#)#;#}#if#(#ret#!=#null#)#{#return#ret#;#}#if#(#JAVAX#.#equals#(#manager#)#)#{#throw#new#BuildException#(#"Unable to load the script engine manager "#+#"("#+#JAVAX_MANAGER#+#")"#)#;#}#if#(#BSF#.#equals#(#manager#)#)#{#throw#new#BuildException#(#"Unable to load the BSF script engine manager "#+#"("#+#BSF_MANAGER#+#")"#)#;#}#throw#new#BuildException#(#"Unable to load a script engine manager "#+#"("#+#BSF_MANAGER#+#" or "#+#JAVAX_MANAGER#+#")"#)#;#}##ScriptRunnerBase#createRunner#(#String#checkManager#,#String#managerClass#,#String#runnerClass#)#{#ScriptRunnerBase#runner#=#null#;#if#(#!#manager#.#equals#(#AUTO#)#&&#!#manager#.#equals#(#checkManager#)#)#{#return#null#;#}#if#(#scriptLoader#.#getResource#(#LoaderUtils#.#classNameToResource#(#managerClass#)#)#==#null#)#{#return#null#;#}#if#(#managerClass#.#equals#(#BSF_MANAGER#)#)#{#new#ScriptFixBSFPath#(#)#.#fixClassLoader#(#scriptLoader#,#language#)#;#}#try#{#runner#=#(#ScriptRunnerBase#)#Class#.#forName#(#runnerClass#,#true#,#scriptLoader#)#.#newInstance#(#)#;#runner#.#setProject#(#project#)#;#}#catch#(#Exception#ex#)#{#throw#ReflectUtil#.#toBuildException#(#ex#)#;#}#runner#.#setLanguage#(#language#)#;#runner#.#setScriptClassLoader#(#scriptLoader#)#;#return#runner#;#}##