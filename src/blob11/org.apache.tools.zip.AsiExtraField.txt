ZipShort#getHeaderId#(#)#{#return#HEADER_ID#;#}##ZipShort#getLocalFileDataLength#(#)#{#return#new#ZipShort#(#WORD#// CRC#+#2#// Mode#+#WORD#// SizDev#+#2#// UID#+#2#// GID#+#getLinkedFile#(#)#.#getBytes#(#)#.#length#)#;#}##ZipShort#getCentralDirectoryLength#(#)#{#return#getLocalFileDataLength#(#)#;#}##byte#[#]#getLocalFileDataData#(#)#{#// CRC will be added later#byte#[#]#data#=#new#byte#[#getLocalFileDataLength#(#)#.#getValue#(#)#-#WORD#]#;#System#.#arraycopy#(#ZipShort#.#getBytes#(#getMode#(#)#)#,#0#,#data#,#0#,#2#)#;#byte#[#]#linkArray#=#getLinkedFile#(#)#.#getBytes#(#)#;#// CheckStyle:MagicNumber OFF#System#.#arraycopy#(#ZipLong#.#getBytes#(#linkArray#.#length#)#,#0#,#data#,#2#,#WORD#)#;#System#.#arraycopy#(#ZipShort#.#getBytes#(#getUserId#(#)#)#,#0#,#data#,#6#,#2#)#;#System#.#arraycopy#(#ZipShort#.#getBytes#(#getGroupId#(#)#)#,#0#,#data#,#8#,#2#)#;#System#.#arraycopy#(#linkArray#,#0#,#data#,#10#,#linkArray#.#length#)#;#// CheckStyle:MagicNumber ON#crc#.#reset#(#)#;#crc#.#update#(#data#)#;#long#checksum#=#crc#.#getValue#(#)#;#byte#[#]#result#=#new#byte#[#data#.#length#+#WORD#]#;#System#.#arraycopy#(#ZipLong#.#getBytes#(#checksum#)#,#0#,#result#,#0#,#WORD#)#;#System#.#arraycopy#(#data#,#0#,#result#,#WORD#,#data#.#length#)#;#return#result#;#}##byte#[#]#getCentralDirectoryData#(#)#{#return#getLocalFileDataData#(#)#;#}##void#setUserId#(#int#uid#)#{#this#.#uid#=#uid#;#}##int#getUserId#(#)#{#return#uid#;#}##void#setGroupId#(#int#gid#)#{#this#.#gid#=#gid#;#}##int#getGroupId#(#)#{#return#gid#;#}##void#setLinkedFile#(#String#name#)#{#link#=#name#;#mode#=#getMode#(#mode#)#;#}##String#getLinkedFile#(#)#{#return#link#;#}##boolean#isLink#(#)#{#return#getLinkedFile#(#)#.#length#(#)#!=#0#;#}##void#setMode#(#int#mode#)#{#this#.#mode#=#getMode#(#mode#)#;#}##int#getMode#(#)#{#return#mode#;#}##void#setDirectory#(#boolean#dirFlag#)#{#this#.#dirFlag#=#dirFlag#;#mode#=#getMode#(#mode#)#;#}##boolean#isDirectory#(#)#{#return#dirFlag#&&#!#isLink#(#)#;#}##void#parseFromLocalFileData#(#byte#[#]#data#,#int#offset#,#int#length#)#throws#ZipException#{#long#givenChecksum#=#ZipLong#.#getValue#(#data#,#offset#)#;#byte#[#]#tmp#=#new#byte#[#length#-#WORD#]#;#System#.#arraycopy#(#data#,#offset#+#WORD#,#tmp#,#0#,#length#-#WORD#)#;#crc#.#reset#(#)#;#crc#.#update#(#tmp#)#;#long#realChecksum#=#crc#.#getValue#(#)#;#if#(#givenChecksum#!=#realChecksum#)#{#throw#new#ZipException#(#"bad CRC checksum "#+#Long#.#toHexString#(#givenChecksum#)#+#" instead of "#+#Long#.#toHexString#(#realChecksum#)#)#;#}#int#newMode#=#ZipShort#.#getValue#(#tmp#,#0#)#;#// CheckStyle:MagicNumber OFF#byte#[#]#linkArray#=#new#byte#[#(#int#)#ZipLong#.#getValue#(#tmp#,#2#)#]#;#uid#=#ZipShort#.#getValue#(#tmp#,#6#)#;#gid#=#ZipShort#.#getValue#(#tmp#,#8#)#;#if#(#linkArray#.#length#==#0#)#{#link#=#""#;#}#else#{#System#.#arraycopy#(#tmp#,#10#,#linkArray#,#0#,#linkArray#.#length#)#;#link#=#new#String#(#linkArray#)#;#}#// CheckStyle:MagicNumber ON#setDirectory#(#(#newMode#&#DIR_FLAG#)#!=#0#)#;#setMode#(#newMode#)#;#}##int#getMode#(#int#mode#)#{#int#type#=#FILE_FLAG#;#if#(#isLink#(#)#)#{#type#=#LINK_FLAG#;#}#else#if#(#isDirectory#(#)#)#{#type#=#DIR_FLAG#;#}#return#type#|#(#mode#&#PERM_MASK#)#;#}##Object#clone#(#)#{#try#{#AsiExtraField#cloned#=#(#AsiExtraField#)#super#.#clone#(#)#;#cloned#.#crc#=#new#CRC32#(#)#;#return#cloned#;#}#catch#(#CloneNotSupportedException#cnfe#)#{#// impossible#throw#new#RuntimeException#(#cnfe#)#;#}#}##