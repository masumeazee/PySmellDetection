void#setUp#(#)#throws#Exception#{#createCache#(#)#;#project#=#new#Project#(#)#;#project#.#setProperty#(#"ivy.settings.file"#,#"test/repositories/ivysettings.xml"#)#;#prop#=#new#IvyArtifactProperty#(#)#;#prop#.#setProject#(#project#)#;#System#.#setProperty#(#"ivy.cache.dir"#,#cache#.#getAbsolutePath#(#)#)#;#}##void#createCache#(#)#{#cache#=#new#File#(#"build/cache"#)#;#cache#.#mkdirs#(#)#;#}##void#tearDown#(#)#throws#Exception#{#cleanCache#(#)#;#}##void#cleanCache#(#)#{#Delete#del#=#new#Delete#(#)#;#del#.#setProject#(#new#Project#(#)#)#;#del#.#setDir#(#cache#)#;#del#.#execute#(#)#;#}##void#testSimple#(#)#throws#Exception#{#project#.#setProperty#(#"ivy.dep.file"#,#"test/java/org/apache/ivy/ant/ivy-simple.xml"#)#;#prop#.#setName#(#"[module].[artifact]-[revision]"#)#;#prop#.#setValue#(#"${cache.dir}/[module]/[artifact]-[revision].[type]"#)#;#prop#.#execute#(#)#;#String#val#=#project#.#getProperty#(#"mod1.2.mod1.2-2.0"#)#;#assertNotNull#(#val#)#;#assertEquals#(#new#File#(#"build/cache/mod1.2/mod1.2-2.0.jar"#)#.#getCanonicalPath#(#)#,#new#File#(#val#)#.#getCanonicalPath#(#)#)#;#}##void#testWithResolveId#(#)#throws#Exception#{#IvyResolve#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-simple.xml"#)#)#;#resolve#.#setResolveId#(#"abc"#)#;#resolve#.#execute#(#)#;#// resolve another ivy file#resolve#=#new#IvyResolve#(#)#;#resolve#.#setProject#(#project#)#;#resolve#.#setFile#(#new#File#(#"test/java/org/apache/ivy/ant/ivy-latest.xml"#)#)#;#resolve#.#execute#(#)#;#prop#.#setName#(#"[module].[artifact]-[revision]"#)#;#prop#.#setValue#(#"${cache.dir}/[module]/[artifact]-[revision].[type]"#)#;#prop#.#setResolveId#(#"abc"#)#;#prop#.#execute#(#)#;#String#val#=#project#.#getProperty#(#"mod1.2.mod1.2-2.0"#)#;#assertNotNull#(#val#)#;#assertEquals#(#new#File#(#"build/cache/mod1.2/mod1.2-2.0.jar"#)#.#getCanonicalPath#(#)#,#new#File#(#val#)#.#getCanonicalPath#(#)#)#;#}##void#testWithResolveIdWithoutResolve#(#)#throws#Exception#{#try#{#prop#.#setName#(#"[module].[artifact]-[revision]"#)#;#prop#.#setValue#(#"${cache.dir}/[module]/[artifact]-[revision].[type]"#)#;#prop#.#setResolveId#(#"abc"#)#;#prop#.#execute#(#)#;#fail#(#"Task should have failed because no resolve was performed!"#)#;#}#catch#(#BuildException#e#)#{#// this is expected!#}#}##