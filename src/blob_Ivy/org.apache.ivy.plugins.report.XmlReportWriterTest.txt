void#setUp#(#)#throws#Exception#{#_ivy#=#new#Ivy#(#)#;#_ivy#.#configure#(#new#File#(#"test/repositories/ivysettings.xml"#)#)#;#createCache#(#)#;#}##void#createCache#(#)#{#_cache#=#new#File#(#"build/cache"#)#;#_cache#.#mkdirs#(#)#;#}##void#tearDown#(#)#throws#Exception#{#cleanCache#(#)#;#}##void#cleanCache#(#)#{#CacheCleaner#.#deleteDir#(#_cache#)#;#}##void#testWriteOrigin#(#)#throws#Exception#{#ResolveReport#report#=#_ivy#.#resolve#(#new#File#(#"test/repositories/1/special-encoding-root-ivy.xml"#)#.#toURL#(#)#,#getResolveOptions#(#new#String#[#]#{#"default"#}#)#)#;#assertNotNull#(#report#)#;#ByteArrayOutputStream#buffer#=#new#ByteArrayOutputStream#(#)#;#XmlReportWriter#writer#=#new#XmlReportWriter#(#)#;#writer#.#output#(#report#.#getConfigurationReport#(#"default"#)#,#buffer#)#;#buffer#.#flush#(#)#;#String#xml#=#buffer#.#toString#(#XmlReportWriter#.#REPORT_ENCODING#)#;#String#expectedLocation#=#"location=\""#+#new#File#(#"test/repositories/1/org1/mod1.2/jars/mod1.2-2.0.jar"#)#.#getAbsolutePath#(#)#+#"\""#;#String#expectedIsLocal#=#"is-local=\"true\""#;#String#expectedOrg#=#"organisation=\"spï¿½cial\""#;#assertTrue#(#"XML doesn't contain artifact location attribute"#,#xml#.#indexOf#(#expectedLocation#)#!=#-#1#)#;#assertTrue#(#"XML doesn't contain artifact is-local attribute"#,#xml#.#indexOf#(#expectedIsLocal#)#!=#-#1#)#;#assertTrue#(#"XML doesn't contain the organisation"#,#xml#.#indexOf#(#expectedOrg#)#!=#-#1#)#;#//check that the XML is valid#XMLHelper#.#parse#(#new#ByteArrayInputStream#(#buffer#.#toByteArray#(#)#)#,#null#,#new#DefaultHandler#(#)#,#null#)#;#}##void#testEscapeXml#(#)#throws#Exception#{#_ivy#.#configure#(#new#File#(#"test/repositories/IVY-635/ivysettings.xml"#)#)#;#ResolveReport#report#=#_ivy#.#resolve#(#new#File#(#"test/java/org/apache/ivy/plugins/report/ivy-635.xml"#)#.#toURL#(#)#,#getResolveOptions#(#new#String#[#]#{#"default"#}#)#)#;#assertNotNull#(#report#)#;#ByteArrayOutputStream#buffer#=#new#ByteArrayOutputStream#(#)#;#XmlReportWriter#writer#=#new#XmlReportWriter#(#)#;#writer#.#output#(#report#.#getConfigurationReport#(#"default"#)#,#buffer#)#;#buffer#.#flush#(#)#;#String#xml#=#buffer#.#toString#(#)#;#String#expectedArtName#=#"art1&amp;_.txt"#;#assertTrue#(#"XML doesn't contain escaped artifact name"#,#xml#.#indexOf#(#expectedArtName#)#!=#-#1#)#;#}##void#testWriteModuleInfo#(#)#throws#Exception#{#ResolveReport#report#=#_ivy#.#resolve#(#new#File#(#"test/java/org/apache/ivy/plugins/report/ivy-with-info.xml"#)#.#toURL#(#)#,#getResolveOptions#(#new#String#[#]#{#"default"#}#)#.#setValidate#(#false#)#)#;#assertNotNull#(#report#)#;#ByteArrayOutputStream#buffer#=#new#ByteArrayOutputStream#(#)#;#XmlReportWriter#writer#=#new#XmlReportWriter#(#)#;#writer#.#output#(#report#.#getConfigurationReport#(#"default"#)#,#buffer#)#;#buffer#.#flush#(#)#;#String#xml#=#buffer#.#toString#(#)#;#String#orgAttribute#=#"organisation=\"org1\""#;#String#modAttribute#=#"module=\"mod1\""#;#String#revAttribute#=#"revision=\"1.0\""#;#String#extra1Attribute#=#"extra-blabla=\"abc\""#;#String#extra2Attribute#=#"extra-blabla2=\"123\""#;#assertTrue#(#"XML doesn't contain organisation attribute"#,#xml#.#indexOf#(#orgAttribute#)#!=#-#1#)#;#assertTrue#(#"XML doesn't contain module attribute"#,#xml#.#indexOf#(#modAttribute#)#!=#-#1#)#;#assertTrue#(#"XML doesn't contain revision attribute"#,#xml#.#indexOf#(#revAttribute#)#!=#-#1#)#;#assertTrue#(#"XML doesn't contain extra attribute 1"#,#xml#.#indexOf#(#extra1Attribute#)#!=#-#1#)#;#assertTrue#(#"XML doesn't contain extra attribute 2"#,#xml#.#indexOf#(#extra2Attribute#)#!=#-#1#)#;#}##ResolveOptions#getResolveOptions#(#String#[#]#confs#)#{#return#new#ResolveOptions#(#)#.#setConfs#(#confs#)#;#}##