Resource#getResource#(#String#source#)#throws#IOException#{#initIvy#(#)#;#return#new#VsftpResource#(#this#,#source#)#;#}##void#initIvy#(#)#{#ivy#=#IvyContext#.#getContext#(#)#.#getIvy#(#)#;#}##Resource#getInitResource#(#String#source#)#throws#IOException#{#try#{#return#lslToResource#(#source#,#sendCommand#(#"ls -l "#+#source#,#true#,#true#)#)#;#}#catch#(#IOException#ex#)#{#cleanup#(#ex#)#;#throw#ex#;#}#finally#{#cleanup#(#)#;#}#}##void#get#(#final#String#source#,#File#destination#)#throws#IOException#{#initIvy#(#)#;#try#{#fireTransferInitiated#(#getResource#(#source#)#,#TransferEvent#.#REQUEST_GET#)#;#File#destDir#=#destination#.#getParentFile#(#)#;#if#(#destDir#!=#null#)#{#sendCommand#(#"lcd "#+#destDir#.#getAbsolutePath#(#)#)#;#}#if#(#destination#.#exists#(#)#)#{#destination#.#delete#(#)#;#}#int#index#=#source#.#lastIndexOf#(#'/'#)#;#String#srcName#=#index#==#-#1#?#source#:#source#.#substring#(#index#+#1#)#;#final#File#to#=#destDir#==#null#?#Checks#.#checkAbsolute#(#srcName#,#"source"#)#:#new#File#(#destDir#,#srcName#)#;#final#IOException#[#]#ex#=#new#IOException#[#1#]#;#Thread#get#=#new#IvyThread#(#)#{#public#void#run#(#)#{#initContext#(#)#;#try#{#sendCommand#(#"get "#+#source#,#getExpectedDownloadMessage#(#source#,#to#)#,#0#)#;#}#catch#(#IOException#e#)#{#ex#[#0#]#=#e#;#}#}#}#;#get#.#start#(#)#;#long#prevLength#=#0#;#long#lastUpdate#=#System#.#currentTimeMillis#(#)#;#long#timeout#=#readTimeout#;#while#(#get#.#isAlive#(#)#)#{#checkInterrupted#(#)#;#long#length#=#to#.#exists#(#)#?#to#.#length#(#)#:#0#;#if#(#length#>#prevLength#)#{#fireTransferProgress#(#length#-#prevLength#)#;#lastUpdate#=#System#.#currentTimeMillis#(#)#;#prevLength#=#length#;#}#else#{#if#(#System#.#currentTimeMillis#(#)#-#lastUpdate#>#timeout#)#{#Message#.#verbose#(#"download hang for more than "#+#timeout#+#"ms. Interrupting."#)#;#get#.#interrupt#(#)#;#if#(#to#.#exists#(#)#)#{#to#.#delete#(#)#;#}#throw#new#IOException#(#source#+#" download timeout from "#+#getHost#(#)#)#;#}#}#try#{#get#.#join#(#GET_JOIN_MAX_TIME#)#;#}#catch#(#InterruptedException#e#)#{#if#(#to#.#exists#(#)#)#{#to#.#delete#(#)#;#}#return#;#}#}#if#(#ex#[#0#]#!=#null#)#{#if#(#to#.#exists#(#)#)#{#to#.#delete#(#)#;#}#throw#ex#[#0#]#;#}#to#.#renameTo#(#destination#)#;#fireTransferCompleted#(#destination#.#length#(#)#)#;#}#catch#(#IOException#ex#)#{#fireTransferError#(#ex#)#;#cleanup#(#ex#)#;#throw#ex#;#}#finally#{#cleanup#(#)#;#}#}##void#run#(#)#{#initContext#(#)#;#try#{#sendCommand#(#"get "#+#source#,#getExpectedDownloadMessage#(#source#,#to#)#,#0#)#;#}#catch#(#IOException#e#)#{#ex#[#0#]#=#e#;#}#}##List#list#(#String#parent#)#throws#IOException#{#initIvy#(#)#;#try#{#if#(#!#parent#.#endsWith#(#"/"#)#)#{#parent#=#parent#+#"/"#;#}#String#response#=#sendCommand#(#"ls -l "#+#parent#,#true#,#true#)#;#if#(#response#.#startsWith#(#"ls"#)#)#{#return#null#;#}#String#[#]#lines#=#response#.#split#(#"\n"#)#;#List#ret#=#new#ArrayList#(#lines#.#length#)#;#for#(#int#i#=#0#;#i#<#lines#.#length#;#i#++#)#{#while#(#lines#[#i#]#.#endsWith#(#"\r"#)#||#lines#[#i#]#.#endsWith#(#"\n"#)#)#{#lines#[#i#]#=#lines#[#i#]#.#substring#(#0#,#lines#[#i#]#.#length#(#)#-#1#)#;#}#if#(#lines#[#i#]#.#trim#(#)#.#length#(#)#!=#0#)#{#ret#.#add#(#parent#+#lines#[#i#]#.#substring#(#lines#[#i#]#.#lastIndexOf#(#' '#)#+#1#)#)#;#}#}#return#ret#;#}#catch#(#IOException#ex#)#{#cleanup#(#ex#)#;#throw#ex#;#}#finally#{#cleanup#(#)#;#}#}##void#put#(#File#source#,#String#destination#,#boolean#overwrite#)#throws#IOException#{#initIvy#(#)#;#try#{#if#(#getResource#(#destination#)#.#exists#(#)#)#{#if#(#overwrite#)#{#sendCommand#(#"rm "#+#destination#,#getExpectedRemoveMessage#(#destination#)#)#;#}#else#{#return#;#}#}#int#index#=#destination#.#lastIndexOf#(#'/'#)#;#String#destDir#=#null#;#if#(#index#!=#-#1#)#{#destDir#=#destination#.#substring#(#0#,#index#)#;#mkdirs#(#destDir#)#;#sendCommand#(#"cd "#+#destDir#)#;#}#String#to#=#destDir#!=#null#?#destDir#+#"/"#+#source#.#getName#(#)#:#source#.#getName#(#)#;#sendCommand#(#"put "#+#source#.#getAbsolutePath#(#)#,#getExpectedUploadMessage#(#source#,#to#)#,#0#)#;#sendCommand#(#"mv "#+#to#+#" "#+#destination#)#;#}#catch#(#IOException#ex#)#{#cleanup#(#ex#)#;#throw#ex#;#}#finally#{#cleanup#(#)#;#}#}##void#mkdirs#(#String#destDir#)#throws#IOException#{#if#(#dirExists#(#destDir#)#)#{#return#;#}#if#(#destDir#.#endsWith#(#"/"#)#)#{#destDir#=#destDir#.#substring#(#0#,#destDir#.#length#(#)#-#1#)#;#}#int#index#=#destDir#.#lastIndexOf#(#'/'#)#;#if#(#index#!=#-#1#)#{#mkdirs#(#destDir#.#substring#(#0#,#index#)#)#;#}#sendCommand#(#"mkdir "#+#destDir#)#;#}##boolean#dirExists#(#String#dir#)#throws#IOException#{#return#!#sendCommand#(#"ls "#+#dir#,#true#)#.#startsWith#(#"ls: "#)#;#}##String#sendCommand#(#String#command#)#throws#IOException#{#return#sendCommand#(#command#,#false#,#readTimeout#)#;#}##void#sendCommand#(#String#command#,#Pattern#expectedResponse#)#throws#IOException#{#sendCommand#(#command#,#expectedResponse#,#readTimeout#)#;#}##void#sendCommand#(#String#command#,#Pattern#expectedResponse#,#long#timeout#)#throws#IOException#{#String#response#=#sendCommand#(#command#,#true#,#timeout#)#;#if#(#!#expectedResponse#.#matcher#(#response#)#.#matches#(#)#)#{#Message#.#debug#(#"invalid response from server:"#)#;#Message#.#debug#(#"expected: '"#+#expectedResponse#+#"'"#)#;#Message#.#debug#(#"was:      '"#+#response#+#"'"#)#;#throw#new#IOException#(#response#)#;#}#}##String#sendCommand#(#String#command#,#boolean#sendErrorAsResponse#)#throws#IOException#{#return#sendCommand#(#command#,#sendErrorAsResponse#,#readTimeout#)#;#}##String#sendCommand#(#String#command#,#boolean#sendErrorAsResponse#,#boolean#single#)#throws#IOException#{#return#sendCommand#(#command#,#sendErrorAsResponse#,#single#,#readTimeout#)#;#}##String#sendCommand#(#String#command#,#boolean#sendErrorAsResponse#,#long#timeout#)#throws#IOException#{#return#sendCommand#(#command#,#sendErrorAsResponse#,#false#,#timeout#)#;#}##String#sendCommand#(#String#command#,#boolean#sendErrorAsResponse#,#boolean#single#,#long#timeout#)#throws#IOException#{#single#=#false#;#// use of alone commands does not work properly due to a long delay between#// end of process and end of stream...#checkInterrupted#(#)#;#inCommand#=#true#;#errorsLastUpdateTime#=#0#;#synchronized#(#this#)#{#if#(#!#single#||#in#!=#null#)#{#ensureConnectionOpened#(#)#;#Message#.#debug#(#"sending command '"#+#command#+#"' to "#+#getHost#(#)#)#;#updateLastCommandTime#(#)#;#out#.#println#(#command#)#;#out#.#flush#(#)#;#}#else#{#sendSingleCommand#(#command#)#;#}#}#try#{#return#readResponse#(#sendErrorAsResponse#,#timeout#)#;#}#finally#{#inCommand#=#false#;#if#(#single#)#{#closeConnection#(#)#;#}#}#}##String#readResponse#(#boolean#sendErrorAsResponse#)#throws#IOException#{#return#readResponse#(#sendErrorAsResponse#,#readTimeout#)#;#}##String#readResponse#(#final#boolean#sendErrorAsResponse#,#long#timeout#)#throws#IOException#{#final#StringBuffer#response#=#new#StringBuffer#(#)#;#final#IOException#[#]#exc#=#new#IOException#[#1#]#;#final#boolean#[#]#done#=#new#boolean#[#1#]#;#Runnable#r#=#new#Runnable#(#)#{#public#void#run#(#)#{#synchronized#(#VsftpRepository#.#this#)#{#try#{#int#c#;#boolean#getPrompt#=#false#;#// the reading is done in a for loop making five attempts to read the stream#// if we do not reach the next prompt#for#(#int#attempts#=#0#;#!#getPrompt#&&#attempts#<#MAX_READ_PROMPT_ATTEMPT#;#attempts#++#)#{#while#(#(#c#=#in#.#read#(#)#)#!=#-#1#)#{#attempts#=#0#;#// we manage to read something, reset numer of#// attempts#response#.#append#(#(#char#)#c#)#;#if#(#response#.#length#(#)#>=#PROMPT#.#length#(#)#&&#response#.#substring#(#response#.#length#(#)#-#PROMPT#.#length#(#)#,#response#.#length#(#)#)#.#equals#(#PROMPT#)#)#{#response#.#setLength#(#response#.#length#(#)#-#PROMPT#.#length#(#)#)#;#getPrompt#=#true#;#break#;#}#}#if#(#!#getPrompt#)#{#try#{#Thread#.#sleep#(#PROMPT_SLEEP_TIME#)#;#}#catch#(#InterruptedException#e#)#{#break#;#}#}#}#if#(#getPrompt#)#{#// wait enough for error stream to be fully read#if#(#errorsLastUpdateTime#==#0#)#{#// no error written yet, but it may be pending...#errorsLastUpdateTime#=#lastCommand#;#}#while#(#(#System#.#currentTimeMillis#(#)#-#errorsLastUpdateTime#)#<#PROMPT_SLEEP_TIME#)#{#try#{#Thread#.#sleep#(#ERROR_SLEEP_TIME#)#;#}#catch#(#InterruptedException#e#)#{#break#;#}#}#}#if#(#errors#.#length#(#)#>#0#)#{#if#(#sendErrorAsResponse#)#{#response#.#append#(#errors#)#;#errors#.#setLength#(#0#)#;#}#else#{#throw#new#IOException#(#chomp#(#errors#)#.#toString#(#)#)#;#}#}#chomp#(#response#)#;#done#[#0#]#=#true#;#}#catch#(#IOException#e#)#{#exc#[#0#]#=#e#;#}#finally#{#VsftpRepository#.#this#.#notify#(#)#;#}#}#}#}#;#Thread#reader#=#null#;#if#(#timeout#==#0#)#{#r#.#run#(#)#;#}#else#{#reader#=#new#IvyThread#(#r#)#;#reader#.#start#(#)#;#try#{#wait#(#timeout#)#;#}#catch#(#InterruptedException#e#)#{#//nothing to do#}#}#updateLastCommandTime#(#)#;#if#(#exc#[#0#]#!=#null#)#{#throw#exc#[#0#]#;#}#else#if#(#!#done#[#0#]#)#{#if#(#reader#!=#null#&&#reader#.#isAlive#(#)#)#{#reader#.#interrupt#(#)#;#for#(#int#i#=#0#;#i#<#MAX_READER_ALIVE_ATTEMPT#&&#reader#.#isAlive#(#)#;#i#++#)#{#try#{#Thread#.#sleep#(#READER_ALIVE_SLEEP_TIME#)#;#}#catch#(#InterruptedException#e#)#{#break#;#}#}#if#(#reader#.#isAlive#(#)#)#{#reader#.#stop#(#)#;#// no way to interrupt it non abruptly#}#}#throw#new#IOException#(#"connection timeout to "#+#getHost#(#)#)#;#}#else#{#if#(#"Not connected."#.#equals#(#response#)#)#{#Message#.#info#(#"vsftp connection to "#+#getHost#(#)#+#" reset"#)#;#closeConnection#(#)#;#throw#new#IOException#(#"not connected to "#+#getHost#(#)#)#;#}#Message#.#debug#(#"received response '"#+#response#+#"' from "#+#getHost#(#)#)#;#return#response#.#toString#(#)#;#}#}##void#run#(#)#{#synchronized#(#VsftpRepository#.#this#)#{#try#{#int#c#;#boolean#getPrompt#=#false#;#// the reading is done in a for loop making five attempts to read the stream#// if we do not reach the next prompt#for#(#int#attempts#=#0#;#!#getPrompt#&&#attempts#<#MAX_READ_PROMPT_ATTEMPT#;#attempts#++#)#{#while#(#(#c#=#in#.#read#(#)#)#!=#-#1#)#{#attempts#=#0#;#// we manage to read something, reset numer of#// attempts#response#.#append#(#(#char#)#c#)#;#if#(#response#.#length#(#)#>=#PROMPT#.#length#(#)#&&#response#.#substring#(#response#.#length#(#)#-#PROMPT#.#length#(#)#,#response#.#length#(#)#)#.#equals#(#PROMPT#)#)#{#response#.#setLength#(#response#.#length#(#)#-#PROMPT#.#length#(#)#)#;#getPrompt#=#true#;#break#;#}#}#if#(#!#getPrompt#)#{#try#{#Thread#.#sleep#(#PROMPT_SLEEP_TIME#)#;#}#catch#(#InterruptedException#e#)#{#break#;#}#}#}#if#(#getPrompt#)#{#// wait enough for error stream to be fully read#if#(#errorsLastUpdateTime#==#0#)#{#// no error written yet, but it may be pending...#errorsLastUpdateTime#=#lastCommand#;#}#while#(#(#System#.#currentTimeMillis#(#)#-#errorsLastUpdateTime#)#<#PROMPT_SLEEP_TIME#)#{#try#{#Thread#.#sleep#(#ERROR_SLEEP_TIME#)#;#}#catch#(#InterruptedException#e#)#{#break#;#}#}#}#if#(#errors#.#length#(#)#>#0#)#{#if#(#sendErrorAsResponse#)#{#response#.#append#(#errors#)#;#errors#.#setLength#(#0#)#;#}#else#{#throw#new#IOException#(#chomp#(#errors#)#.#toString#(#)#)#;#}#}#chomp#(#response#)#;#done#[#0#]#=#true#;#}#catch#(#IOException#e#)#{#exc#[#0#]#=#e#;#}#finally#{#VsftpRepository#.#this#.#notify#(#)#;#}#}#}##void#sendSingleCommand#(#String#command#)#throws#IOException#{#exec#(#getSingleCommand#(#command#)#)#;#}##void#ensureConnectionOpened#(#)#throws#IOException#{#if#(#in#==#null#)#{#Message#.#verbose#(#"connecting to "#+#getUsername#(#)#+#"@"#+#getHost#(#)#+#"... "#)#;#String#connectionCommand#=#getConnectionCommand#(#)#;#exec#(#connectionCommand#)#;#try#{#readResponse#(#false#)#;#// waits for first prompt#if#(#reuseConnection#>#0#)#{#connectionCleaner#=#new#IvyThread#(#)#{#public#void#run#(#)#{#initContext#(#)#;#try#{#long#sleep#=#REUSE_CONNECTION_SLEEP_TIME#;#while#(#in#!=#null#&&#sleep#>#0#)#{#sleep#(#sleep#)#;#sleep#=#reuseConnection#-#(#System#.#currentTimeMillis#(#)#-#lastCommand#)#;#if#(#inCommand#)#{#sleep#=#sleep#<=#0#?#reuseConnection#:#sleep#;#}#}#}#catch#(#InterruptedException#e#)#{#//nothing to do#}#disconnect#(#)#;#}#}#;#connectionCleaner#.#start#(#)#;#}#if#(#ivy#!=#null#)#{#ivy#.#getEventManager#(#)#.#addIvyListener#(#new#IvyListener#(#)#{#public#void#progress#(#IvyEvent#event#)#{#disconnect#(#)#;#event#.#getSource#(#)#.#removeIvyListener#(#this#)#;#}#}#,#EndResolveEvent#.#NAME#)#;#}#}#catch#(#IOException#ex#)#{#closeConnection#(#)#;#throw#new#IOException#(#"impossible to connect to "#+#getUsername#(#)#+#"@"#+#getHost#(#)#+#" using "#+#getAuthentication#(#)#+#": "#+#ex#.#getMessage#(#)#)#;#}#Message#.#verbose#(#"connected to "#+#getHost#(#)#)#;#}#}##void#run#(#)#{#initContext#(#)#;#try#{#long#sleep#=#REUSE_CONNECTION_SLEEP_TIME#;#while#(#in#!=#null#&&#sleep#>#0#)#{#sleep#(#sleep#)#;#sleep#=#reuseConnection#-#(#System#.#currentTimeMillis#(#)#-#lastCommand#)#;#if#(#inCommand#)#{#sleep#=#sleep#<=#0#?#reuseConnection#:#sleep#;#}#}#}#catch#(#InterruptedException#e#)#{#//nothing to do#}#disconnect#(#)#;#}##void#progress#(#IvyEvent#event#)#{#disconnect#(#)#;#event#.#getSource#(#)#.#removeIvyListener#(#this#)#;#}##void#updateLastCommandTime#(#)#{#lastCommand#=#System#.#currentTimeMillis#(#)#;#}##void#exec#(#String#command#)#throws#IOException#{#Message#.#debug#(#"launching '"#+#command#+#"'"#)#;#process#=#Runtime#.#getRuntime#(#)#.#exec#(#command#)#;#in#=#new#InputStreamReader#(#process#.#getInputStream#(#)#)#;#err#=#new#InputStreamReader#(#process#.#getErrorStream#(#)#)#;#out#=#new#PrintWriter#(#process#.#getOutputStream#(#)#)#;#errorsReader#=#new#IvyThread#(#)#{#public#void#run#(#)#{#initContext#(#)#;#int#c#;#try#{#// CheckStyle:InnerAssignment OFF#while#(#err#!=#null#&&#(#c#=#err#.#read#(#)#)#!=#-#1#)#{#errors#.#append#(#(#char#)#c#)#;#errorsLastUpdateTime#=#System#.#currentTimeMillis#(#)#;#}#// CheckStyle:InnerAssignment ON#}#catch#(#IOException#e#)#{#//nothing to do#}#}#}#;#errorsReader#.#start#(#)#;#}##void#run#(#)#{#initContext#(#)#;#int#c#;#try#{#// CheckStyle:InnerAssignment OFF#while#(#err#!=#null#&&#(#c#=#err#.#read#(#)#)#!=#-#1#)#{#errors#.#append#(#(#char#)#c#)#;#errorsLastUpdateTime#=#System#.#currentTimeMillis#(#)#;#}#// CheckStyle:InnerAssignment ON#}#catch#(#IOException#e#)#{#//nothing to do#}#}##void#checkInterrupted#(#)#{#if#(#ivy#!=#null#)#{#ivy#.#checkInterrupted#(#)#;#}#}##void#cleanup#(#Exception#ex#)#{#if#(#ex#.#getMessage#(#)#.#equals#(#"connection timeout to "#+#getHost#(#)#)#)#{#closeConnection#(#)#;#}#else#{#disconnect#(#)#;#}#}##void#cleanup#(#)#{#if#(#reuseConnection#==#0#)#{#disconnect#(#)#;#}#}##void#disconnect#(#)#{#if#(#in#!=#null#)#{#Message#.#verbose#(#"disconnecting from "#+#getHost#(#)#+#"... "#)#;#try#{#sendCommand#(#"exit"#,#false#,#DISCONNECT_COMMAND_TIMEOUT#)#;#}#catch#(#IOException#e#)#{#//nothing I can do#}#finally#{#closeConnection#(#)#;#Message#.#verbose#(#"disconnected of "#+#getHost#(#)#)#;#}#}#}##void#closeConnection#(#)#{#if#(#connectionCleaner#!=#null#)#{#connectionCleaner#.#interrupt#(#)#;#}#if#(#errorsReader#!=#null#)#{#errorsReader#.#interrupt#(#)#;#}#try#{#process#.#destroy#(#)#;#}#catch#(#Exception#ex#)#{#//nothing I can do#}#try#{#in#.#close#(#)#;#}#catch#(#Exception#e#)#{#//nothing I can do#}#try#{#err#.#close#(#)#;#}#catch#(#Exception#e#)#{#//nothing I can do#}#try#{#out#.#close#(#)#;#}#catch#(#Exception#e#)#{#//nothing I can do#}#connectionCleaner#=#null#;#errorsReader#=#null#;#process#=#null#;#in#=#null#;#out#=#null#;#err#=#null#;#Message#.#debug#(#"connection to "#+#getHost#(#)#+#" closed"#)#;#}##Resource#lslToResource#(#String#file#,#String#responseLine#)#{#if#(#responseLine#==#null#||#responseLine#.#startsWith#(#"ls"#)#)#{#return#new#BasicResource#(#file#,#false#,#0#,#0#,#false#)#;#}#else#{#String#[#]#parts#=#responseLine#.#split#(#"\\s+"#)#;#if#(#parts#.#length#!=#LS_PARTS_NUMBER#)#{#Message#.#debug#(#"unrecognized ls format: "#+#responseLine#)#;#return#new#BasicResource#(#file#,#false#,#0#,#0#,#false#)#;#}#else#{#try#{#long#contentLength#=#Long#.#parseLong#(#parts#[#LS_SIZE_INDEX#]#)#;#String#date#=#parts#[#LS_DATE_INDEX1#]#+#" "#+#parts#[#LS_DATE_INDEX2#]#+#" "#+#parts#[#LS_DATE_INDEX3#]#+#" "#+#parts#[#LS_DATE_INDEX4#]#;#return#new#BasicResource#(#file#,#true#,#contentLength#,#FORMAT#.#parse#(#date#)#.#getTime#(#)#,#false#)#;#}#catch#(#Exception#ex#)#{#Message#.#warn#(#"impossible to parse server response: "#+#responseLine#+#": "#+#ex#)#;#return#new#BasicResource#(#file#,#false#,#0#,#0#,#false#)#;#}#}#}#}##String#getSingleCommand#(#String#command#)#{#return#"vsh -noprompt -auth "#+#authentication#+#" "#+#username#+#"@"#+#host#+#" "#+#command#;#}##String#getConnectionCommand#(#)#{#return#"vsftp -noprompt -auth "#+#authentication#+#" "#+#username#+#"@"#+#host#;#}##Pattern#getExpectedDownloadMessage#(#String#source#,#File#to#)#{#return#Pattern#.#compile#(#"Downloading "#+#to#.#getName#(#)#+#" from [^\\s]+"#)#;#}##Pattern#getExpectedRemoveMessage#(#String#destination#)#{#return#Pattern#.#compile#(#"Removing [^\\s]+"#)#;#}##Pattern#getExpectedUploadMessage#(#File#source#,#String#to#)#{#return#Pattern#.#compile#(#"Uploading "#+#source#.#getName#(#)#+#" to [^\\s]+"#)#;#}##String#getAuthentication#(#)#{#return#authentication#;#}##void#setAuthentication#(#String#authentication#)#{#this#.#authentication#=#authentication#;#}##String#getHost#(#)#{#return#host#;#}##void#setHost#(#String#host#)#{#this#.#host#=#host#;#}##String#getUsername#(#)#{#return#username#;#}##void#setUsername#(#String#username#)#{#this#.#username#=#username#;#}##StringBuffer#chomp#(#StringBuffer#str#)#{#if#(#str#==#null#||#str#.#length#(#)#==#0#)#{#return#str#;#}#while#(#"\n"#.#equals#(#str#.#substring#(#str#.#length#(#)#-#1#)#)#||#"\r"#.#equals#(#str#.#substring#(#str#.#length#(#)#-#1#)#)#)#{#str#.#setLength#(#str#.#length#(#)#-#1#)#;#}#return#str#;#}##String#toString#(#)#{#return#getName#(#)#+#" "#+#getUsername#(#)#+#"@"#+#getHost#(#)#+#" ("#+#getAuthentication#(#)#+#")"#;#}##void#setReuseConnection#(#long#time#)#{#this#.#reuseConnection#=#time#;#}##long#getReadTimeout#(#)#{#return#readTimeout#;#}##void#setReadTimeout#(#long#readTimeout#)#{#this#.#readTimeout#=#readTimeout#;#}##