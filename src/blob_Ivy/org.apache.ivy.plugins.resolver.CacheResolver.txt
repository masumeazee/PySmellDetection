ResolvedModuleRevision#getDependency#(#DependencyDescriptor#dd#,#ResolveData#data#)#throws#ParseException#{#clearIvyAttempts#(#)#;#ModuleRevisionId#mrid#=#dd#.#getDependencyRevisionId#(#)#;#// check revision#ResolvedModuleRevision#rmr#=#getRepositoryCacheManager#(#)#.#findModuleInCache#(#dd#,#mrid#,#getCacheOptions#(#data#)#,#null#)#;#if#(#rmr#!=#null#)#{#Message#.#verbose#(#"\t"#+#getName#(#)#+#": revision in cache: "#+#mrid#)#;#return#rmr#;#}#else#if#(#!#getSettings#(#)#.#getVersionMatcher#(#)#.#isDynamic#(#mrid#)#)#{#Message#.#verbose#(#"\t"#+#getName#(#)#+#": no ivy file in cache found for "#+#mrid#)#;#return#null#;#}#else#{#ensureConfigured#(#)#;#ResolvedResource#ivyRef#=#findIvyFileRef#(#dd#,#data#)#;#if#(#ivyRef#!=#null#)#{#Message#.#verbose#(#"\t"#+#getName#(#)#+#": found ivy file in cache for "#+#mrid#)#;#Message#.#verbose#(#"\t\t=> "#+#ivyRef#)#;#ModuleRevisionId#resolvedMrid#=#ModuleRevisionId#.#newInstance#(#mrid#,#ivyRef#.#getRevision#(#)#)#;#IvyNode#node#=#data#.#getNode#(#resolvedMrid#)#;#if#(#node#!=#null#&&#node#.#getModuleRevision#(#)#!=#null#)#{#// this revision has already be resolved : return it#Message#.#verbose#(#"\t"#+#getName#(#)#+#": revision already resolved: "#+#resolvedMrid#)#;#return#node#.#getModuleRevision#(#)#;#}#rmr#=#getRepositoryCacheManager#(#)#.#findModuleInCache#(#dd#.#clone#(#ModuleRevisionId#.#newInstance#(#dd#.#getDependencyRevisionId#(#)#,#ivyRef#.#getRevision#(#)#)#)#,#dd#.#getDependencyRevisionId#(#)#,#getCacheOptions#(#data#)#,#null#)#;#if#(#rmr#!=#null#)#{#Message#.#verbose#(#"\t"#+#getName#(#)#+#": revision in cache: "#+#resolvedMrid#)#;#return#rmr#;#}#else#{#Message#.#error#(#"\t"#+#getName#(#)#+#": inconsistent cache: clean it and resolve again"#)#;#return#null#;#}#}#else#{#Message#.#verbose#(#"\t"#+#getName#(#)#+#": no ivy file in cache found for "#+#mrid#)#;#return#null#;#}#}#}##DownloadReport#download#(#Artifact#[#]#artifacts#,#DownloadOptions#options#)#{#clearArtifactAttempts#(#)#;#DownloadReport#dr#=#new#DownloadReport#(#)#;#for#(#int#i#=#0#;#i#<#artifacts#.#length#;#i#++#)#{#final#ArtifactDownloadReport#adr#=#new#ArtifactDownloadReport#(#artifacts#[#i#]#)#;#dr#.#addArtifactReport#(#adr#)#;#ResolvedResource#artifactRef#=#getArtifactRef#(#artifacts#[#i#]#,#null#)#;#if#(#artifactRef#!=#null#)#{#Message#.#verbose#(#"\t[NOT REQUIRED] "#+#artifacts#[#i#]#)#;#ArtifactOrigin#origin#=#new#ArtifactOrigin#(#artifacts#[#i#]#,#true#,#artifactRef#.#getResource#(#)#.#getName#(#)#)#;#File#archiveFile#=#(#(#FileResource#)#artifactRef#.#getResource#(#)#)#.#getFile#(#)#;#adr#.#setDownloadStatus#(#DownloadStatus#.#NO#)#;#adr#.#setSize#(#archiveFile#.#length#(#)#)#;#adr#.#setArtifactOrigin#(#origin#)#;#adr#.#setLocalFile#(#archiveFile#)#;#}#else#{#adr#.#setDownloadStatus#(#DownloadStatus#.#FAILED#)#;#}#}#return#dr#;#}##boolean#exists#(#Artifact#artifact#)#{#ensureConfigured#(#)#;#return#super#.#exists#(#artifact#)#;#}##ArtifactOrigin#locate#(#Artifact#artifact#)#{#ensureConfigured#(#)#;#return#super#.#locate#(#artifact#)#;#}##void#publish#(#Artifact#artifact#,#File#src#,#boolean#overwrite#)#throws#IOException#{#ensureConfigured#(#)#;#super#.#publish#(#artifact#,#src#,#overwrite#)#;#}##OrganisationEntry#[#]#listOrganisations#(#)#{#ensureConfigured#(#)#;#return#super#.#listOrganisations#(#)#;#}##ModuleEntry#[#]#listModules#(#OrganisationEntry#org#)#{#ensureConfigured#(#)#;#return#super#.#listModules#(#org#)#;#}##RevisionEntry#[#]#listRevisions#(#ModuleEntry#module#)#{#ensureConfigured#(#)#;#return#super#.#listRevisions#(#module#)#;#}##void#dumpSettings#(#)#{#Message#.#verbose#(#"\t"#+#getName#(#)#+#" [cache]"#)#;#}##void#ensureConfigured#(#)#{#if#(#getIvyPatterns#(#)#.#isEmpty#(#)#)#{#setIvyPatterns#(#new#ArrayList#(#)#)#;#setArtifactPatterns#(#new#ArrayList#(#)#)#;#RepositoryCacheManager#[#]#caches#=#getSettings#(#)#.#getRepositoryCacheManagers#(#)#;#for#(#int#i#=#0#;#i#<#caches#.#length#;#i#++#)#{#if#(#caches#[#i#]#instanceof#DefaultRepositoryCacheManager#)#{#DefaultRepositoryCacheManager#c#=#(#DefaultRepositoryCacheManager#)#caches#[#i#]#;#addIvyPattern#(#c#.#getBasedir#(#)#.#getAbsolutePath#(#)#+#"/"#+#c#.#getIvyPattern#(#)#)#;#addArtifactPattern#(#c#.#getBasedir#(#)#.#getAbsolutePath#(#)#+#"/"#+#c#.#getArtifactPattern#(#)#)#;#}#else#{#Message#.#verbose#(#caches#[#i#]#+#": cache implementation is not a DefaultRepositoryCacheManager:"#+#" unable to configure cache resolver with it"#)#;#}#}#}#}##String#getTypeName#(#)#{#return#"cache"#;#}##