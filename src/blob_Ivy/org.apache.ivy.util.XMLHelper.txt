SAXParser#newSAXParser#(#URL#schema#,#InputStream#schemaStream#)#throws#ParserConfigurationException#,#SAXException#{#if#(#!#canUseSchemaValidation#||#schema#==#null#)#{#return#SAXParserFactory#.#newInstance#(#)#.#newSAXParser#(#)#;#}#try#{#SAXParserFactory#parserFactory#=#SAXParserFactory#.#newInstance#(#)#;#parserFactory#.#setNamespaceAware#(#true#)#;#parserFactory#.#setValidating#(#true#)#;#SAXParser#parser#=#parserFactory#.#newSAXParser#(#)#;#parser#.#setProperty#(#JAXP_SCHEMA_LANGUAGE#,#W3C_XML_SCHEMA#)#;#parser#.#setProperty#(#JAXP_SCHEMA_SOURCE#,#schemaStream#)#;#parser#.#getXMLReader#(#)#.#setFeature#(#XML_NAMESPACE_PREFIXES#,#true#)#;#return#parser#;#}#catch#(#SAXNotRecognizedException#ex#)#{#System#.#err#.#println#(#"WARNING: problem while setting JAXP validating property on SAXParser... "#+#"XML validation will not be done: "#+#ex#.#getMessage#(#)#)#;#canUseSchemaValidation#=#false#;#return#SAXParserFactory#.#newInstance#(#)#.#newSAXParser#(#)#;#}#}##void#parse#(#URL#xmlURL#,#URL#schema#,#DefaultHandler#handler#)#throws#SAXException#,#IOException#,#ParserConfigurationException#{#parse#(#xmlURL#,#schema#,#handler#,#null#)#;#}##void#parse#(#URL#xmlURL#,#URL#schema#,#DefaultHandler#handler#,#LexicalHandler#lHandler#)#throws#SAXException#,#IOException#,#ParserConfigurationException#{#InputStream#xmlStream#=#URLHandlerRegistry#.#getDefault#(#)#.#openStream#(#xmlURL#)#;#try#{#InputSource#inSrc#=#new#InputSource#(#xmlStream#)#;#inSrc#.#setSystemId#(#xmlURL#.#toExternalForm#(#)#)#;#parse#(#inSrc#,#schema#,#handler#,#lHandler#)#;#}#finally#{#try#{#xmlStream#.#close#(#)#;#}#catch#(#IOException#e#)#{#// ignored#}#}#}##void#parse#(#InputStream#xmlStream#,#URL#schema#,#DefaultHandler#handler#,#LexicalHandler#lHandler#)#throws#SAXException#,#IOException#,#ParserConfigurationException#{#parse#(#new#InputSource#(#xmlStream#)#,#schema#,#handler#,#lHandler#)#;#}##void#parse#(#InputSource#xmlStream#,#URL#schema#,#DefaultHandler#handler#,#LexicalHandler#lHandler#)#throws#SAXException#,#IOException#,#ParserConfigurationException#{#InputStream#schemaStream#=#null#;#try#{#if#(#schema#!=#null#)#{#schemaStream#=#URLHandlerRegistry#.#getDefault#(#)#.#openStream#(#schema#)#;#}#SAXParser#parser#=#XMLHelper#.#newSAXParser#(#schema#,#schemaStream#)#;#if#(#lHandler#!=#null#)#{#try#{#parser#.#setProperty#(#"http://xml.org/sax/properties/lexical-handler"#,#lHandler#)#;#}#catch#(#SAXException#ex#)#{#System#.#err#.#println#(#"WARNING: problem while setting the lexical handler property on SAXParser: "#+#ex#.#getMessage#(#)#)#;#// continue without the lexical handler#}#}#parser#.#parse#(#xmlStream#,#handler#)#;#}#finally#{#if#(#schemaStream#!=#null#)#{#try#{#schemaStream#.#close#(#)#;#}#catch#(#IOException#ex#)#{#// ignored#}#}#}#}##boolean#canUseSchemaValidation#(#)#{#return#canUseSchemaValidation#;#}##String#escape#(#String#text#)#{#if#(#text#==#null#)#{#return#null#;#}#StringBuffer#result#=#new#StringBuffer#(#text#.#length#(#)#)#;#char#[#]#chars#=#text#.#toCharArray#(#)#;#for#(#int#i#=#0#;#i#<#chars#.#length#;#i#++#)#{#switch#(#chars#[#i#]#)#{#case#'&'#:#result#.#append#(#"&amp;"#)#;#break#;#case#'<'#:#result#.#append#(#"&lt;"#)#;#break#;#case#'\''#:#result#.#append#(#"&apos;"#)#;#break#;#case#'\"'#:#result#.#append#(#"&quot;"#)#;#break#;#default#:#result#.#append#(#chars#[#i#]#)#;#}#}#return#result#.#toString#(#)#;#}##Document#parseToDom#(#InputStream#stream#,#Resource#res#,#EntityResolver#entityResolver#)#throws#IOException#,#SAXException#{#DocumentBuilder#docBuilder#=#getDocBuilder#(#entityResolver#)#;#Document#pomDomDoc#;#try#{#pomDomDoc#=#docBuilder#.#parse#(#stream#,#res#.#getName#(#)#)#;#}#catch#(#SAXException#e#)#{#e#.#printStackTrace#(#)#;#throw#e#;#}#finally#{#stream#.#close#(#)#;#}#return#pomDomDoc#;#}##DocumentBuilder#getDocBuilder#(#EntityResolver#entityResolver#)#{#if#(#docBuilder#==#null#)#{#try#{#DocumentBuilderFactory#factory#=#DocumentBuilderFactory#.#newInstance#(#)#;#factory#.#setValidating#(#false#)#;#docBuilder#=#factory#.#newDocumentBuilder#(#)#;#if#(#entityResolver#!=#null#)#{#docBuilder#.#setEntityResolver#(#entityResolver#)#;#}#}#catch#(#ParserConfigurationException#e#)#{#throw#new#RuntimeException#(#e#)#;#}#}#return#docBuilder#;#}##